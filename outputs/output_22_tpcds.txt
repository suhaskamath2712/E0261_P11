-----------------------------------------------------
Query ID: TPCDS_Q1
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Transformations 1 (A to X): [FilterCorrelateRule, AggregateJoinTransposeRule, FilterJoinRule.FilterIntoJoinRule]
LLM Transformations 2 (B to X): [JoinAssociateRule, JoinDeriveIsNotNullFilterRule, JoinPushTransitivePredicatesRule, FilterJoinRule.FilterIntoJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[0:ASCENDING:LAST])->Project[$x]->Join(INNER,<($x,TIMES($x,1.2:DECIMAL(2, 1)))&=($x,$x)){Aggregate(groups=[0], calls=[AVG@1])->Project[$x,$x]->Filter(IS_NOT_NULL($x))->Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2000))->Scan(public.date_dim)|Scan(public.store_returns)}|Filter(=($x,'TN'))->Scan(public.store)|Filter(IS_NOT_NULL($x))->Filter(IS_NOT_NULL($x))->Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2000))->Scan(public.date_dim)|Filter(IS_NOT_NULL($x))->Scan(public.store_returns)}|Scan(public.customer)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[0:ASCENDING:LAST])->Project[$x]->Join(INNER,<($x,$x)&=($x,$x)){Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2000))->Scan(public.date_dim)|Scan(public.store_returns)}|Filter(=($x,'TN'))->Scan(public.store)|Project[$x,TIMES($x,1.2:DECIMAL(2, 1))]->Aggregate(groups=[0], calls=[AVG@1])->Project[$x,$x]->Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2000))->Scan(public.date_dim)|Scan(public.store_returns)}|Scan(public.customer)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC], fetch=[100])
  LogicalProject(exprs=[[$33]])
    LogicalJoin(condition=[AND(=($0, $32), =($3, $1))], joinType=[inner])
      LogicalProject(inputs=[0..2])
        LogicalJoin(condition=[AND(=($1, $3), >($2, *($4, 1.2:DECIMAL(2, 1))))], joinType=[inner])
          LogicalFilter(condition=[IS NOT NULL($0)])
            LogicalFilter(condition=[IS NOT NULL($1)])
              LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
                LogicalProject(exprs=[[$1, $2, $3]])
                  LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$3, $7, $14]])
                      LogicalFilter(condition=[IS NOT NULL($0)])
                        JdbcTableScan(table=[[public, store_returns]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($6, 2000)])
                        JdbcTableScan(table=[[public, date_dim]])
          LogicalAggregate(group=[{0}], agg#0=[AVG($1)])
            LogicalProject(exprs=[[$1, $2]])
              LogicalFilter(condition=[IS NOT NULL($1)])
                LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
                  LogicalProject(exprs=[[$3, $7, $14]])
                    LogicalJoin(condition=[=($0, $20)], joinType=[inner])
                      JdbcTableScan(table=[[public, store_returns]])
                      LogicalFilter(condition=[=($6, 2000)])
                        JdbcTableScan(table=[[public, date_dim]])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalFilter(condition=[=($24, 'TN')])
          JdbcTableScan(table=[[public, store]])
        JdbcTableScan(table=[[public, customer]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC], fetch=[100])
  LogicalProject(exprs=[[$33]])
    LogicalJoin(condition=[AND(=($1, $50), >($2, $51), =($0, $32), =($1, $3))], joinType=[inner])
      LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
        LogicalProject(exprs=[[$1, $2, $3]])
          LogicalJoin(condition=[=($0, $4)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3, $7, $14]])
              JdbcTableScan(table=[[public, store_returns]])
            LogicalProject(inputs=[0])
              LogicalFilter(condition=[=($6, 2000)])
                JdbcTableScan(table=[[public, date_dim]])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalFilter(condition=[=($24, 'TN')])
          JdbcTableScan(table=[[public, store]])
        LogicalJoin(condition=[true], joinType=[inner])
          JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0], exprs=[[*($1, 1.2:DECIMAL(2, 1))]])
            LogicalAggregate(group=[{0}], agg#0=[AVG($1)])
              LogicalProject(exprs=[[$1, $2]])
                LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
                  LogicalProject(exprs=[[$1, $2, $3]])
                    LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$3, $7, $14]])
                        JdbcTableScan(table=[[public, store_returns]])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($6, 2000)])
                          JdbcTableScan(table=[[public, date_dim]])


Equivalence with transformations: false
-----------------------------------------------------
Query ID: TPCDS_Q5
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
-----------------------------------------------------
Query ID: TPCDS_Q6
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
-----------------------------------------------------
Query ID: TPCDS_Q9
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
-----------------------------------------------------
Query ID: TPCDS_Q24
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
-----------------------------------------------------
Query ID: TPCDS_Q30
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [JoinToCorrelateRule, FilterCorrelateRule, FilterAggregateTransposeRule, JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[0:ASCENDING:LAST, 1:ASCENDING:LAST, 2:ASCENDING:LAST, 3:ASCENDING:LAST, 4:ASCENDING:LAST, 5:ASCENDING:LAST, 6:ASCENDING:LAST, 7:ASCENDING:LAST, 8:ASCENDING:LAST, 9:ASCENDING:LAST, 10:ASCENDING:LAST, 11:ASCENDING:LAST, 12:ASCENDING:LAST])->Project[$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x]->Join(INNER,<($x,$x)&=($x,$x)){Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2000))->Scan(public.date_dim)|Scan(public.customer_address)|Scan(public.web_returns)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2000))->Scan(public.date_dim)|Scan(public.customer_address)|Scan(public.web_returns)}|Filter(=($x,'IN'))->Scan(public.customer_address)|Project[$x,TIMES($x,1.2:DECIMAL(2, 1))]->Aggregate(groups=[0], calls=[AVG@1])->Project[$x,$x]->Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2000))->Scan(public.date_dim)|Scan(public.customer_address)|Scan(public.web_returns)}|Scan(public.customer)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[0:ASCENDING:LAST, 1:ASCENDING:LAST, 2:ASCENDING:LAST, 3:ASCENDING:LAST, 4:ASCENDING:LAST, 5:ASCENDING:LAST, 6:ASCENDING:LAST, 7:ASCENDING:LAST, 8:ASCENDING:LAST, 9:ASCENDING:LAST, 10:ASCENDING:LAST, 11:ASCENDING:LAST, 12:ASCENDING:LAST])->Project[$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x]->Join(INNER,<($x,TIMES($x,1.2:DECIMAL(2, 1)))&=($x,$x)){Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2000))->Scan(public.date_dim)|Scan(public.customer_address)|Scan(public.web_returns)}|Aggregate(groups=[0], calls=[AVG@1])->Project[$x,$x]->Filter(IS_NOT_NULL($x))->Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2000))->Scan(public.date_dim)|Scan(public.customer_address)|Scan(public.web_returns)}|Filter(=($x,'IN'))->Scan(public.customer_address)|Scan(public.customer)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], sort4=[$4], sort5=[$5], sort6=[$6], sort7=[$7], sort8=[$8], sort9=[$9], sort10=[$10], sort11=[$11], sort12=[$12], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], dir5=[ASC], dir6=[ASC], dir7=[ASC], dir8=[ASC], dir9=[ASC], dir10=[ASC], dir11=[ASC], dir12=[ASC], fetch=[100])
  LogicalProject(exprs=[[$8, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $2]])
    LogicalJoin(condition=[AND(=($0, $7), =($1, $5), =($2, $6))], joinType=[inner])
      LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
        LogicalProject(exprs=[[$1, $6, $3]])
          LogicalJoin(condition=[AND(=($0, $4), =($2, $5))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$7, $10, $15]])
              JdbcTableScan(table=[[public, web_returns]])
            LogicalJoin(condition=[true], joinType=[inner])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[=($6, 2000)])
                  JdbcTableScan(table=[[public, date_dim]])
              LogicalProject(inputs=[0], exprs=[[$8]])
                JdbcTableScan(table=[[public, customer_address]])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalJoin(condition=[AND(=($2, $0), >($3, $1))], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[*($1, 1.2:DECIMAL(2, 1))]])
            LogicalAggregate(group=[{0}], agg#0=[AVG($1)])
              LogicalProject(exprs=[[$1, $2]])
                LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
                  LogicalProject(exprs=[[$1, $6, $3]])
                    LogicalJoin(condition=[AND(=($0, $4), =($2, $5))], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$7, $10, $15]])
                        JdbcTableScan(table=[[public, web_returns]])
                      LogicalJoin(condition=[true], joinType=[inner])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[=($6, 2000)])
                            JdbcTableScan(table=[[public, date_dim]])
                        LogicalProject(inputs=[0], exprs=[[$8]])
                          JdbcTableScan(table=[[public, customer_address]])
          LogicalAggregate(group=[{0, 1}])
            LogicalProject(exprs=[[$1, $2]])
              LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
                LogicalProject(exprs=[[$1, $6, $3]])
                  LogicalJoin(condition=[AND(=($0, $4), =($2, $5))], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$7, $10, $15]])
                      JdbcTableScan(table=[[public, web_returns]])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($6, 2000)])
                          JdbcTableScan(table=[[public, date_dim]])
                      LogicalProject(inputs=[0], exprs=[[$8]])
                        JdbcTableScan(table=[[public, customer_address]])
        LogicalJoin(condition=[=($4, $18)], joinType=[inner])
          JdbcTableScan(table=[[public, customer]])
          LogicalFilter(condition=[=($8, 'IN')])
            JdbcTableScan(table=[[public, customer_address]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], sort4=[$4], sort5=[$5], sort6=[$6], sort7=[$7], sort8=[$8], sort9=[$9], sort10=[$10], sort11=[$11], sort12=[$12], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], dir5=[ASC], dir6=[ASC], dir7=[ASC], dir8=[ASC], dir9=[ASC], dir10=[ASC], dir11=[ASC], dir12=[ASC], fetch=[100])
  LogicalProject(exprs=[[$17, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $2]])
    LogicalJoin(condition=[AND(=($3, $20), =($0, $16))], joinType=[inner])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalProject(inputs=[0..2])
          LogicalJoin(condition=[AND(=($1, $3), >($2, *($4, 1.2:DECIMAL(2, 1))))], joinType=[inner])
            LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
              LogicalProject(exprs=[[$1, $6, $3]])
                LogicalJoin(condition=[AND(=($2, $5), =($0, $4))], joinType=[inner])
                  LogicalProject(inputs=[0], exprs=[[$7, $10, $15]])
                    JdbcTableScan(table=[[public, web_returns]])
                  LogicalJoin(condition=[true], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($6, 2000)])
                        JdbcTableScan(table=[[public, date_dim]])
                    LogicalProject(inputs=[0], exprs=[[$8]])
                      JdbcTableScan(table=[[public, customer_address]])
            LogicalAggregate(group=[{0}], agg#0=[AVG($1)])
              LogicalProject(exprs=[[$1, $2]])
                LogicalFilter(condition=[IS NOT NULL($1)])
                  LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
                    LogicalProject(exprs=[[$7, $60, $15]])
                      LogicalJoin(condition=[=($10, $52)], joinType=[inner])
                        LogicalJoin(condition=[=($0, $24)], joinType=[inner])
                          JdbcTableScan(table=[[public, web_returns]])
                          LogicalFilter(condition=[=($6, 2000)])
                            JdbcTableScan(table=[[public, date_dim]])
                        JdbcTableScan(table=[[public, customer_address]])
        LogicalFilter(condition=[=($8, 'IN')])
          JdbcTableScan(table=[[public, customer_address]])
      JdbcTableScan(table=[[public, customer]])


Equivalence with transformations: false
LLM Equivalence B->A 2: false
-----------------------------------------------------
Query ID: TPCDS_Q34
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q41
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
-----------------------------------------------------
Query ID: TPCDS_Q44
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
-----------------------------------------------------
Query ID: TPCDS_Q46
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
-----------------------------------------------------
Query ID: TPCDS_Q47
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
-----------------------------------------------------
Query ID: TPCDS_Q53
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q63
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q65
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q69
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
-----------------------------------------------------
Query ID: TPCDS_Q81
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [FilterCorrelateRule, AggregateJoinTransposeRule, FilterJoinRule.JoinConditionPushRule, JoinAssociateRule, SortJoinTransposeRule, SortRemoveRedundantRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[0:ASCENDING:LAST, 1:ASCENDING:LAST, 2:ASCENDING:LAST, 3:ASCENDING:LAST, 4:ASCENDING:LAST, 5:ASCENDING:LAST, 6:ASCENDING:LAST, 7:ASCENDING:LAST, 8:ASCENDING:LAST, 9:ASCENDING:LAST, 10:ASCENDING:LAST, 11:ASCENDING:LAST, 12:ASCENDING:LAST, 13:ASCENDING:LAST, 14:ASCENDING:LAST, 15:ASCENDING:LAST])->Project[$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x]->Join(INNER,<($x,TIMES($x,1.2:DECIMAL(2, 1)))&=($x,$x)){Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2001))->Scan(public.date_dim)|Scan(public.catalog_returns)|Scan(public.customer_address)}|Aggregate(groups=[0], calls=[AVG@1])->Project[$x,$x]->Filter(IS_NOT_NULL($x))->Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2001))->Scan(public.date_dim)|Scan(public.catalog_returns)|Scan(public.customer_address)}|Filter(=($x,'TN'))->Scan(public.customer_address)|Scan(public.customer)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[0:ASCENDING:LAST, 1:ASCENDING:LAST, 2:ASCENDING:LAST, 3:ASCENDING:LAST, 4:ASCENDING:LAST, 5:ASCENDING:LAST, 6:ASCENDING:LAST, 7:ASCENDING:LAST, 8:ASCENDING:LAST, 9:ASCENDING:LAST, 10:ASCENDING:LAST, 11:ASCENDING:LAST, 12:ASCENDING:LAST, 13:ASCENDING:LAST, 14:ASCENDING:LAST, 15:ASCENDING:LAST])->Project[$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x]->Join(INNER,<($x,$x)&=($x,$x)){Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2001))->Scan(public.date_dim)|Scan(public.catalog_returns)|Scan(public.customer_address)}|Filter(=($x,'TN'))->Scan(public.customer_address)|Project[$x,TIMES($x,1.2:DECIMAL(2, 1))]->Aggregate(groups=[0], calls=[AVG@1])->Project[$x,$x]->Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2001))->Scan(public.date_dim)|Scan(public.catalog_returns)|Scan(public.customer_address)}|Scan(public.customer)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], sort4=[$4], sort5=[$5], sort6=[$6], sort7=[$7], sort8=[$8], sort9=[$9], sort10=[$10], sort11=[$11], sort12=[$12], sort13=[$13], sort14=[$14], sort15=[$15], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], dir5=[ASC], dir6=[ASC], dir7=[ASC], dir8=[ASC], dir9=[ASC], dir10=[ASC], dir11=[ASC], dir12=[ASC], dir13=[ASC], dir14=[ASC], dir15=[ASC], fetch=[100])
  LogicalProject(exprs=[[$17, $23, $24, $25, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $2]])
    LogicalJoin(condition=[AND(=($3, $20), =($0, $16))], joinType=[inner])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalProject(inputs=[0..2])
          LogicalJoin(condition=[AND(=($1, $3), >($2, *($4, 1.2:DECIMAL(2, 1))))], joinType=[inner])
            LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
              LogicalProject(exprs=[[$1, $6, $3]])
                LogicalJoin(condition=[AND(=($2, $5), =($0, $4))], joinType=[inner])
                  LogicalProject(inputs=[0], exprs=[[$7, $10, $20]])
                    JdbcTableScan(table=[[public, catalog_returns]])
                  LogicalJoin(condition=[true], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($6, 2001)])
                        JdbcTableScan(table=[[public, date_dim]])
                    LogicalProject(inputs=[0], exprs=[[$8]])
                      JdbcTableScan(table=[[public, customer_address]])
            LogicalAggregate(group=[{0}], agg#0=[AVG($1)])
              LogicalProject(exprs=[[$1, $2]])
                LogicalFilter(condition=[IS NOT NULL($1)])
                  LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
                    LogicalProject(exprs=[[$7, $63, $20]])
                      LogicalJoin(condition=[=($10, $55)], joinType=[inner])
                        LogicalJoin(condition=[=($0, $27)], joinType=[inner])
                          JdbcTableScan(table=[[public, catalog_returns]])
                          LogicalFilter(condition=[=($6, 2001)])
                            JdbcTableScan(table=[[public, date_dim]])
                        JdbcTableScan(table=[[public, customer_address]])
        LogicalFilter(condition=[=($8, 'TN')])
          JdbcTableScan(table=[[public, customer_address]])
      JdbcTableScan(table=[[public, customer]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], sort4=[$4], sort5=[$5], sort6=[$6], sort7=[$7], sort8=[$8], sort9=[$9], sort10=[$10], sort11=[$11], sort12=[$12], sort13=[$13], sort14=[$14], sort15=[$15], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], dir5=[ASC], dir6=[ASC], dir7=[ASC], dir8=[ASC], dir9=[ASC], dir10=[ASC], dir11=[ASC], dir12=[ASC], dir13=[ASC], dir14=[ASC], dir15=[ASC], fetch=[100])
  LogicalProject(exprs=[[$6, $12, $13, $14, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $2]])
    LogicalJoin(condition=[AND(=($0, $5), =($1, $3), >($2, $4))], joinType=[inner])
      LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
        LogicalProject(exprs=[[$1, $6, $3]])
          LogicalJoin(condition=[AND(=($2, $5), =($0, $4))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$7, $10, $20]])
              JdbcTableScan(table=[[public, catalog_returns]])
            LogicalJoin(condition=[true], joinType=[inner])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[=($6, 2001)])
                  JdbcTableScan(table=[[public, date_dim]])
              LogicalProject(inputs=[0], exprs=[[$8]])
                JdbcTableScan(table=[[public, customer_address]])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[*($1, 1.2:DECIMAL(2, 1))]])
          LogicalAggregate(group=[{0}], agg#0=[AVG($1)])
            LogicalProject(exprs=[[$1, $2]])
              LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
                LogicalProject(exprs=[[$1, $6, $3]])
                  LogicalJoin(condition=[AND(=($2, $5), =($0, $4))], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$7, $10, $20]])
                      JdbcTableScan(table=[[public, catalog_returns]])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($6, 2001)])
                          JdbcTableScan(table=[[public, date_dim]])
                      LogicalProject(inputs=[0], exprs=[[$8]])
                        JdbcTableScan(table=[[public, customer_address]])
        LogicalJoin(condition=[=($4, $18)], joinType=[inner])
          JdbcTableScan(table=[[public, customer]])
          LogicalFilter(condition=[=($8, 'TN')])
            JdbcTableScan(table=[[public, customer_address]])


Equivalence with transformations: false
LLM Equivalence A->B 2: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [JoinToCorrelateRule, FilterCorrelateRule, JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[0:ASCENDING:LAST, 1:ASCENDING:LAST, 2:ASCENDING:LAST, 3:ASCENDING:LAST, 4:ASCENDING:LAST, 5:ASCENDING:LAST, 6:ASCENDING:LAST, 7:ASCENDING:LAST, 8:ASCENDING:LAST, 9:ASCENDING:LAST, 10:ASCENDING:LAST, 11:ASCENDING:LAST, 12:ASCENDING:LAST, 13:ASCENDING:LAST, 14:ASCENDING:LAST, 15:ASCENDING:LAST])->Project[$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x]->Join(INNER,<($x,$x)&=($x,$x)){Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2001))->Scan(public.date_dim)|Scan(public.catalog_returns)|Scan(public.customer_address)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2001))->Scan(public.date_dim)|Scan(public.catalog_returns)|Scan(public.customer_address)}|Filter(=($x,'TN'))->Scan(public.customer_address)|Project[$x,TIMES($x,1.2:DECIMAL(2, 1))]->Aggregate(groups=[0], calls=[AVG@1])->Project[$x,$x]->Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2001))->Scan(public.date_dim)|Scan(public.catalog_returns)|Scan(public.customer_address)}|Scan(public.customer)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[0:ASCENDING:LAST, 1:ASCENDING:LAST, 2:ASCENDING:LAST, 3:ASCENDING:LAST, 4:ASCENDING:LAST, 5:ASCENDING:LAST, 6:ASCENDING:LAST, 7:ASCENDING:LAST, 8:ASCENDING:LAST, 9:ASCENDING:LAST, 10:ASCENDING:LAST, 11:ASCENDING:LAST, 12:ASCENDING:LAST, 13:ASCENDING:LAST, 14:ASCENDING:LAST, 15:ASCENDING:LAST])->Project[$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x,$x]->Join(INNER,<($x,TIMES($x,1.2:DECIMAL(2, 1)))&=($x,$x)){Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2001))->Scan(public.date_dim)|Scan(public.catalog_returns)|Scan(public.customer_address)}|Aggregate(groups=[0], calls=[AVG@1])->Project[$x,$x]->Filter(IS_NOT_NULL($x))->Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,2001))->Scan(public.date_dim)|Scan(public.catalog_returns)|Scan(public.customer_address)}|Filter(=($x,'TN'))->Scan(public.customer_address)|Scan(public.customer)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], sort4=[$4], sort5=[$5], sort6=[$6], sort7=[$7], sort8=[$8], sort9=[$9], sort10=[$10], sort11=[$11], sort12=[$12], sort13=[$13], sort14=[$14], sort15=[$15], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], dir5=[ASC], dir6=[ASC], dir7=[ASC], dir8=[ASC], dir9=[ASC], dir10=[ASC], dir11=[ASC], dir12=[ASC], dir13=[ASC], dir14=[ASC], dir15=[ASC], fetch=[100])
  LogicalProject(exprs=[[$8, $14, $15, $16, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $2]])
    LogicalJoin(condition=[AND(=($0, $7), =($1, $5), =($2, $6))], joinType=[inner])
      LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
        LogicalProject(exprs=[[$1, $6, $3]])
          LogicalJoin(condition=[AND(=($0, $4), =($2, $5))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$7, $10, $20]])
              JdbcTableScan(table=[[public, catalog_returns]])
            LogicalJoin(condition=[true], joinType=[inner])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[=($6, 2001)])
                  JdbcTableScan(table=[[public, date_dim]])
              LogicalProject(inputs=[0], exprs=[[$8]])
                JdbcTableScan(table=[[public, customer_address]])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalJoin(condition=[AND(=($2, $0), >($3, $1))], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[*($1, 1.2:DECIMAL(2, 1))]])
            LogicalAggregate(group=[{0}], agg#0=[AVG($1)])
              LogicalProject(exprs=[[$1, $2]])
                LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
                  LogicalProject(exprs=[[$1, $6, $3]])
                    LogicalJoin(condition=[AND(=($0, $4), =($2, $5))], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$7, $10, $20]])
                        JdbcTableScan(table=[[public, catalog_returns]])
                      LogicalJoin(condition=[true], joinType=[inner])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[=($6, 2001)])
                            JdbcTableScan(table=[[public, date_dim]])
                        LogicalProject(inputs=[0], exprs=[[$8]])
                          JdbcTableScan(table=[[public, customer_address]])
          LogicalAggregate(group=[{0, 1}])
            LogicalProject(exprs=[[$1, $2]])
              LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
                LogicalProject(exprs=[[$1, $6, $3]])
                  LogicalJoin(condition=[AND(=($0, $4), =($2, $5))], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$7, $10, $20]])
                      JdbcTableScan(table=[[public, catalog_returns]])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($6, 2001)])
                          JdbcTableScan(table=[[public, date_dim]])
                      LogicalProject(inputs=[0], exprs=[[$8]])
                        JdbcTableScan(table=[[public, customer_address]])
        LogicalJoin(condition=[=($4, $18)], joinType=[inner])
          JdbcTableScan(table=[[public, customer]])
          LogicalFilter(condition=[=($8, 'TN')])
            JdbcTableScan(table=[[public, customer_address]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], sort4=[$4], sort5=[$5], sort6=[$6], sort7=[$7], sort8=[$8], sort9=[$9], sort10=[$10], sort11=[$11], sort12=[$12], sort13=[$13], sort14=[$14], sort15=[$15], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], dir5=[ASC], dir6=[ASC], dir7=[ASC], dir8=[ASC], dir9=[ASC], dir10=[ASC], dir11=[ASC], dir12=[ASC], dir13=[ASC], dir14=[ASC], dir15=[ASC], fetch=[100])
  LogicalProject(exprs=[[$17, $23, $24, $25, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $2]])
    LogicalJoin(condition=[AND(=($3, $20), =($0, $16))], joinType=[inner])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalProject(inputs=[0..2])
          LogicalJoin(condition=[AND(=($1, $3), >($2, *($4, 1.2:DECIMAL(2, 1))))], joinType=[inner])
            LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
              LogicalProject(exprs=[[$1, $6, $3]])
                LogicalJoin(condition=[AND(=($2, $5), =($0, $4))], joinType=[inner])
                  LogicalProject(inputs=[0], exprs=[[$7, $10, $20]])
                    JdbcTableScan(table=[[public, catalog_returns]])
                  LogicalJoin(condition=[true], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($6, 2001)])
                        JdbcTableScan(table=[[public, date_dim]])
                    LogicalProject(inputs=[0], exprs=[[$8]])
                      JdbcTableScan(table=[[public, customer_address]])
            LogicalAggregate(group=[{0}], agg#0=[AVG($1)])
              LogicalProject(exprs=[[$1, $2]])
                LogicalFilter(condition=[IS NOT NULL($1)])
                  LogicalAggregate(group=[{0, 1}], ctr_total_return=[SUM($2)])
                    LogicalProject(exprs=[[$7, $63, $20]])
                      LogicalJoin(condition=[=($10, $55)], joinType=[inner])
                        LogicalJoin(condition=[=($0, $27)], joinType=[inner])
                          JdbcTableScan(table=[[public, catalog_returns]])
                          LogicalFilter(condition=[=($6, 2001)])
                            JdbcTableScan(table=[[public, date_dim]])
                        JdbcTableScan(table=[[public, customer_address]])
        LogicalFilter(condition=[=($8, 'TN')])
          JdbcTableScan(table=[[public, customer_address]])
      JdbcTableScan(table=[[public, customer]])


Equivalence with transformations: false
LLM Equivalence B->A 2: false
-----------------------------------------------------
Query ID: TPCDS_Q86
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q89
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
-----------------------------------------------------
Query ID: TPCDS_Q93
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Transformations 1 (A to X): [AggregateMergeRule, AggregateExtractProjectRule, ReduceExpressionsRule.ProjectReduceExpressionsRule, AggregateProjectMergeRule]
-----------------------------------------------------
Query ID: TPCDS_Q96
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [SortRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[0:ASCENDING:LAST])->Aggregate(groups=[], calls=[COUNT@-1])->Join(INNER,=($x,$x)){Filter(=($x,'ese'))->Scan(public.store)|Filter(=($x,0))->Scan(public.household_demographics)|Filter(AND(<=($x,30)&RANGE($x,8,8)))->Scan(public.time_dim)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest Rel2: Aggregate(groups=[], calls=[COUNT@-1])->Join(INNER,=($x,$x)){Filter(=($x,'ese'))->Scan(public.store)|Filter(=($x,0))->Scan(public.household_demographics)|Filter(AND(<=($x,30)&RANGE($x,8,8)))->Scan(public.time_dim)|Scan(public.store_sales)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC], fetch=[100])
  LogicalAggregate(group=[{}], EXPR$0=[COUNT()])
    LogicalJoin(condition=[AND(=($7, $38), =($1, $28))], joinType=[inner])
      LogicalJoin(condition=[=($5, $23)], joinType=[inner])
        JdbcTableScan(table=[[public, store_sales]])
        LogicalFilter(condition=[=($3, 0)])
          JdbcTableScan(table=[[public, household_demographics]])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalFilter(condition=[AND(=($3, 8), >=($4, 30))])
          JdbcTableScan(table=[[public, time_dim]])
        LogicalFilter(condition=[=($5, 'ese')])
          JdbcTableScan(table=[[public, store]])


Rel2: 
LogicalAggregate(group=[{}], EXPR$0=[COUNT()])
  LogicalJoin(condition=[AND(=($7, $38), =($1, $28))], joinType=[inner])
    LogicalJoin(condition=[=($5, $23)], joinType=[inner])
      JdbcTableScan(table=[[public, store_sales]])
      LogicalFilter(condition=[=($3, 0)])
        JdbcTableScan(table=[[public, household_demographics]])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalFilter(condition=[AND(=($3, 8), >=($4, 30))])
        JdbcTableScan(table=[[public, time_dim]])
      LogicalFilter(condition=[=($5, 'ese')])
        JdbcTableScan(table=[[public, store]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [SortRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[0:ASCENDING:LAST])->Aggregate(groups=[], calls=[COUNT@-1])->Join(INNER,=($x,$x)){Filter(=($x,'ese'))->Scan(public.store)|Filter(=($x,0))->Scan(public.household_demographics)|Filter(AND(<=($x,30)&RANGE($x,8,8)))->Scan(public.time_dim)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest Rel2: Aggregate(groups=[], calls=[COUNT@-1])->Join(INNER,=($x,$x)){Filter(=($x,'ese'))->Scan(public.store)|Filter(=($x,0))->Scan(public.household_demographics)|Filter(AND(<=($x,30)&RANGE($x,8,8)))->Scan(public.time_dim)|Scan(public.store_sales)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC], fetch=[100])
  LogicalAggregate(group=[{}], EXPR$0=[COUNT()])
    LogicalJoin(condition=[AND(=($7, $38), =($1, $28))], joinType=[inner])
      LogicalJoin(condition=[=($5, $23)], joinType=[inner])
        JdbcTableScan(table=[[public, store_sales]])
        LogicalFilter(condition=[=($3, 0)])
          JdbcTableScan(table=[[public, household_demographics]])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalFilter(condition=[AND(=($3, 8), >=($4, 30))])
          JdbcTableScan(table=[[public, time_dim]])
        LogicalFilter(condition=[=($5, 'ese')])
          JdbcTableScan(table=[[public, store]])


Rel2: 
LogicalAggregate(group=[{}], EXPR$0=[COUNT()])
  LogicalJoin(condition=[AND(=($7, $38), =($1, $28))], joinType=[inner])
    LogicalJoin(condition=[=($5, $23)], joinType=[inner])
      JdbcTableScan(table=[[public, store_sales]])
      LogicalFilter(condition=[=($3, 0)])
        JdbcTableScan(table=[[public, household_demographics]])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalFilter(condition=[AND(=($3, 8), >=($4, 30))])
        JdbcTableScan(table=[[public, time_dim]])
      LogicalFilter(condition=[=($5, 'ese')])
        JdbcTableScan(table=[[public, store]])


Equivalence with transformations: false
LLM Equivalence B->A 1: false
LLM Transformations 1 (A to X): [SortRemoveRedundantRule]
