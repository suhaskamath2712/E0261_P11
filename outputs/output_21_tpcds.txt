-----------------------------------------------------
Query ID: TPCDS_Q1
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q5
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q6
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q9
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q24
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q30
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q34
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q41
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q44
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q46
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q47
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q53
Equivalence without transformations: false
LLM Equivalence 1: true
LLM Transformations 1: []
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[2:ASCENDING:LAST, 1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(CASE(<($x,0),<(0.1:DECIMAL(2, 1),DIVIDE(OTHER_FUNCTION(MINUS($x,$x)),$x)),false))->Project[$x,$x,DIVIDE(CASE(<(0:BIGINT,COUNT($x)),SUM0($x),null:DECIMAL(19, 2)),COUNT($x))]->Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(OR(=($x,1186),=($x,PLUS(1,1186)),=($x,PLUS(10,1186)),=($x,PLUS(11,1186)),=($x,PLUS(1186,2)),=($x,PLUS(1186,3)),=($x,PLUS(1186,4)),=($x,PLUS(1186,5)),=($x,PLUS(1186,6)),=($x,PLUS(1186,7)),=($x,PLUS(1186,8)),=($x,PLUS(1186,9))))->Scan(public.date_dim)|Filter(OR(AND(SEARCH($x,Sarg['Books', 'Children', 'Electronics'])&SEARCH($x,Sarg['exportiunivamalg #9', 'scholaramalgamalg #14', 'scholaramalgamalg #7', 'scholaramalgamalg #9'])&SEARCH($x,Sarg['personal', 'portable', 'reference', 'self-help'])),AND(SEARCH($x,Sarg['Men', 'Music', 'Women'])&SEARCH($x,Sarg['accessories', 'classical', 'fragrances', 'pants'])&SEARCH($x,Sarg['amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1']))))->Scan(public.item)|Scan(public.store)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[2:ASCENDING:LAST, 1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(CASE(<($x,0),<(0.1:DECIMAL(2, 1),DIVIDE(OTHER_FUNCTION(MINUS($x,$x)),$x)),false))->Project[$x,$x,DIVIDE(CASE(<(0:BIGINT,COUNT($x)),SUM0($x),null:DECIMAL(19, 2)),COUNT($x))]->Aggregate(groups=[0, 1], calls=[SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(OR(AND(SEARCH($x,Sarg['Books', 'Children', 'Electronics'])&SEARCH($x,Sarg['exportiunivamalg #9', 'scholaramalgamalg #14', 'scholaramalgamalg #7', 'scholaramalgamalg #9'])&SEARCH($x,Sarg['personal', 'portable', 'reference', 'self-help'])),AND(SEARCH($x,Sarg['Men', 'Music', 'Women'])&SEARCH($x,Sarg['accessories', 'classical', 'fragrances', 'pants'])&SEARCH($x,Sarg['amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1']))))->Scan(public.item)|Filter(RANGE($x,1186,1197))->Scan(public.date_dim)|Scan(public.store)|Scan(public.store_sales)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$2], sort1=[$1], sort2=[$0], dir0=[ASC], dir1=[ASC], dir2=[ASC], fetch=[100])
  LogicalFilter(condition=[CASE(>($2, 0), >(/(ABS(-($1, $2)), $2), 0.1:DECIMAL(2, 1)), false)])
    LogicalProject(inputs=[0], exprs=[[$2, /(CASE(>(COUNT($2) OVER (PARTITION BY $0), 0), $SUM0($2) OVER (PARTITION BY $0), null:DECIMAL(19, 2)), COUNT($2) OVER (PARTITION BY $0))]])
      LogicalAggregate(group=[{0, 1}], sum_sales=[SUM($2)])
        LogicalProject(exprs=[[$13, $55, $35]])
          LogicalJoin(condition=[=($29, $73)], joinType=[inner])
            LogicalJoin(condition=[=($24, $0)], joinType=[inner])
              LogicalFilter(condition=[OR(AND(SEARCH($12, Sarg['Books':CHAR(11), 'Children':CHAR(11), 'Electronics']:CHAR(11)), SEARCH($10, Sarg['personal':CHAR(9), 'portable':CHAR(9), 'reference', 'self-help']:CHAR(9)), SEARCH($8, Sarg['exportiunivamalg #9':CHAR(21), 'scholaramalgamalg #14', 'scholaramalgamalg #7':CHAR(21), 'scholaramalgamalg #9':CHAR(21)]:CHAR(21))), AND(SEARCH($12, Sarg['Men':CHAR(5), 'Music', 'Women']:CHAR(5)), SEARCH($10, Sarg['accessories', 'classical':CHAR(11), 'fragrances':CHAR(11), 'pants':CHAR(11)]:CHAR(11)), SEARCH($8, Sarg['amalgimporto #1':CHAR(18), 'edu packscholar #1', 'exportiimporto #1':CHAR(18), 'importoamalg #1':CHAR(18)]:CHAR(18))))])
                JdbcTableScan(table=[[public, item]])
              LogicalJoin(condition=[=($0, $23)], joinType=[inner])
                JdbcTableScan(table=[[public, store_sales]])
                LogicalFilter(condition=[OR(=($3, 1186), =($3, +(1186, 1)), =($3, +(1186, 2)), =($3, +(1186, 3)), =($3, +(1186, 4)), =($3, +(1186, 5)), =($3, +(1186, 6)), =($3, +(1186, 7)), =($3, +(1186, 8)), =($3, +(1186, 9)), =($3, +(1186, 10)), =($3, +(1186, 11)))])
                  JdbcTableScan(table=[[public, date_dim]])
            JdbcTableScan(table=[[public, store]])


Rel2: 
LogicalSort(sort0=[$2], sort1=[$1], sort2=[$0], dir0=[ASC], dir1=[ASC], dir2=[ASC], fetch=[100])
  LogicalFilter(condition=[CASE(>($2, 0), >(/(ABS(-($1, $2)), $2), 0.1:DECIMAL(2, 1)), false)])
    LogicalProject(inputs=[0], exprs=[[$2, /(CASE(>(COUNT($2) OVER (PARTITION BY $0), 0), $SUM0($2) OVER (PARTITION BY $0), null:DECIMAL(19, 2)), COUNT($2) OVER (PARTITION BY $0))]])
      LogicalAggregate(group=[{0, 1}], sum_sales=[SUM($2)])
        LogicalProject(exprs=[[$13, $55, $35]])
          LogicalJoin(condition=[=($29, $73)], joinType=[inner])
            LogicalJoin(condition=[=($24, $0)], joinType=[inner])
              LogicalFilter(condition=[OR(AND(SEARCH($12, Sarg['Books':CHAR(11), 'Children':CHAR(11), 'Electronics']:CHAR(11)), SEARCH($10, Sarg['personal':CHAR(9), 'portable':CHAR(9), 'reference', 'self-help']:CHAR(9)), SEARCH($8, Sarg['exportiunivamalg #9':CHAR(21), 'scholaramalgamalg #14', 'scholaramalgamalg #7':CHAR(21), 'scholaramalgamalg #9':CHAR(21)]:CHAR(21))), AND(SEARCH($12, Sarg['Men':CHAR(5), 'Music', 'Women']:CHAR(5)), SEARCH($10, Sarg['accessories', 'classical':CHAR(11), 'fragrances':CHAR(11), 'pants':CHAR(11)]:CHAR(11)), SEARCH($8, Sarg['amalgimporto #1':CHAR(18), 'edu packscholar #1', 'exportiimporto #1':CHAR(18), 'importoamalg #1':CHAR(18)]:CHAR(18))))])
                JdbcTableScan(table=[[public, item]])
              LogicalJoin(condition=[=($0, $23)], joinType=[inner])
                JdbcTableScan(table=[[public, store_sales]])
                LogicalFilter(condition=[SEARCH($3, Sarg[[1186..1197]])])
                  JdbcTableScan(table=[[public, date_dim]])
            JdbcTableScan(table=[[public, store]])


Equivalence with transformations: false
LLM Equivalence 2: false
-----------------------------------------------------
Query ID: TPCDS_Q63
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q65
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q69
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q81
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q86
Equivalence without transformations: false
LLM Equivalence 1: true
LLM Transformations 1: []
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[3:DESCENDING:FIRST, 5:ASCENDING:LAST, 4:ASCENDING:LAST])->Project[$x,$x,$x,PLUS($x,$x),RANK(),CASE(=(0:BIGINT,PLUS($x,$x)),$x,null:CHAR(50))]->Aggregate(groups=[0, 1], calls=[GROUPING@0, GROUPING@1, SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(AND(RANGE($x,1186,PLUS(11,1186))))->Scan(public.date_dim)|Scan(public.item)|Scan(public.web_sales)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[3:DESCENDING:FIRST, 5:ASCENDING:LAST, 4:ASCENDING:LAST])->Project[$x,$x,$x,PLUS($x,$x),RANK(),CASE(=(0:BIGINT,PLUS($x,$x)),$x,null:CHAR(50))]->Aggregate(groups=[0, 1], calls=[GROUPING@0, GROUPING@1, SUM@2])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(RANGE($x,1186,1197))->Scan(public.date_dim)|Scan(public.item)|Scan(public.web_sales)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC], dir2=[ASC], fetch=[100])
  LogicalProject(exprs=[[$2, $0, $1, +($3, $4), RANK() OVER (PARTITION BY +($3, $4), CASE(=($4, 0), $0, null:CHAR(50)) ORDER BY $2 DESC), CASE(=(+($3, $4), 0), $0, null:CHAR(50))]])
    LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], total_sum=[SUM($2)], agg#1=[GROUPING($0)], agg#2=[GROUPING($1)])
      LogicalProject(exprs=[[$74, $72, $29]])
        LogicalJoin(condition=[AND(=($62, $3), =($34, $0))], joinType=[inner])
          JdbcTableScan(table=[[public, web_sales]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalFilter(condition=[AND(>=($3, 1186), <=($3, +(1186, 11)))])
              JdbcTableScan(table=[[public, date_dim]])
            JdbcTableScan(table=[[public, item]])


Rel2: 
LogicalSort(sort0=[$3], sort1=[$5], sort2=[$4], dir0=[DESC], dir1=[ASC], dir2=[ASC], fetch=[100])
  LogicalProject(exprs=[[$2, $0, $1, +($3, $4), RANK() OVER (PARTITION BY +($3, $4), CASE(=(+($3, $4), 0), $0, null:CHAR(50)) ORDER BY $2 DESC), CASE(=(+($3, $4), 0), $0, null:CHAR(50))]])
    LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], total_sum=[SUM($2)], agg#1=[GROUPING($0)], agg#2=[GROUPING($1)])
      LogicalProject(exprs=[[$74, $72, $29]])
        LogicalJoin(condition=[AND(=($62, $3), =($34, $0))], joinType=[inner])
          JdbcTableScan(table=[[public, web_sales]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalFilter(condition=[SEARCH($3, Sarg[[1186..1197]])])
              JdbcTableScan(table=[[public, date_dim]])
            JdbcTableScan(table=[[public, item]])


Equivalence with transformations: false
LLM Equivalence 2: false
-----------------------------------------------------
Query ID: TPCDS_Q89
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q93
Equivalence without transformations: false
LLM Equivalence 1: false
-----------------------------------------------------
Query ID: TPCDS_Q96
Equivalence without transformations: false
LLM Equivalence 1: false
