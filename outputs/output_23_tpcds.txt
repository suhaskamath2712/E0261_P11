-----------------------------------------------------
Query ID: TPCDS_Q1
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q2
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q3
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q4
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q5
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence B->A (X): true
LLM Transformations 1 (A to X): [JoinRightUnionTransposeRule, SemiJoinRule.JoinOnUniqueToSemiJoinRule, ProjectSetOpTransposeRule, ProjectRemoveRule, AggregateMergeRule, SortRemoveRedundantRule]
LLM Transformations 2 (B to X): [AggregateRemoveRule, JoinLeftUnionTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[0:ASCENDING:LAST, 1:ASCENDING:LAST])->Aggregate(groups=[channel, id], calls=[SUM(profit), SUM(returns), SUM(sales)])->Union(ALL)[Project['catalog channel',OTHER('catalog_page',$x),$x,$x,MINUS($x,$x)]->Aggregate(groups=[cp_catalog_page_id], calls=[SUM(net_loss), SUM(profit), SUM(return_amt), SUM(sales_price)])->Union(ALL)[Join(INNER,=($x,$x)){Filter(RANGE($x,2000-08-19,2000-09-02))->Scan(public.date_dim)|Project[$x,$x,$x,$x,0:DECIMAL(7, 2),0:DECIMAL(7, 2)]->Scan(public.catalog_sales)|Scan(public.catalog_page)}, Join(INNER,=($x,$x)){Filter(RANGE($x,2000-08-19,2000-09-02))->Scan(public.date_dim)|Project[$x,$x,0:DECIMAL(7, 2),0:DECIMAL(7, 2),$x,$x]->Scan(public.catalog_returns)|Scan(public.catalog_page)}], Project['store channel',OTHER('store',$x),$x,$x,MINUS($x,$x)]->Aggregate(groups=[s_store_id], calls=[SUM(net_loss), SUM(profit), SUM(return_amt), SUM(sales_price)])->Join(INNER,=($x,$x)){Scan(public.store)|Union(ALL)[Join(INNER,=($x,$x)){Filter(RANGE($x,2000-08-19,2000-09-02))->Scan(public.date_dim)|Project[$x,$x,$x,$x,0:DECIMAL(7, 2),0:DECIMAL(7, 2)]->Scan(public.store_sales)}, Join(INNER,=($x,$x)){Filter(RANGE($x,2000-08-19,2000-09-02))->Scan(public.date_dim)|Project[$x,$x,0:DECIMAL(7, 2),0:DECIMAL(7, 2),$x,$x]->Scan(public.store_returns)}]}, Project['web channel',OTHER('web_site',$x),$x,$x,MINUS($x,$x)]->Aggregate(groups=[web_site_id], calls=[SUM(net_loss), SUM(profit), SUM(return_amt), SUM(sales_price)])->Join(INNER,=($x,$x)){Scan(public.web_site)|Union(ALL)[Join(INNER,=($x,$x)){Filter(RANGE($x,2000-08-19,2000-09-02))->Scan(public.date_dim)|Project[$x,$x,$x,$x,0:DECIMAL(7, 2),0:DECIMAL(7, 2)]->Scan(public.web_sales)}, Join(INNER,=($x,$x)){Filter(RANGE($x,2000-08-19,2000-09-02))->Scan(public.date_dim)|Project[$x,$x,0:DECIMAL(7, 2),0:DECIMAL(7, 2),$x,$x]->Join(LEFT,=($x,$x)){Project[$x,$x,$x,$x,$x]->Scan(public.web_returns)|Project[$x,$x,$x]->Scan(public.web_sales)}}]}]
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[0:ASCENDING:LAST, 1:ASCENDING:LAST])->Aggregate(groups=[channel, id], calls=[SUM(profit), SUM(returns), SUM(sales)])->Union(ALL)[Project['catalog channel',OTHER('catalog_page',$x),$x,$x,MINUS($x,$x)]->Aggregate(groups=[cp_catalog_page_id], calls=[SUM(net_loss), SUM(profit), SUM(return_amt), SUM(sales_price)])->Join(INNER,=($x,$x)){Scan(public.catalog_page)|Union(ALL)[Project[$x,$x,$x,0:DECIMAL(7, 2),0:DECIMAL(7, 2)]->Join(INNER,=($x,$x)){Aggregate(groups=[d_date_sk], calls=[])->Filter(RANGE($x,2000-08-19,2000-09-02))->Scan(public.date_dim)|Scan(public.catalog_sales)}, Project[$x,0:DECIMAL(7, 2),0:DECIMAL(7, 2),$x,$x]->Join(INNER,=($x,$x)){Aggregate(groups=[d_date_sk], calls=[])->Filter(RANGE($x,2000-08-19,2000-09-02))->Scan(public.date_dim)|Scan(public.catalog_returns)}]}, Project['store channel',OTHER('store',$x),$x,$x,MINUS($x,$x)]->Aggregate(groups=[s_store_id], calls=[SUM(net_loss), SUM(profit), SUM(return_amt), SUM(sales_price)])->Join(INNER,=($x,$x)){Scan(public.store)|Union(ALL)[Project[$x,$x,$x,0:DECIMAL(7, 2),0:DECIMAL(7, 2)]->Join(INNER,=($x,$x)){Aggregate(groups=[d_date_sk], calls=[])->Filter(RANGE($x,2000-08-19,2000-09-02))->Scan(public.date_dim)|Scan(public.store_sales)}, Project[$x,0:DECIMAL(7, 2),0:DECIMAL(7, 2),$x,$x]->Join(INNER,=($x,$x)){Aggregate(groups=[d_date_sk], calls=[])->Filter(RANGE($x,2000-08-19,2000-09-02))->Scan(public.date_dim)|Scan(public.store_returns)}]}, Project['web channel',OTHER('web_site',$x),$x,$x,MINUS($x,$x)]->Aggregate(groups=[web_site_id], calls=[SUM(net_loss), SUM(profit), SUM(return_amt), SUM(sales_price)])->Join(INNER,=($x,$x)){Scan(public.web_site)|Union(ALL)[Project[$x,$x,$x,0:DECIMAL(7, 2),0:DECIMAL(7, 2)]->Join(INNER,=($x,$x)){Aggregate(groups=[d_date_sk], calls=[])->Filter(RANGE($x,2000-08-19,2000-09-02))->Scan(public.date_dim)|Scan(public.web_sales)}, Project[$x,0:DECIMAL(7, 2),0:DECIMAL(7, 2),$x,$x]->Join(LEFT,=($x,$x)){Project[$x,$x,$x,$x]->Join(INNER,=($x,$x)){Aggregate(groups=[d_date_sk], calls=[])->Filter(RANGE($x,2000-08-19,2000-09-02))->Scan(public.date_dim)|Scan(public.web_returns)}|Project[$x,$x,$x]->Scan(public.web_sales)}]}]

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100])
  LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], sales=[SUM($2)], returns=[SUM($3)], profit=[SUM($4)])
    LogicalUnion(all=[true])
      LogicalUnion(all=[true])
        LogicalProject(exprs=[['store channel', ||('store', $0), $1, $3, -($2, $4)]])
          LogicalAggregate(group=[{1}], sales=[SUM($31)], profit=[SUM($32)], returns=[SUM($33)], profit_loss=[SUM($34)])
            LogicalJoin(condition=[=($29, $0)], joinType=[inner])
              JdbcTableScan(table=[[public, store]])
              LogicalUnion(all=[true])
                LogicalJoin(condition=[=($1, $6)], joinType=[inner])
                  LogicalProject(exprs=[[$7, $0, $15, $22, 0:DECIMAL(7, 2), 0:DECIMAL(7, 2)]])
                    JdbcTableScan(table=[[public, store_sales]])
                  LogicalFilter(condition=[AND(>=($2, 2000-08-19), <=($2, +(2000-08-19, 1209600000:INTERVAL DAY)))])
                    JdbcTableScan(table=[[public, date_dim]])
                LogicalJoin(condition=[=($1, $6)], joinType=[inner])
                  LogicalProject(exprs=[[$7, $0, 0:DECIMAL(7, 2), 0:DECIMAL(7, 2), $11, $19]])
                    JdbcTableScan(table=[[public, store_returns]])
                  LogicalFilter(condition=[AND(>=($2, 2000-08-19), <=($2, +(2000-08-19, 1209600000:INTERVAL DAY)))])
                    JdbcTableScan(table=[[public, date_dim]])
        LogicalProject(exprs=[['catalog channel', ||('catalog_page', $0), $1, $3, -($2, $4)]])
          LogicalAggregate(group=[{35}], sales=[SUM($2)], profit=[SUM($3)], returns=[SUM($4)], profit_loss=[SUM($5)])
            LogicalUnion(all=[true])
              LogicalJoin(condition=[=($0, $34)], joinType=[inner])
                LogicalJoin(condition=[=($1, $6)], joinType=[inner])
                  LogicalProject(exprs=[[$12, $0, $23, $33, 0:DECIMAL(7, 2), 0:DECIMAL(7, 2)]])
                    JdbcTableScan(table=[[public, catalog_sales]])
                  LogicalFilter(condition=[AND(>=($2, 2000-08-19), <=($2, +(2000-08-19, 1209600000:INTERVAL DAY)))])
                    JdbcTableScan(table=[[public, date_dim]])
                JdbcTableScan(table=[[public, catalog_page]])
              LogicalJoin(condition=[=($0, $34)], joinType=[inner])
                LogicalJoin(condition=[=($1, $6)], joinType=[inner])
                  LogicalProject(exprs=[[$12, $0, 0:DECIMAL(7, 2), 0:DECIMAL(7, 2), $18, $26]])
                    JdbcTableScan(table=[[public, catalog_returns]])
                  LogicalFilter(condition=[AND(>=($2, 2000-08-19), <=($2, +(2000-08-19, 1209600000:INTERVAL DAY)))])
                    JdbcTableScan(table=[[public, date_dim]])
                JdbcTableScan(table=[[public, catalog_page]])
      LogicalProject(exprs=[['web channel', ||('web_site', $0), $1, $3, -($2, $4)]])
        LogicalAggregate(group=[{1}], sales=[SUM($28)], profit=[SUM($29)], returns=[SUM($30)], profit_loss=[SUM($31)])
          LogicalJoin(condition=[=($26, $0)], joinType=[inner])
            JdbcTableScan(table=[[public, web_site]])
            LogicalUnion(all=[true])
              LogicalJoin(condition=[=($1, $6)], joinType=[inner])
                LogicalProject(exprs=[[$13, $0, $23, $33, 0:DECIMAL(7, 2), 0:DECIMAL(7, 2)]])
                  JdbcTableScan(table=[[public, web_sales]])
                LogicalFilter(condition=[AND(>=($2, 2000-08-19), <=($2, +(2000-08-19, 1209600000:INTERVAL DAY)))])
                  JdbcTableScan(table=[[public, date_dim]])
              LogicalJoin(condition=[=($1, $6)], joinType=[inner])
                LogicalProject(exprs=[[$6, $0, 0:DECIMAL(7, 2), 0:DECIMAL(7, 2), $3, $4]])
                  LogicalJoin(condition=[AND(=($1, $5), =($2, $7))], joinType=[left])
                    LogicalProject(inputs=[0], exprs=[[$2, $13, $15, $23]])
                      JdbcTableScan(table=[[public, web_returns]])
                    LogicalProject(exprs=[[$3, $13, $17]])
                      JdbcTableScan(table=[[public, web_sales]])
                LogicalFilter(condition=[AND(>=($2, 2000-08-19), <=($2, +(2000-08-19, 1209600000:INTERVAL DAY)))])
                  JdbcTableScan(table=[[public, date_dim]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[ASC], fetch=[100])
  LogicalAggregate(group=[{0, 1}], groups=[[{0, 1}, {0}, {}]], sales=[SUM($2)], returns=[SUM($3)], profit=[SUM($4)])
    LogicalUnion(all=[true])
      LogicalUnion(all=[true])
        LogicalProject(exprs=[['store channel', ||('store', $0), $1, $3, -($2, $4)]])
          LogicalAggregate(group=[{1}], sales=[SUM($30)], profit=[SUM($31)], returns=[SUM($32)], profit_loss=[SUM($33)])
            LogicalJoin(condition=[=($29, $0)], joinType=[inner])
              JdbcTableScan(table=[[public, store]])
              LogicalUnion(all=[true])
                LogicalProject(exprs=[[$7, $15, $22, 0:DECIMAL(7, 2), 0:DECIMAL(7, 2)]])
                  LogicalJoin(condition=[=($0, $23)], joinType=[inner])
                    JdbcTableScan(table=[[public, store_sales]])
                    LogicalAggregate(group=[{0}])
                      LogicalFilter(condition=[SEARCH($2, Sarg[[2000-08-19..2000-09-02]])])
                        JdbcTableScan(table=[[public, date_dim]])
                LogicalProject(exprs=[[$7, 0:DECIMAL(7, 2), 0:DECIMAL(7, 2), $11, $19]])
                  LogicalJoin(condition=[=($0, $20)], joinType=[inner])
                    JdbcTableScan(table=[[public, store_returns]])
                    LogicalAggregate(group=[{0}])
                      LogicalFilter(condition=[SEARCH($2, Sarg[[2000-08-19..2000-09-02]])])
                        JdbcTableScan(table=[[public, date_dim]])
        LogicalProject(exprs=[['catalog channel', ||('catalog_page', $0), $1, $3, -($2, $4)]])
          LogicalAggregate(group=[{6}], sales=[SUM($1)], profit=[SUM($2)], returns=[SUM($3)], profit_loss=[SUM($4)])
            LogicalJoin(condition=[=($0, $5)], joinType=[inner])
              LogicalUnion(all=[true])
                LogicalProject(exprs=[[$12, $23, $33, 0:DECIMAL(7, 2), 0:DECIMAL(7, 2)]])
                  LogicalJoin(condition=[=($0, $34)], joinType=[inner])
                    JdbcTableScan(table=[[public, catalog_sales]])
                    LogicalAggregate(group=[{0}])
                      LogicalFilter(condition=[SEARCH($2, Sarg[[2000-08-19..2000-09-02]])])
                        JdbcTableScan(table=[[public, date_dim]])
                LogicalProject(exprs=[[$12, 0:DECIMAL(7, 2), 0:DECIMAL(7, 2), $18, $26]])
                  LogicalJoin(condition=[=($0, $27)], joinType=[inner])
                    JdbcTableScan(table=[[public, catalog_returns]])
                    LogicalAggregate(group=[{0}])
                      LogicalFilter(condition=[SEARCH($2, Sarg[[2000-08-19..2000-09-02]])])
                        JdbcTableScan(table=[[public, date_dim]])
              JdbcTableScan(table=[[public, catalog_page]])
      LogicalProject(exprs=[['web channel', ||('web_site', $0), $1, $3, -($2, $4)]])
        LogicalAggregate(group=[{1}], sales=[SUM($27)], profit=[SUM($28)], returns=[SUM($29)], profit_loss=[SUM($30)])
          LogicalJoin(condition=[=($26, $0)], joinType=[inner])
            JdbcTableScan(table=[[public, web_site]])
            LogicalUnion(all=[true])
              LogicalProject(exprs=[[$13, $23, $33, 0:DECIMAL(7, 2), 0:DECIMAL(7, 2)]])
                LogicalJoin(condition=[=($0, $34)], joinType=[inner])
                  JdbcTableScan(table=[[public, web_sales]])
                  LogicalAggregate(group=[{0}])
                    LogicalFilter(condition=[SEARCH($2, Sarg[[2000-08-19..2000-09-02]])])
                      JdbcTableScan(table=[[public, date_dim]])
              LogicalProject(exprs=[[$5, 0:DECIMAL(7, 2), 0:DECIMAL(7, 2), $2, $3]])
                LogicalJoin(condition=[AND(=($0, $4), =($1, $6))], joinType=[left])
                  LogicalProject(exprs=[[$2, $13, $15, $23]])
                    LogicalJoin(condition=[=($0, $24)], joinType=[inner])
                      JdbcTableScan(table=[[public, web_returns]])
                      LogicalAggregate(group=[{0}])
                        LogicalFilter(condition=[SEARCH($2, Sarg[[2000-08-19..2000-09-02]])])
                          JdbcTableScan(table=[[public, date_dim]])
                  LogicalProject(exprs=[[$3, $13, $17]])
                    JdbcTableScan(table=[[public, web_sales]])


Equivalence with transformations: false
-----------------------------------------------------
Query ID: TPCDS_Q6
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule, SemiJoinRule.JoinToSemiJoinRule, FilterJoinRule.FilterIntoJoinRule, AggregateMergeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(<=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,TIMES($x,1.2:DECIMAL(2, 1)))&=($x,$x)){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(<=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)){Filter(<($x,TIMES($x,1.2:DECIMAL(2, 1))))->LogicalCorrelate[Scan(public.item)|Aggregate(groups=[], calls=[AVG(i_current_price)])->Filter(=($cor0.i_category,$x))->Scan(public.item)]|Filter(=($x,$x))->Join(LEFT,true){Scan(public.date_dim)|Aggregate(groups=[], calls=[SINGLE_VALUE(d_month_seq)])->Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)}|Scan(public.customer)|Scan(public.customer_address)|Scan(public.store_sales)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[ASC], dir1=[ASC], fetch=[100])
  LogicalFilter(condition=[>=($1, 10)])
    LogicalAggregate(group=[{8}], cnt=[COUNT()])
      LogicalJoin(condition=[=($13, $34)], joinType=[inner])
        LogicalJoin(condition=[=($0, $17)], joinType=[inner])
          JdbcTableScan(table=[[public, customer_address]])
          JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$53, $54, $55, $56, $57, $58, $59, $60, $61, $62, $63, $64, $65, $66, $67, $68, $69, $70, $71, $72, $73, $74, $75, $0, $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52]])
          LogicalJoin(condition=[AND(=($55, $28), =($53, $0))], joinType=[inner])
            LogicalProject(exprs=[[$25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40, $41, $42, $43, $44, $45, $46, $47, $48, $49, $50, $51, $52, $0, $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24]])
              LogicalJoin(condition=[=($28, $22)], joinType=[inner])
                LogicalProject(exprs=[[$3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $0, $1, $2]])
                  LogicalJoin(condition=[AND(=($15, $1), >($8, *(1.2:DECIMAL(2, 1), $2)))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalAggregate(group=[{3}])
                        LogicalFilter(condition=[AND(=($6, 2002), =($8, 3))])
                          JdbcTableScan(table=[[public, date_dim]])
                      LogicalAggregate(group=[{12}], avg_price=[AVG($5)])
                        JdbcTableScan(table=[[public, item]])
                    JdbcTableScan(table=[[public, item]])
                JdbcTableScan(table=[[public, date_dim]])
            JdbcTableScan(table=[[public, store_sales]])


Rel2: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[ASC], dir1=[ASC], fetch=[100])
  LogicalFilter(condition=[>=($1, 10)])
    LogicalAggregate(group=[{8}], cnt=[COUNT()])
      LogicalJoin(condition=[=($13, $34)], joinType=[inner])
        LogicalJoin(condition=[=($0, $17)], joinType=[inner])
          JdbcTableScan(table=[[public, customer_address]])
          JdbcTableScan(table=[[public, customer]])
        LogicalJoin(condition=[AND(=($2, $51), =($0, $23))], joinType=[inner])
          JdbcTableScan(table=[[public, store_sales]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalProject(inputs=[0..27])
              LogicalFilter(condition=[=($3, $28)])
                LogicalJoin(condition=[true], joinType=[left])
                  JdbcTableScan(table=[[public, date_dim]])
                  LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
                    LogicalAggregate(group=[{3}])
                      LogicalFilter(condition=[AND(=($6, 2002), =($8, 3))])
                        JdbcTableScan(table=[[public, date_dim]])
            LogicalProject(inputs=[0..21])
              LogicalFilter(condition=[>($5, *(1.2:DECIMAL(2, 1), $22))])
                LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{94}])
                  JdbcTableScan(table=[[public, item]])
                  LogicalAggregate(group=[{}], EXPR$0=[AVG($5)])
                    LogicalFilter(condition=[=($12, $cor0.i_category)])
                      JdbcTableScan(table=[[public, item]])


Equivalence with transformations: false
LLM Equivalence B->A 2: false
LLM Equivalence B->A (X): false
-----------------------------------------------------
Query ID: TPCDS_Q7
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q8
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q9
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence B->A (X): false
-----------------------------------------------------
Query ID: TPCDS_Q10
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q11
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q12
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q13
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q14
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q15
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q16
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q17
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q18
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q19
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q20
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q21
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q22
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q23
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q24
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence B->A (X): false
-----------------------------------------------------
Query ID: TPCDS_Q25
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q26
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q27
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q28
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q29
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q30
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q31
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q32
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q33
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q34
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q35
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q36
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q37
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q38
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q39
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q40
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q41
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence B->A (X): true
LLM Transformations 1 (A to X): [FilterCorrelateRule, SemiJoinRule.JoinToSemiJoinRule, SortJoinTransposeRule, ReduceExpressionsRule.FilterReduceExpressionsRule]
-----------------------------------------------------
Query ID: TPCDS_Q42
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q43
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q44
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[0:ASCENDING:LAST])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(<($x,11))->Project[$x,RANK()]->Filter(<($x,TIMES($x,0.9:DECIMAL(2, 1))))->Join(LEFT,true){Aggregate(groups=[ss_item_sk], calls=[AVG(ss_net_profit)])->Filter(=($x,4))->Scan(public.store_sales)|Aggregate(groups=[], calls=[SINGLE_VALUE(rank_col)])->Aggregate(groups=[ss_store_sk], calls=[AVG(ss_net_profit)])->Filter(AND(IS_NOT_NULL($x)&RANGE($x,4,4)))->Scan(public.store_sales)}|Filter(<($x,11))->Project[$x,RANK()]->Filter(<($x,TIMES($x,0.9:DECIMAL(2, 1))))->Join(LEFT,true){Aggregate(groups=[ss_item_sk], calls=[AVG(ss_net_profit)])->Filter(=($x,4))->Scan(public.store_sales)|Aggregate(groups=[], calls=[SINGLE_VALUE(rank_col)])->Aggregate(groups=[ss_store_sk], calls=[AVG(ss_net_profit)])->Filter(AND(IS_NOT_NULL($x)&RANGE($x,4,4)))->Scan(public.store_sales)}|Scan(public.item)|Scan(public.item)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[0:ASCENDING:LAST])->Project[$x,$x,$x]->Join(INNER,=($x,$x)){Filter(<($x,11))->Project[$x,RANK()]->Filter(<($x,TIMES($x,0.9:DECIMAL(2, 1))))->Join(LEFT,true){Aggregate(groups=[ss_item_sk], calls=[AVG(ss_net_profit)])->Filter(=($x,4))->Scan(public.store_sales)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr$0)])->Aggregate(groups=[ss_store_sk], calls=[AVG(ss_net_profit)])->Filter(AND(IS_NOT_NULL($x)&RANGE($x,4,4)))->Scan(public.store_sales)}|Project[$x,RANK()]->Filter(<($x,TIMES($x,0.9:DECIMAL(2, 1))))->Join(LEFT,true){Aggregate(groups=[ss_item_sk], calls=[AVG(ss_net_profit)])->Filter(=($x,4))->Scan(public.store_sales)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr$0)])->Aggregate(groups=[ss_store_sk], calls=[AVG(ss_net_profit)])->Filter(AND(IS_NOT_NULL($x)&RANGE($x,4,4)))->Scan(public.store_sales)}|Scan(public.item)|Scan(public.item)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC], fetch=[100])
  LogicalProject(exprs=[[$1, $25, $47]])
    LogicalJoin(condition=[=($26, $2)], joinType=[inner])
      LogicalJoin(condition=[=($4, $0)], joinType=[inner])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalFilter(condition=[<($1, 11)])
            LogicalProject(inputs=[0], exprs=[[RANK() OVER (ORDER BY $1)]])
              LogicalFilter(condition=[>($1, *(0.9:DECIMAL(2, 1), $2))])
                LogicalJoin(condition=[true], joinType=[left])
                  LogicalAggregate(group=[{2}], rank_col=[AVG($22)])
                    LogicalFilter(condition=[=($7, 4)])
                      JdbcTableScan(table=[[public, store_sales]])
                  LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($1)])
                    LogicalAggregate(group=[{7}], rank_col=[AVG($22)])
                      LogicalFilter(condition=[AND(=($7, 4), IS NOT NULL($5))])
                        JdbcTableScan(table=[[public, store_sales]])
          LogicalFilter(condition=[<($1, 11)])
            LogicalProject(inputs=[0], exprs=[[RANK() OVER (ORDER BY $1 DESC)]])
              LogicalFilter(condition=[>($1, *(0.9:DECIMAL(2, 1), $2))])
                LogicalJoin(condition=[true], joinType=[left])
                  LogicalAggregate(group=[{2}], rank_col=[AVG($22)])
                    LogicalFilter(condition=[=($7, 4)])
                      JdbcTableScan(table=[[public, store_sales]])
                  LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($1)])
                    LogicalAggregate(group=[{7}], rank_col=[AVG($22)])
                      LogicalFilter(condition=[AND(=($7, 4), IS NOT NULL($5))])
                        JdbcTableScan(table=[[public, store_sales]])
        JdbcTableScan(table=[[public, item]])
      JdbcTableScan(table=[[public, item]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC], fetch=[100])
  LogicalProject(exprs=[[$1, $25, $47]])
    LogicalJoin(condition=[=($26, $2)], joinType=[inner])
      LogicalJoin(condition=[=($4, $0)], joinType=[inner])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalFilter(condition=[<($1, 11)])
            LogicalProject(inputs=[0], exprs=[[RANK() OVER (ORDER BY $1)]])
              LogicalFilter(condition=[>($1, *(0.9:DECIMAL(2, 1), $2))])
                LogicalJoin(condition=[true], joinType=[left])
                  LogicalAggregate(group=[{2}], rank_col=[AVG($22)])
                    LogicalFilter(condition=[=($7, 4)])
                      JdbcTableScan(table=[[public, store_sales]])
                  LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($1)])
                    LogicalAggregate(group=[{7}], EXPR$0=[AVG($22)])
                      LogicalFilter(condition=[AND(=($7, 4), IS NOT NULL($5))])
                        JdbcTableScan(table=[[public, store_sales]])
          LogicalProject(inputs=[0], exprs=[[RANK() OVER (ORDER BY $1 DESC)]])
            LogicalFilter(condition=[>($1, *(0.9:DECIMAL(2, 1), $2))])
              LogicalJoin(condition=[true], joinType=[left])
                LogicalAggregate(group=[{2}], rank_col=[AVG($22)])
                  LogicalFilter(condition=[=($7, 4)])
                    JdbcTableScan(table=[[public, store_sales]])
                LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($1)])
                  LogicalAggregate(group=[{7}], EXPR$0=[AVG($22)])
                    LogicalFilter(condition=[AND(=($7, 4), IS NOT NULL($5))])
                      JdbcTableScan(table=[[public, store_sales]])
        JdbcTableScan(table=[[public, item]])
      JdbcTableScan(table=[[public, item]])


Equivalence with transformations: false
LLM Equivalence A->B 2: false
LLM Equivalence B->A 1: false
LLM Equivalence B->A (X): true
LLM Transformations 1 (A to X): [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule, SortJoinTransposeRule]
-----------------------------------------------------
Query ID: TPCDS_Q45
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: []
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: []
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: []
LLM Equivalence B->A (X): true
-----------------------------------------------------
Query ID: TPCDS_Q46
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence B->A (X): false
-----------------------------------------------------
Query ID: TPCDS_Q47
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence B->A (X): false
-----------------------------------------------------
Query ID: TPCDS_Q48
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q49
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q50
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q51
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q52
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q53
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q54
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q55
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q56
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q57
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q58
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q59
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q60
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q61
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q62
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q63
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence B->A (X): false
-----------------------------------------------------
Query ID: TPCDS_Q64
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q65
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q66
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q67
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q68
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q69
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence B->A (X): true
LLM Transformations 1 (A to X): [SemiJoinJoinTransposeRule, AggregateJoinTransposeRule, JoinAssociateRule, JoinToCorrelateRule, FilterCorrelateRule]
-----------------------------------------------------
Query ID: TPCDS_Q70
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q71
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q72
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q73
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q74
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q75
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q76
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q77
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q78
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q79
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q80
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q81
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q82
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q83
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q84
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q85
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q86
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q87
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q88
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q89
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence B->A (X): false
-----------------------------------------------------
Query ID: TPCDS_Q90
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q91
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q92
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q93
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence B->A (X): false
-----------------------------------------------------
Query ID: TPCDS_Q94
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q95
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q96
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [SortRemoveConstantKeysRule, SortRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[0:ASCENDING:LAST])->Aggregate(groups=[], calls=[COUNT(*)])->Join(INNER,=($x,$x)){Filter(=($x,'ese'))->Scan(public.store)|Filter(=($x,0))->Scan(public.household_demographics)|Filter(AND(<=($x,30)&RANGE($x,8,8)))->Scan(public.time_dim)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest Rel2: Aggregate(groups=[], calls=[COUNT(*)])->Join(INNER,=($x,$x)){Filter(=($x,'ese'))->Scan(public.store)|Filter(=($x,0))->Scan(public.household_demographics)|Filter(AND(<=($x,30)&RANGE($x,8,8)))->Scan(public.time_dim)|Scan(public.store_sales)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC], fetch=[100])
  LogicalAggregate(group=[{}], EXPR$0=[COUNT()])
    LogicalJoin(condition=[AND(=($7, $38), =($1, $28))], joinType=[inner])
      LogicalJoin(condition=[=($5, $23)], joinType=[inner])
        JdbcTableScan(table=[[public, store_sales]])
        LogicalFilter(condition=[=($3, 0)])
          JdbcTableScan(table=[[public, household_demographics]])
      LogicalJoin(condition=[true], joinType=[inner])
        LogicalFilter(condition=[AND(=($3, 8), >=($4, 30))])
          JdbcTableScan(table=[[public, time_dim]])
        LogicalFilter(condition=[=($5, 'ese')])
          JdbcTableScan(table=[[public, store]])


Rel2: 
LogicalAggregate(group=[{}], EXPR$0=[COUNT()])
  LogicalJoin(condition=[AND(=($7, $38), =($1, $28))], joinType=[inner])
    LogicalJoin(condition=[=($5, $23)], joinType=[inner])
      JdbcTableScan(table=[[public, store_sales]])
      LogicalFilter(condition=[=($3, 0)])
        JdbcTableScan(table=[[public, household_demographics]])
    LogicalJoin(condition=[true], joinType=[inner])
      LogicalFilter(condition=[AND(=($3, 8), >=($4, 30))])
        JdbcTableScan(table=[[public, time_dim]])
      LogicalFilter(condition=[=($5, 'ese')])
        JdbcTableScan(table=[[public, store]])


Equivalence with transformations: false
LLM Equivalence A->B 2: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: []
LLM Equivalence B->A 2: false
LLM Equivalence B->A (X): true
LLM Transformations 1 (A to X): [SortRemoveRule]
-----------------------------------------------------
Query ID: TPCDS_Q97
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q98
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q99
Equivalence without transformations: true
