-----------------------------------------------------
Query ID: TPCHN1
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN2
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN3
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN4
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN5
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN6
[Calcite.compareQueries] Planning error: Encountered "AND" at line 5, column 3.
Was expecting one of:
    "DAY" ...
    "DAYS" ...
    "HOUR" ...
    "HOURS" ...
    "MINUTE" ...
    "MINUTES" ...
    "MONTH" ...
    "MONTHS" ...
    "QUARTER" ...
    "QUARTERS" ...
    "SECOND" ...
    "SECONDS" ...
    "WEEK" ...
    "WEEKS" ...
    "YEAR" ...
    "YEARS" ...
    
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: []
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: []
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: []
LLM Equivalence A->X: true
LLM Transformations (A to X): []
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): []
[Calcite.compareQueries] Planning error: Encountered "AND" at line 5, column 3.
Was expecting one of:
    "DAY" ...
    "DAYS" ...
    "HOUR" ...
    "HOURS" ...
    "MINUTE" ...
    "MINUTES" ...
    "MONTH" ...
    "MONTHS" ...
    "QUARTER" ...
    "QUARTERS" ...
    "SECOND" ...
    "SECONDS" ...
    "WEEK" ...
    "WEEKS" ...
    "YEAR" ...
    "YEARS" ...
    
Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): []
[Calcite.compareQueries] Planning error: Encountered "AND" at line 5, column 3.
Was expecting one of:
    "DAY" ...
    "DAYS" ...
    "HOUR" ...
    "HOURS" ...
    "MINUTE" ...
    "MINUTES" ...
    "MONTH" ...
    "MONTHS" ...
    "QUARTER" ...
    "QUARTERS" ...
    "SECOND" ...
    "SECONDS" ...
    "WEEK" ...
    "WEEKS" ...
    "YEAR" ...
    "YEARS" ...
    
Equivalence: false
-----------------------------------------------------
Query ID: TPCHN7
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN8
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN9
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalAggregate(group=[{0, 4}], sum_profit=[SUM($2)])
    LogicalJoin(condition=[=($3, $1)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2, $4]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(exprs=[[$1, $2]])
            LogicalJoin(condition=[=($3, $0)], joinType=[inner])
              LogicalProject(inputs=[0..1])
                JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0], exprs=[[$2, -($4, *($7, $3))]])
            LogicalJoin(condition=[AND(=($8, $1), =($6, $2), =($5, $1))], joinType=[inner])
              LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalJoin(condition=[true], joinType=[inner])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[LIKE($1, 'co%')])
                    JdbcTableScan(table=[[public, part]])
      LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
        JdbcTableScan(table=[[public, orders]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalAggregate(group=[{0, 4}], sum_profit=[SUM($2)])
    LogicalJoin(condition=[=($3, $1)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2, $4]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(exprs=[[$1, $2]])
            LogicalJoin(condition=[=($3, $0)], joinType=[inner])
              LogicalProject(inputs=[0..1])
                JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0], exprs=[[$2, -($4, *($7, $3))]])
            LogicalJoin(condition=[AND(=($8, $1), =($6, $2), =($5, $1))], joinType=[inner])
              LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalJoin(condition=[true], joinType=[inner])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[LIKE($1, 'co%')])
                    JdbcTableScan(table=[[public, part]])
      LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
        JdbcTableScan(table=[[public, orders]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalAggregate(group=[{0, 4}], sum_profit=[SUM($2)])
    LogicalJoin(condition=[=($3, $1)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2, $4]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(exprs=[[$1, $2]])
            LogicalJoin(condition=[=($3, $0)], joinType=[inner])
              LogicalProject(inputs=[0..1])
                JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0], exprs=[[$2, -($4, *($7, $3))]])
            LogicalJoin(condition=[AND(=($8, $1), =($6, $2), =($5, $1))], joinType=[inner])
              LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalJoin(condition=[true], joinType=[inner])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[LIKE($1, 'co%')])
                    JdbcTableScan(table=[[public, part]])
      LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
        JdbcTableScan(table=[[public, orders]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalAggregate(group=[{0, 4}], sum_profit=[SUM($2)])
    LogicalJoin(condition=[=($3, $1)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2, $4]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(exprs=[[$1, $2]])
            LogicalJoin(condition=[=($3, $0)], joinType=[inner])
              LogicalProject(inputs=[0..1])
                JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(exprs=[[$14, $16, -(*($19, -(1, $20)), *($3, $18))]])
            LogicalJoin(condition=[AND(=($5, $15), =($1, $16), =($0, $15))], joinType=[inner])
              LogicalProject(exprs=[[$9, $10, $11, $12, $13, $0, $1, $2, $3, $4, $5, $6, $7, $8]])
                LogicalJoin(condition=[true], joinType=[inner])
                  LogicalFilter(condition=[LIKE($1, 'co%')])
                    JdbcTableScan(table=[[public, part]])
                  JdbcTableScan(table=[[public, partsupp]])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
        JdbcTableScan(table=[[public, orders]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinAssociateRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule, JoinPushTransitivePredicatesRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalAggregate(group=[{0, 4}], sum_profit=[SUM($2)])
    LogicalJoin(condition=[=($3, $1)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2, $4]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(exprs=[[$1, $2]])
            LogicalJoin(condition=[=($3, $0)], joinType=[inner])
              LogicalProject(inputs=[0..1])
                JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(exprs=[[$14, $16, -(*($19, -(1, $20)), *($3, $18))]])
            LogicalJoin(condition=[AND(=($5, $15), =($1, $16), =($0, $15))], joinType=[inner])
              LogicalProject(exprs=[[$9, $10, $11, $12, $13, $0, $1, $2, $3, $4, $5, $6, $7, $8]])
                LogicalJoin(condition=[true], joinType=[inner])
                  LogicalFilter(condition=[LIKE($1, 'co%')])
                    JdbcTableScan(table=[[public, part]])
                  JdbcTableScan(table=[[public, partsupp]])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
        JdbcTableScan(table=[[public, orders]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($3, $7), =($2, $6))], joinType=[inner])
                LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                  LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                      LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [JoinAssociateRule, JoinPushTransitivePredicatesRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalAggregate(group=[{0, 4}], sum_profit=[SUM($2)])
    LogicalJoin(condition=[=($3, $1)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2, $4]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(exprs=[[$1, $2]])
            LogicalJoin(condition=[=($3, $0)], joinType=[inner])
              LogicalProject(inputs=[0..1])
                JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0], exprs=[[$2, -($4, *($7, $3))]])
            LogicalJoin(condition=[AND(=($8, $1), =($6, $2), =($5, $1))], joinType=[inner])
              LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalJoin(condition=[true], joinType=[inner])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[LIKE($1, 'co%')])
                    JdbcTableScan(table=[[public, part]])
      LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
        JdbcTableScan(table=[[public, orders]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($3, $7), =($2, $6))], joinType=[inner])
                LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                  LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                      LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN10
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN11
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN12
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN13
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN14
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN15
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN16
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [SemiJoinRule, SemiJoinJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(inputs=[0..1])
        LogicalFilter(condition=[OR(=($5, 0), AND(IS NULL($8), >=($6, $5)))])
          LogicalJoin(condition=[=($1, $7)], joinType=[left])
            LogicalJoin(condition=[true], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$0]])
                LogicalAggregate(group=[{}], c=[COUNT()])
                  LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                    JdbcTableScan(table=[[public, supplier]])
            LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
              LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
        LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $10)])
    LogicalFilter(condition=[IS NULL($14)])
      LogicalJoin(condition=[=($10, $14)], joinType=[left])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
            JdbcTableScan(table=[[public, part]])
          JdbcTableScan(table=[[public, partsupp]])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
            JdbcTableScan(table=[[public, supplier]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [SemiJoinJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(inputs=[0..1])
        LogicalFilter(condition=[OR(=($5, 0), AND(IS NULL($8), >=($6, $5)))])
          LogicalJoin(condition=[=($1, $7)], joinType=[left])
            LogicalJoin(condition=[true], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$0]])
                LogicalAggregate(group=[{}], c=[COUNT()])
                  LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                    JdbcTableScan(table=[[public, supplier]])
            LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
              LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
        LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $10)])
    LogicalFilter(condition=[IS NULL($14)])
      LogicalJoin(condition=[=($10, $14)], joinType=[left])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
            JdbcTableScan(table=[[public, part]])
          JdbcTableScan(table=[[public, partsupp]])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
            JdbcTableScan(table=[[public, supplier]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [SemiJoinJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $10)])
    LogicalFilter(condition=[IS NULL($14)])
      LogicalJoin(condition=[=($10, $14)], joinType=[left])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
            JdbcTableScan(table=[[public, part]])
          JdbcTableScan(table=[[public, partsupp]])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
            JdbcTableScan(table=[[public, supplier]])


Rel2: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(inputs=[0..1])
        LogicalFilter(condition=[OR(=($5, 0), AND(IS NULL($8), >=($6, $5)))])
          LogicalJoin(condition=[=($1, $7)], joinType=[left])
            LogicalJoin(condition=[true], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$0]])
                LogicalAggregate(group=[{}], c=[COUNT()])
                  LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                    JdbcTableScan(table=[[public, supplier]])
            LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
              LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
        LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [SemiJoinJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $10)])
    LogicalFilter(condition=[IS NULL($14)])
      LogicalJoin(condition=[=($10, $14)], joinType=[left])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
            JdbcTableScan(table=[[public, part]])
          JdbcTableScan(table=[[public, partsupp]])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
            JdbcTableScan(table=[[public, supplier]])


Rel2: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(inputs=[0..1])
        LogicalFilter(condition=[OR(=($5, 0), AND(IS NULL($8), >=($6, $5)))])
          LogicalJoin(condition=[=($1, $7)], joinType=[left])
            LogicalJoin(condition=[true], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$0]])
                LogicalAggregate(group=[{}], c=[COUNT()])
                  LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                    JdbcTableScan(table=[[public, supplier]])
            LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
              LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
        LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [SemiJoinJoinTransposeRule]
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN17
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinPushTransitivePredicatesRule, FilterJoinRule.FilterIntoJoinRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalFilter(condition=[<($4, $16)])
          LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{16}])
            JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
              LogicalProject(exprs=[[*(0.7:DECIMAL(2, 1), $0)]])
                LogicalAggregate(group=[{}], agg#0=[AVG($4)])
                  LogicalFilter(condition=[=($1, $cor0.p_partkey)])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalJoin(condition=[AND(=($1, $16), <($4, $19))], joinType=[inner])
          JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0], exprs=[[CAST($0):INTEGER, CAST($1):DECIMAL(15, 2), *(0.7:DECIMAL(2, 1), $1)]])
            LogicalAggregate(group=[{1}], agg#0=[AVG($4)])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [JoinPushTransitivePredicatesRule, JoinExtractFilterRule, FilterJoinRule.FilterIntoJoinRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalFilter(condition=[<($4, $16)])
          LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{16}])
            JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
              LogicalProject(exprs=[[*(0.7:DECIMAL(2, 1), $0)]])
                LogicalAggregate(group=[{}], agg#0=[AVG($4)])
                  LogicalFilter(condition=[=($1, $cor0.p_partkey)])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalJoin(condition=[AND(=($1, $16), <($4, $19))], joinType=[inner])
          JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0], exprs=[[CAST($0):INTEGER, CAST($1):DECIMAL(15, 2), *(0.7:DECIMAL(2, 1), $1)]])
            LogicalAggregate(group=[{1}], agg#0=[AVG($4)])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinPushTransitivePredicatesRule, FilterJoinRule.FilterIntoJoinRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Error obtaining query plans: ERROR: syntax error at or near "null"
  Position: 32
Exception in thread "main" java.lang.NullPointerException: Cannot invoke "com.ac.iisc.LLMResponse.areQueriesEquivalent()" because "llmResponse" is null
	at com.ac.iisc.Test.main(Test.java:201)
-----------------------------------------------------
Query ID: TPCHN18
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN19
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN20
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [SemiJoinRule.JoinToSemiJoinRule, JoinToMultiJoinRule, MultiJoinOptimizeBushyRule, SemiJoinRule.JoinToSemiJoinRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(exprs=[[$1, $2]])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(exprs=[[$4, $5, $6]])
        LogicalJoin(condition=[=($7, $0)], joinType=[inner])
          LogicalFilter(condition=[=($1, 'FRANCE                   ')])
            JdbcTableScan(table=[[public, nation]])
          JdbcTableScan(table=[[public, supplier]])
      LogicalProject(exprs=[[$10]])
        LogicalJoin(condition=[=($9, $0)], joinType=[inner])
          LogicalFilter(condition=[LIKE($1, '%ivory%')])
            JdbcTableScan(table=[[public, part]])
          LogicalProject(inputs=[0..4])
            LogicalFilter(condition=[>($2, $5)])
              LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{11, 12}])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
                  LogicalProject(exprs=[[*(0.5:DECIMAL(2, 1), $0)]])
                    LogicalAggregate(group=[{}], agg#0=[SUM($4)])
                      LogicalFilter(condition=[AND(=($1, $cor0.ps_partkey), =($2, $cor0.ps_suppkey), SEARCH($10, Sarg[[1995-01-01..1996-01-01)]))])
                        JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[LIKE($1, '%ivory%')])
                    JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [SemiJoinRule.ProjectToSemiJoinRule, SemiJoinRule.ProjectToSemiJoinRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')&>($x,$x)&LIKE($x,'%ivory%')){LogicalCorrelate[Scan(public.partsupp)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_quantity)])->Filter(AND(=($x,$x)&RANGE($x,1995-01-01,1996-01-01)))->Scan(public.lineitem)]|Scan(public.nation)|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(exprs=[[$1, $2]])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0..2])
        LogicalJoin(condition=[=($3, $4)], joinType=[inner])
          LogicalProject(inputs=[0..3])
            JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[=($1, 'FRANCE                   ')])
              JdbcTableScan(table=[[public, nation]])
      LogicalProject(exprs=[[$1]])
        LogicalJoin(condition=[=($0, $2)], joinType=[inner])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[>($2, $5)])
              LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{11, 12}])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
                  LogicalProject(exprs=[[*(0.5:DECIMAL(2, 1), $0)]])
                    LogicalAggregate(group=[{}], agg#0=[SUM($4)])
                      LogicalFilter(condition=[AND(=($1, $cor0.ps_partkey), =($2, $cor0.ps_suppkey), SEARCH($10, Sarg[[1995-01-01..1996-01-01)]))])
                        JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[LIKE($1, '%ivory%')])
              JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[LIKE($1, '%ivory%')])
                    JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN21
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN22
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: []
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: []
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: []
LLM Equivalence A->X: true
LLM Transformations (A to X): []
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN23
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN24
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN25
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN26
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN27
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN28
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [CoerceInputsRule, ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(>=($10, 1993-01-01), <($10, +(1994-03-01, 12:INTERVAL YEAR)), >=($6, -(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <=($6, +(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(SEARCH($10, Sarg[[1993-01-01..1995-03-01)]), SEARCH($6, Sarg[[0.05:DECIMAL(3, 2)..0.07:DECIMAL(3, 2)]]:DECIMAL(3, 2)), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
-----------------------------------------------------
Query ID: TPCHN29
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN30
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN31
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(exprs=[[$1, $4, $2]])
          LogicalJoin(condition=[=($3, $0)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$4, $2]])
              LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                LogicalProject(exprs=[[$3, $5, -($7, *($2, $6))]])
                  LogicalJoin(condition=[AND(=($4, $0), =($5, $1))], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$2, $3]])
                      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[LIKE($1, 'co%')])
                            JdbcTableScan(table=[[public, part]])
                        LogicalProject(inputs=[0..1], exprs=[[$3]])
                          JdbcTableScan(table=[[public, partsupp]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: []
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(exprs=[[$1, $4, $2]])
          LogicalJoin(condition=[=($3, $0)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$4, $2]])
              LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                LogicalProject(exprs=[[$3, $5, -($7, *($2, $6))]])
                  LogicalJoin(condition=[AND(=($4, $0), =($5, $1))], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$2, $3]])
                      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[LIKE($1, 'co%')])
                            JdbcTableScan(table=[[public, part]])
                        LogicalProject(inputs=[0..1], exprs=[[$3]])
                          JdbcTableScan(table=[[public, partsupp]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: []
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): []
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(exprs=[[$1, $4, $2]])
          LogicalJoin(condition=[=($3, $0)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$4, $2]])
              LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                LogicalProject(exprs=[[$3, $5, -($7, *($2, $6))]])
                  LogicalJoin(condition=[AND(=($4, $0), =($5, $1))], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$2, $3]])
                      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[LIKE($1, 'co%')])
                            JdbcTableScan(table=[[public, part]])
                        LogicalProject(inputs=[0..1], exprs=[[$3]])
                          JdbcTableScan(table=[[public, partsupp]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($3, $7), =($2, $6))], joinType=[inner])
                LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                  LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                      LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [ReduceExpressionsRule.JoinReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(exprs=[[$1, $4, $2]])
          LogicalJoin(condition=[=($3, $0)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$4, $2]])
              LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                LogicalProject(exprs=[[$3, $5, -($7, *($2, $6))]])
                  LogicalJoin(condition=[AND(=($4, $0), =($5, $1))], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$2, $3]])
                      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[LIKE($1, 'co%')])
                            JdbcTableScan(table=[[public, part]])
                        LogicalProject(inputs=[0..1], exprs=[[$3]])
                          JdbcTableScan(table=[[public, partsupp]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($3, $7), =($2, $6))], joinType=[inner])
                LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                  LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                      LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN32
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN33
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN34
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN35
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN36
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN37
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [FilterAggregateTransposeRule, SortJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..3], exprs=[[$5]])
    LogicalJoin(condition=[=($0, $4)], joinType=[inner])
      LogicalProject(inputs=[0..2], exprs=[[$4]])
        JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0..1])
        LogicalJoin(condition=[=($1, $2)], joinType=[inner])
          LogicalAggregate(group=[{0}], EXPR$1=[SUM($1)])
            LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
              LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 3:INTERVAL MONTH)))])
                JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{}], EXPR$0=[MAX($1)])
            LogicalAggregate(group=[{0}], EXPR$1=[SUM($1)])
              LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
                LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 3:INTERVAL MONTH)))])
                  JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..3], exprs=[[$5]])
    LogicalJoin(condition=[=($0, $4)], joinType=[inner])
      LogicalProject(inputs=[0..2], exprs=[[$4]])
        JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0..1])
        LogicalJoin(condition=[=($1, $2)], joinType=[inner])
          LogicalAggregate(group=[{0}], total_revenue=[SUM($1)])
            LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
              LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1995-04-01)])])
                JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{}], EXPR$0=[MAX($1)])
            LogicalAggregate(group=[{0}], total_revenue=[SUM($1)])
              LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
                LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1995-04-01)])])
                  JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [SortJoinTransposeRule, SortJoinCopyRule, SortRemoveRedundantRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..3], exprs=[[$5]])
    LogicalJoin(condition=[=($0, $4)], joinType=[inner])
      LogicalProject(inputs=[0..2], exprs=[[$4]])
        JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0..1])
        LogicalJoin(condition=[=($1, $2)], joinType=[inner])
          LogicalAggregate(group=[{0}], EXPR$1=[SUM($1)])
            LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
              LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 3:INTERVAL MONTH)))])
                JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{}], EXPR$0=[MAX($1)])
            LogicalAggregate(group=[{0}], EXPR$1=[SUM($1)])
              LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
                LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 3:INTERVAL MONTH)))])
                  JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..3], exprs=[[$5]])
    LogicalJoin(condition=[=($0, $4)], joinType=[inner])
      LogicalProject(inputs=[0..2], exprs=[[$4]])
        JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0..1])
        LogicalJoin(condition=[=($1, $2)], joinType=[inner])
          LogicalAggregate(group=[{0}], total_revenue=[SUM($1)])
            LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
              LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1995-04-01)])])
                JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{}], EXPR$0=[MAX($1)])
            LogicalAggregate(group=[{0}], total_revenue=[SUM($1)])
              LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
                LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1995-04-01)])])
                  JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [SortJoinCopyRule, SortRemoveRedundantRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(total_revenue)])->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..3], exprs=[[$5]])
    LogicalJoin(condition=[=($0, $4)], joinType=[inner])
      LogicalProject(inputs=[0..2], exprs=[[$4]])
        JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0..1])
        LogicalJoin(condition=[=($1, $2)], joinType=[inner])
          LogicalAggregate(group=[{0}], total_revenue=[SUM($1)])
            LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
              LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1995-04-01)])])
                JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{}], EXPR$0=[MAX($1)])
            LogicalAggregate(group=[{0}], total_revenue=[SUM($1)])
              LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
                LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1995-04-01)])])
                  JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..3], exprs=[[$5]])
    LogicalJoin(condition=[=($0, $4)], joinType=[inner])
      LogicalProject(inputs=[0..2], exprs=[[$4]])
        JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0..1])
        LogicalJoin(condition=[=($1, $2)], joinType=[inner])
          LogicalAggregate(group=[{0}], EXPR$1=[SUM($1)])
            LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
              LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 3:INTERVAL MONTH)))])
                JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{}], EXPR$0=[MAX($1)])
            LogicalAggregate(group=[{0}], EXPR$1=[SUM($1)])
              LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
                LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 3:INTERVAL MONTH)))])
                  JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence B->A 2: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [SortJoinTransposeRule]
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN38
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [FilterJoinRule.FilterIntoJoinRule, SemiJoinJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(inputs=[0..1])
        LogicalFilter(condition=[OR(=($5, 0), AND(IS NULL($8), >=($6, $5)))])
          LogicalJoin(condition=[=($1, $7)], joinType=[left])
            LogicalJoin(condition=[true], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$0]])
                LogicalAggregate(group=[{}], c=[COUNT()])
                  LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                    JdbcTableScan(table=[[public, supplier]])
            LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
              LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
        LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $10)])
    LogicalFilter(condition=[IS NULL($14)])
      LogicalJoin(condition=[=($10, $14)], joinType=[left])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
            JdbcTableScan(table=[[public, part]])
          JdbcTableScan(table=[[public, partsupp]])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
            JdbcTableScan(table=[[public, supplier]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [SemiJoinJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(inputs=[0..1])
        LogicalFilter(condition=[OR(=($5, 0), AND(IS NULL($8), >=($6, $5)))])
          LogicalJoin(condition=[=($1, $7)], joinType=[left])
            LogicalJoin(condition=[true], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$0]])
                LogicalAggregate(group=[{}], c=[COUNT()])
                  LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                    JdbcTableScan(table=[[public, supplier]])
            LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
              LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
        LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $10)])
    LogicalFilter(condition=[IS NULL($14)])
      LogicalJoin(condition=[=($10, $14)], joinType=[left])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
            JdbcTableScan(table=[[public, part]])
          JdbcTableScan(table=[[public, partsupp]])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
            JdbcTableScan(table=[[public, supplier]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [SemiJoinJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Project[$x*]->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $10)])
    LogicalFilter(condition=[IS NULL($14)])
      LogicalJoin(condition=[=($10, $14)], joinType=[left])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
            JdbcTableScan(table=[[public, part]])
          JdbcTableScan(table=[[public, partsupp]])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
            JdbcTableScan(table=[[public, supplier]])


Rel2: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(inputs=[0..1])
        LogicalFilter(condition=[OR(=($5, 0), AND(IS NULL($8), >=($6, $5)))])
          LogicalJoin(condition=[=($1, $7)], joinType=[left])
            LogicalJoin(condition=[true], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$0]])
                LogicalAggregate(group=[{}], c=[COUNT()])
                  LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                    JdbcTableScan(table=[[public, supplier]])
            LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
              LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
        LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence B->A 2: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [SemiJoinJoinTransposeRule]
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN39
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinPushTransitivePredicatesRule, FilterJoinRule.JoinConditionPushRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalFilter(condition=[<($4, $16)])
          LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{16}])
            JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
              LogicalProject(exprs=[[*(0.7:DECIMAL(2, 1), $0)]])
                LogicalAggregate(group=[{}], agg#0=[AVG($4)])
                  LogicalFilter(condition=[=($1, $cor0.p_partkey)])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalJoin(condition=[AND(=($1, $16), <($4, $19))], joinType=[inner])
          JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0], exprs=[[CAST($0):INTEGER, CAST($1):DECIMAL(15, 2), *(0.7:DECIMAL(2, 1), $1)]])
            LogicalAggregate(group=[{1}], agg#0=[AVG($4)])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence A->B 2: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [JoinPushTransitivePredicatesRule, FilterJoinRule.FilterIntoJoinRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalJoin(condition=[AND(=($1, $16), <($4, $19))], joinType=[inner])
          JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0], exprs=[[CAST($0):INTEGER, CAST($1):DECIMAL(15, 2), *(0.7:DECIMAL(2, 1), $1)]])
            LogicalAggregate(group=[{1}], agg#0=[AVG($4)])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalFilter(condition=[<($4, $16)])
          LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{16}])
            JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
              LogicalProject(exprs=[[*(0.7:DECIMAL(2, 1), $0)]])
                LogicalAggregate(group=[{}], agg#0=[AVG($4)])
                  LogicalFilter(condition=[=($1, $cor0.p_partkey)])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence B->A 2: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinPushTransitivePredicatesRule, FilterJoinRule.FilterIntoJoinRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Error obtaining query plans: ERROR: syntax error at or near "null"
  Position: 32
Exception in thread "main" java.lang.NullPointerException: Cannot invoke "com.ac.iisc.LLMResponse.areQueriesEquivalent()" because "llmResponse" is null
	at com.ac.iisc.Test.main(Test.java:200)
-----------------------------------------------------
Query ID: TPCHN40
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN41
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN42
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [CoerceInputsRule, ReduceExpressionsRule.FilterReduceExpressionsRule, SemiJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[LIKE($1, '%ivory%')])
                    JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalAggregate(group=[{1}])
            LogicalFilter(condition=[AND(LIKE($6, '%ivory%'), >($2, $14))])
              LogicalProject(inputs=[0..13], exprs=[[$16]])
                LogicalJoin(condition=[AND(=($0, $14), =($1, $15))], joinType=[left])
                  LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                    JdbcTableScan(table=[[public, partsupp]])
                    JdbcTableScan(table=[[public, part]])
                  LogicalProject(inputs=[0..1], exprs=[[*(0.5:DECIMAL(2, 1), $2)]])
                    LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                      LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-01-01)])])
                        JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [SemiJoinRule.JoinOnUniqueToSemiJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalAggregate(group=[{1}])
            LogicalFilter(condition=[AND(LIKE($6, '%ivory%'), >($2, $14))])
              LogicalProject(inputs=[0..13], exprs=[[$16]])
                LogicalJoin(condition=[AND(=($0, $14), =($1, $15))], joinType=[left])
                  LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                    JdbcTableScan(table=[[public, partsupp]])
                    JdbcTableScan(table=[[public, part]])
                  LogicalProject(inputs=[0..1], exprs=[[*(0.5:DECIMAL(2, 1), $2)]])
                    LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                      LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-01-01)])])
                        JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[LIKE($1, '%ivory%')])
                    JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [SemiJoinRule.JoinToSemiJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)){Scan(public.part)|Scan(public.partsupp)}|Project[$x,$x,TIMES($x,0.5:DECIMAL(2, 1))]->Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)}|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalAggregate(group=[{1}])
            LogicalFilter(condition=[AND(LIKE($6, '%ivory%'), >($2, $14))])
              LogicalProject(inputs=[0..13], exprs=[[$16]])
                LogicalJoin(condition=[AND(=($0, $14), =($1, $15))], joinType=[left])
                  LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                    JdbcTableScan(table=[[public, partsupp]])
                    JdbcTableScan(table=[[public, part]])
                  LogicalProject(inputs=[0..1], exprs=[[*(0.5:DECIMAL(2, 1), $2)]])
                    LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                      LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-01-01)])])
                        JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[LIKE($1, '%ivory%')])
                    JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): []
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN43
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN44
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: []
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: []
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: []
LLM Equivalence A->X: true
LLM Transformations (A to X): []
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN45
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN46
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN47
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN48
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN49
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN50
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [CoerceInputsRule, ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(>=($10, 1993-01-01), <($10, +(1994-03-01, 12:INTERVAL YEAR)), >=($6, -(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <=($6, +(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(SEARCH($10, Sarg[[1993-01-01..1995-03-01)]), SEARCH($6, Sarg[[0.05:DECIMAL(3, 2)..0.07:DECIMAL(3, 2)]]:DECIMAL(3, 2)), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [CoerceInputsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(SEARCH($10, Sarg[[1993-01-01..1995-03-01)]), SEARCH($6, Sarg[[0.05:DECIMAL(3, 2)..0.07:DECIMAL(3, 2)]]:DECIMAL(3, 2)), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(>=($10, 1993-01-01), <($10, +(1994-03-01, 12:INTERVAL YEAR)), >=($6, -(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <=($6, +(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: []
LLM Equivalence A->X: true
LLM Transformations (A to X): []
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): []
[Calcite.compareQueries] canonicalDigest Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(SEARCH($10, Sarg[[1993-01-01..1995-03-01)]), SEARCH($6, Sarg[[0.05:DECIMAL(3, 2)..0.07:DECIMAL(3, 2)]]:DECIMAL(3, 2)), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(>=($10, 1993-01-01), <($10, +(1994-03-01, 12:INTERVAL YEAR)), >=($6, -(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <=($6, +(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [CoerceInputsRule, ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,0.05:DECIMAL(3, 2),0.07:DECIMAL(3, 2)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(SEARCH($10, Sarg[[1993-01-01..1995-03-01)]), SEARCH($6, Sarg[[0.05:DECIMAL(3, 2)..0.07:DECIMAL(3, 2)]]:DECIMAL(3, 2)), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(>=($10, 1993-01-01), <($10, +(1994-03-01, 12:INTERVAL YEAR)), >=($6, -(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <=($6, +(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN51
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN52
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinToMultiJoinRule, ProjectMultiJoinMergeRule, MultiJoinOptimizeBushyRule]
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN53
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalAggregate(group=[{0, 4}], sum_profit=[SUM($2)])
    LogicalJoin(condition=[=($3, $1)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2, $4]])
        LogicalJoin(condition=[=($3, $1)], joinType=[inner])
          LogicalProject(exprs=[[$1, $2]])
            LogicalJoin(condition=[=($3, $0)], joinType=[inner])
              LogicalProject(inputs=[0..1])
                JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0], exprs=[[$2, -($4, *($7, $3))]])
            LogicalJoin(condition=[AND(=($8, $1), =($6, $2), =($5, $1))], joinType=[inner])
              LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalJoin(condition=[true], joinType=[inner])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[LIKE($1, 'co%')])
                    JdbcTableScan(table=[[public, part]])
      LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
        JdbcTableScan(table=[[public, orders]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalAggregate(group=[{0, 4}], sum_profit=[SUM($2)])
    LogicalJoin(condition=[=($3, $1)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2, $4]])
        LogicalJoin(condition=[=($3, $1)], joinType=[inner])
          LogicalProject(exprs=[[$1, $2]])
            LogicalJoin(condition=[=($3, $0)], joinType=[inner])
              LogicalProject(inputs=[0..1])
                JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0], exprs=[[$2, -($4, *($7, $3))]])
            LogicalJoin(condition=[AND(=($8, $1), =($6, $2), =($5, $1))], joinType=[inner])
              LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalJoin(condition=[true], joinType=[inner])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[LIKE($1, 'co%')])
                    JdbcTableScan(table=[[public, part]])
      LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
        JdbcTableScan(table=[[public, orders]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalAggregate(group=[{0, 4}], sum_profit=[SUM($2)])
    LogicalJoin(condition=[=($3, $1)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2, $4]])
        LogicalJoin(condition=[=($3, $1)], joinType=[inner])
          LogicalProject(exprs=[[$1, $2]])
            LogicalJoin(condition=[=($3, $0)], joinType=[inner])
              LogicalProject(inputs=[0..1])
                JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0], exprs=[[$2, -($4, *($7, $3))]])
            LogicalJoin(condition=[AND(=($8, $1), =($6, $2), =($5, $1))], joinType=[inner])
              LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalJoin(condition=[true], joinType=[inner])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[LIKE($1, 'co%')])
                    JdbcTableScan(table=[[public, part]])
      LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
        JdbcTableScan(table=[[public, orders]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalAggregate(group=[{0, 4}], sum_profit=[SUM($2)])
    LogicalJoin(condition=[=($3, $1)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2, $4]])
        LogicalJoin(condition=[=($3, $1)], joinType=[inner])
          LogicalProject(exprs=[[$1, $2]])
            LogicalJoin(condition=[=($3, $0)], joinType=[inner])
              LogicalProject(inputs=[0..1])
                JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0], exprs=[[$2, -($4, *($7, $3))]])
            LogicalJoin(condition=[AND(=($8, $1), =($6, $2), =($5, $1))], joinType=[inner])
              LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalJoin(condition=[true], joinType=[inner])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[LIKE($1, 'co%')])
                    JdbcTableScan(table=[[public, part]])
      LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
        JdbcTableScan(table=[[public, orders]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinAssociateRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalAggregate(group=[{0, 4}], sum_profit=[SUM($2)])
    LogicalJoin(condition=[=($3, $1)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2, $4]])
        LogicalJoin(condition=[=($3, $1)], joinType=[inner])
          LogicalProject(exprs=[[$1, $2]])
            LogicalJoin(condition=[=($3, $0)], joinType=[inner])
              LogicalProject(inputs=[0..1])
                JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0], exprs=[[$2, -($4, *($7, $3))]])
            LogicalJoin(condition=[AND(=($8, $1), =($6, $2), =($5, $1))], joinType=[inner])
              LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalJoin(condition=[true], joinType=[inner])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[LIKE($1, 'co%')])
                    JdbcTableScan(table=[[public, part]])
      LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
        JdbcTableScan(table=[[public, orders]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($3, $7), =($2, $6))], joinType=[inner])
                LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                  LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                      LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS(TIMES($x,MINUS(1,$x)),TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalAggregate(group=[{0, 4}], sum_profit=[SUM($2)])
    LogicalJoin(condition=[=($3, $1)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2, $4]])
        LogicalJoin(condition=[=($3, $1)], joinType=[inner])
          LogicalProject(exprs=[[$1, $2]])
            LogicalJoin(condition=[=($3, $0)], joinType=[inner])
              LogicalProject(inputs=[0..1])
                JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(exprs=[[$14, $16, -(*($19, -(1, $20)), *($3, $18))]])
            LogicalJoin(condition=[AND(=($5, $15), =($1, $16), =($0, $15))], joinType=[inner])
              LogicalProject(exprs=[[$9, $10, $11, $12, $13, $0, $1, $2, $3, $4, $5, $6, $7, $8]])
                LogicalJoin(condition=[true], joinType=[inner])
                  LogicalFilter(condition=[LIKE($1, 'co%')])
                    JdbcTableScan(table=[[public, part]])
                  JdbcTableScan(table=[[public, partsupp]])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
        JdbcTableScan(table=[[public, orders]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($3, $7), =($2, $6))], joinType=[inner])
                LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                  LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                      LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN54
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN55
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN56
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN57
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN58
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/(*(100.00:DECIMAL(5, 2), $0), $1)]])
  LogicalAggregate(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
    LogicalProject(exprs=[[CASE($3, $1, 0:DECIMAL(19, 4)), $1]])
      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, *($5, -(1, $6))]])
          LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 1:INTERVAL MONTH)))])
            JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0], exprs=[[LIKE($4, 'PROMO%')]])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/(*(100.00:DECIMAL(5, 2), $0), $1)]])
  LogicalAggregate(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
    LogicalProject(exprs=[[CASE($3, $1, 0:DECIMAL(19, 4)), $1]])
      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, *($5, -(1, $6))]])
          LogicalFilter(condition=[AND(>=($10, 1995-01-01), <=($10, -(+(1995-01-01, 1:INTERVAL MONTH), 86400000:INTERVAL DAY)))])
            JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0], exprs=[[LIKE($4, 'PROMO%')]])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence A->B 2: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: []
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(extended_price_discount)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,MINUS(1995-02-01,86400000:INTERVAL DAY)))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/(*(100.00:DECIMAL(5, 2), $0), $1)]])
  LogicalAggregate(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
    LogicalProject(exprs=[[CASE($3, $1, 0:DECIMAL(19, 4)), $1]])
      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, *($5, -(1, $6))]])
          LogicalFilter(condition=[AND(>=($10, 1995-01-01), <=($10, -(+(1995-01-01, 1:INTERVAL MONTH), 86400000:INTERVAL DAY)))])
            JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0], exprs=[[LIKE($4, 'PROMO%')]])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/(*(100.00:DECIMAL(5, 2), $0), $1)]])
  LogicalAggregate(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
    LogicalProject(exprs=[[CASE($3, $1, 0:DECIMAL(19, 4)), $1]])
      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, *($5, -(1, $6))]])
          LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 1:INTERVAL MONTH)))])
            JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0], exprs=[[LIKE($4, 'PROMO%')]])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): []
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN59
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN60
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [SemiJoinJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(inputs=[0..1])
        LogicalFilter(condition=[OR(=($5, 0), AND(IS NULL($8), >=($6, $5)))])
          LogicalJoin(condition=[=($1, $7)], joinType=[left])
            LogicalJoin(condition=[true], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$0]])
                LogicalAggregate(group=[{}], c=[COUNT()])
                  LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                    JdbcTableScan(table=[[public, supplier]])
            LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
              LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
        LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $10)])
    LogicalFilter(condition=[IS NULL($14)])
      LogicalJoin(condition=[=($10, $14)], joinType=[left])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
            JdbcTableScan(table=[[public, part]])
          JdbcTableScan(table=[[public, partsupp]])
        LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
          JdbcTableScan(table=[[public, supplier]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [SemiJoinRule.ProjectToSemiJoinRule, SemiJoinJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(inputs=[0..1])
        LogicalFilter(condition=[OR(=($5, 0), AND(IS NULL($8), >=($6, $5)))])
          LogicalJoin(condition=[=($1, $7)], joinType=[left])
            LogicalJoin(condition=[true], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$0]])
                LogicalAggregate(group=[{}], c=[COUNT()])
                  LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                    JdbcTableScan(table=[[public, supplier]])
            LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
              LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
        LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $10)])
    LogicalFilter(condition=[IS NULL($14)])
      LogicalJoin(condition=[=($10, $14)], joinType=[left])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
            JdbcTableScan(table=[[public, part]])
          JdbcTableScan(table=[[public, partsupp]])
        LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
          JdbcTableScan(table=[[public, supplier]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [SemiJoinJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $10)])
    LogicalFilter(condition=[IS NULL($14)])
      LogicalJoin(condition=[=($10, $14)], joinType=[left])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
            JdbcTableScan(table=[[public, part]])
          JdbcTableScan(table=[[public, partsupp]])
        LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
          JdbcTableScan(table=[[public, supplier]])


Rel2: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(inputs=[0..1])
        LogicalFilter(condition=[OR(=($5, 0), AND(IS NULL($8), >=($6, $5)))])
          LogicalJoin(condition=[=($1, $7)], joinType=[left])
            LogicalJoin(condition=[true], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$0]])
                LogicalAggregate(group=[{}], c=[COUNT()])
                  LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                    JdbcTableScan(table=[[public, supplier]])
            LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
              LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
        LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence B->A 2: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [SemiJoinJoinTransposeRule]
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN61
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [JoinToCorrelateRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($2)])
    LogicalJoin(condition=[AND(=($0, $3), =($1, $4))], joinType=[inner])
      LogicalProject(inputs=[0..2])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(exprs=[[$1, $4, $5]])
            JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
              JdbcTableScan(table=[[public, part]])
      LogicalProject(exprs=[[$2, $3]])
        LogicalJoin(condition=[AND(=($0, $2), <($3, $1))], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[*(0.7:DECIMAL(2, 1), $1)]])
            LogicalAggregate(group=[{1}], agg#0=[AVG($4)])
              JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{0, 1}])
            LogicalJoin(condition=[=($0, $2)], joinType=[inner])
              LogicalProject(exprs=[[$1, $4]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
                  JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalFilter(condition=[<($4, $16)])
          LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{16}])
            JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
              LogicalProject(exprs=[[*(0.7:DECIMAL(2, 1), $0)]])
                LogicalAggregate(group=[{}], agg#0=[AVG($4)])
                  LogicalFilter(condition=[=($1, $cor0.p_partkey)])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence B->A 2: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [FilterCorrelateRule, JoinAssociateRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Error obtaining query plans: ERROR: syntax error at or near "null"
  Position: 32
Exception in thread "main" java.lang.NullPointerException: Cannot invoke "com.ac.iisc.LLMResponse.areQueriesEquivalent()" because "llmResponse" is null
	at com.ac.iisc.Test.main(Test.java:199)
-----------------------------------------------------
Query ID: TPCHN62
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN63
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN64
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN65
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN66
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: []
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: []
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: []
LLM Equivalence A->X: true
LLM Transformations (A to X): []
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN67
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN68
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN69
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN70
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN71
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN72
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN73
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN74
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN75
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule, JoinPushTransitivePredicatesRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(exprs=[[$1, $4, $2]])
          LogicalJoin(condition=[=($3, $0)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$4, $2]])
              LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                LogicalProject(inputs=[0], exprs=[[$2, -($4, *($7, $3))]])
                  LogicalJoin(condition=[AND(=($6, $2), =($5, $1))], joinType=[inner])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5]])
                      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[LIKE($1, 'co%')])
                            JdbcTableScan(table=[[public, part]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                    LogicalProject(inputs=[0..1], exprs=[[$3]])
                      JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: []
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule, JoinPushTransitivePredicatesRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(exprs=[[$1, $4, $2]])
          LogicalJoin(condition=[=($3, $0)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$4, $2]])
              LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                LogicalProject(inputs=[0], exprs=[[$2, -($4, *($7, $3))]])
                  LogicalJoin(condition=[AND(=($6, $2), =($5, $1))], joinType=[inner])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5]])
                      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[LIKE($1, 'co%')])
                            JdbcTableScan(table=[[public, part]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                    LogicalProject(inputs=[0..1], exprs=[[$3]])
                      JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinPushTransitivePredicatesRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): []
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(exprs=[[$1, $4, $2]])
          LogicalJoin(condition=[=($3, $0)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$4, $2]])
              LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                LogicalProject(inputs=[0], exprs=[[$2, -($4, *($7, $3))]])
                  LogicalJoin(condition=[AND(=($6, $2), =($5, $1))], joinType=[inner])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5]])
                      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[LIKE($1, 'co%')])
                            JdbcTableScan(table=[[public, part]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                    LogicalProject(inputs=[0..1], exprs=[[$3]])
                      JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($3, $7), =($2, $6))], joinType=[inner])
                LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                  LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                      LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [JoinPushTransitivePredicatesRule, ReduceExpressionsRule.JoinReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM($f2)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(exprs=[[$1, $4, $2]])
          LogicalJoin(condition=[=($3, $0)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$4, $2]])
              LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                LogicalProject(inputs=[0], exprs=[[$2, -($4, *($7, $3))]])
                  LogicalJoin(condition=[AND(=($6, $2), =($5, $1))], joinType=[inner])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5]])
                      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[LIKE($1, 'co%')])
                            JdbcTableScan(table=[[public, part]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                    LogicalProject(inputs=[0..1], exprs=[[$3]])
                      JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($3, $7), =($2, $6))], joinType=[inner])
                LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                  LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                      LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN76
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
-----------------------------------------------------
Query ID: TPCHN77
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: true
LLM Transformations (A to X): []
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): []
[Calcite.convertRelNodetoJSONQueryPlan] Error while obtaining plan: ERROR: CASE types numeric and text cannot be matched
  Position: 1498
[Calcite.convertRelNodetoJSONQueryPlan] Generated SQL (preview):
SELECT "t4"."ps_partkey", "t4"."n_name", "t4"."total_value"
FROM (SELECT "t1"."ps_partkey", "t3"."n_name", SUM("t1"."$f2") AS "total_value"
FROM (SELECT "t"."ps_partkey", "t0"."s_nationkey", "t"."$f2"
FROM (SELECT "ps_partkey", "ps_suppkey", "ps_supplycost" * "ps_availqty" AS "$f2"
FROM "public"."partsupp") AS "t"
INNER JOIN (SELECT "s_suppkey", "s_nationkey"
FROM "public"."supplier") AS "t0" ON "t"."ps_suppkey" = "t0"."s_suppkey") AS "t1"
INNER JOIN (SELECT "n_nationkey", "n_name"
FROM "public"."nation"
WHERE "n_name" = 'INDIA                    ') AS "t3" ON "t1"."s_nationkey" = "t3"."n_nationkey"
GROUP BY "t1"."ps_partkey", "t3"."n_name") AS "t4"
INNER JOIN (SELECT CASE WHEN "t13"."EXPR$0" THEN NULL WHEN "t13"."EXPR$1" THEN "t13"."$f1" ELSE "t17"."$f0" END AS "$f0"
FROM (SELECT MIN("t11"."EXPR$0") AS "$f1", COUNT("t11"."EXPR$0") = 0 AS "EXPR$0", COUNT("t11"."EXPR$0") = 1 AS "EXPR$1"
FROM (SELECT SUM("t7"."$f0") * 0.00001 AS "EXPR$0"
FROM (SELECT "t6"."s_nationkey", "t5"."$f0"
FROM (SELECT "ps_suppkey", "ps_supplycost" * "ps_availqty" AS "$f0"
FROM "public"."partsupp") AS "t5"
INNER JOIN (SELECT "s_suppkey", "s_nationkey"
FROM "public"."supplier") AS "t6" ON "t5"."ps_suppkey" = "t6"."s_suppkey") AS "t7"
INNER JOIN (SELECT "n_nationkey"
FROM "public"."nation"
WHERE "n_name" = 'INDIA                    ') AS "t9" ON "t7"."s_nationkey" = "t9"."n_nationkey") AS "t11") AS "t13"
LEFT JOIN (SELECT CASE COUNT("EXPR$0") WHEN 0 THEN NULL WHEN 1 THEN MIN("EXPR$0") ELSE (SELECT CAST(NULL AS DECIMAL(19, 7))
UNION ALL
SELECT CAST(NULL AS DECIMAL(19, 7))) END AS "$f0"
FROM (SELECT *
FROM (VALUES (NULL)) AS "t" ("EXPR$0")
UNION ALL
SELECT *
FROM (VALUES (NULL)) AS "t" ("EXPR$0")) AS "t16") AS "t17" ON TRUE) AS "t18" ON "t4"."total_value" > "t18"."$f0"
ORDER BY "t4"."total_value" DESC
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x,'INDIA',$x]->Join(INNER,<($x,TIMES($x,0.00001:DECIMAL(6, 5)))){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[ps_partkey], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Project[$x,'INDIA',$x]->Join(INNER,<($x,TIMES($x,0.00001:DECIMAL(6, 5)))){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[ps_partkey], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Project[$x,'INDIA',$x]->Join(INNER,<($x,TIMES($x,0.00001:DECIMAL(6, 5)))){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[ps_partkey], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Project[$x,'INDIA',$x]->Join(INNER,<($x,TIMES($x,0.00001:DECIMAL(6, 5)))){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[ps_partkey], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Project[$x,'INDIA',$x]->Join(INNER,<($x,TIMES($x,0.00001:DECIMAL(6, 5)))){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[ps_partkey], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Project[$x,'INDIA',$x]->Join(INNER,<($x,TIMES($x,0.00001:DECIMAL(6, 5)))){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[ps_partkey], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Project[$x,'INDIA',$x]->Join(INNER,<($x,TIMES($x,0.00001:DECIMAL(6, 5)))){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[ps_partkey], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Project[$x,'INDIA',$x]->Join(INNER,<($x,TIMES($x,0.00001:DECIMAL(6, 5)))){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[ps_partkey], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x,'INDIA',$x]->Join(INNER,<($x,TIMES($x,0.00001:DECIMAL(6, 5)))){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[ps_partkey], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Project[$x,'INDIA',$x]->Join(INNER,<($x,TIMES($x,0.00001:DECIMAL(6, 5)))){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[ps_partkey], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Project[$x,'INDIA',$x]->Join(INNER,<($x,TIMES($x,0.00001:DECIMAL(6, 5)))){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[ps_partkey], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Project[$x,'INDIA',$x]->Join(INNER,<($x,TIMES($x,0.00001:DECIMAL(6, 5)))){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[ps_partkey], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Project[$x,'INDIA',$x]->Join(INNER,<($x,TIMES($x,0.00001:DECIMAL(6, 5)))){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[ps_partkey], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0], exprs=[['INDIA', $1]])
    LogicalJoin(condition=[>($1, $2)], joinType=[inner])
      LogicalAggregate(group=[{0}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$4, $2]])
            LogicalJoin(condition=[=($1, $3)], joinType=[inner])
              LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[=($1, 'INDIA                    ')])
              JdbcTableScan(table=[[public, nation]])
      LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
        LogicalAggregate(group=[{}], agg#0=[SUM($1)])
          LogicalJoin(condition=[=($0, $2)], joinType=[inner])
            LogicalProject(exprs=[[$3, $1]])
              LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                LogicalProject(exprs=[[$1, *($3, $2)]])
                  JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0])
              LogicalFilter(condition=[=($1, 'INDIA                    ')])
                JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..2])
    LogicalJoin(condition=[>($2, $3)], joinType=[inner])
      LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$4, $2]])
            LogicalJoin(condition=[=($1, $3)], joinType=[inner])
              LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[=($1, 'INDIA                    ')])
              JdbcTableScan(table=[[public, nation]])
      LogicalProject(exprs=[[CASE($1, null:DECIMAL(19, 7), $2, $0, $3)]])
        LogicalJoin(condition=[true], joinType=[left])
          LogicalProject(exprs=[[$1, =($0, 0), =($0, 1)]])
            LogicalAggregate(group=[{}], agg#0=[COUNT($0)], agg#1=[MIN($0)])
              LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
                LogicalAggregate(group=[{}], agg#0=[SUM($1)])
                  LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                    LogicalProject(exprs=[[$3, $1]])
                      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                        LogicalProject(exprs=[[$1, *($3, $2)]])
                          JdbcTableScan(table=[[public, partsupp]])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'INDIA                    ')])
                        JdbcTableScan(table=[[public, nation]])
          LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
            LogicalUnion(all=[true])
              LogicalValues(type=[RecordType(DECIMAL(19, 7) EXPR$0)], tuples=[[{ null }]])
              LogicalValues(type=[RecordType(DECIMAL(19, 7) EXPR$0)], tuples=[[{ null }]])


Equivalence: false
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN78
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [CoerceInputsRule, ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP'), <($11, $12), <($10, $11), SEARCH($12, Sarg[[1995-01-01..1995-12-31]]))])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP'), <($11, $12), <($10, $11), SEARCH($12, Sarg[[1995-01-01..1995-12-31]]))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [CoerceInputsRule, ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP'), <($11, $12), <($10, $11), SEARCH($12, Sarg[[1995-01-01..1995-12-31]]))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [ReduceExpressionsRule.FilterReduceExpressionsRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): []
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP'), <($11, $12), <($10, $11), SEARCH($12, Sarg[[1995-01-01..1995-12-31]]))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT', '2-HIGH':CHAR(8)]:CHAR(8)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT'), ('1-URGENT'..'2-HIGH':CHAR(8)), ('2-HIGH':CHAR(8)..+)]:CHAR(8)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): []
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1995-12-31)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP'), <($11, $12), <($10, $11), SEARCH($12, Sarg[[1995-01-01..1995-12-31]]))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT', '2-HIGH':CHAR(8)]:CHAR(8)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT'), ('1-URGENT'..'2-HIGH':CHAR(8)), ('2-HIGH':CHAR(8)..+)]:CHAR(8)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN79
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN80
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [CoerceInputsRule, ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/(*(100.00:DECIMAL(5, 2), $0), $1)]])
  LogicalAggregate(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
    LogicalProject(exprs=[[CASE($3, $1, 0:DECIMAL(19, 4)), $1]])
      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, *($5, -(1, $6))]])
          LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 1:INTERVAL MONTH)))])
            JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0], exprs=[[LIKE($4, 'PROMO%')]])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/(*(100.00:DECIMAL(5, 2), $0), $1)]])
  LogicalAggregate(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
    LogicalProject(exprs=[[CASE($3, $1, 0:DECIMAL(19, 4)), $1]])
      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, *($5, -(1, $6))]])
          LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1995-02-01)])])
            JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0], exprs=[[LIKE($4, 'PROMO%')]])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: []
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [CoerceInputsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/(*(100.00:DECIMAL(5, 2), $0), $1)]])
  LogicalAggregate(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
    LogicalProject(exprs=[[CASE($3, $1, 0:DECIMAL(19, 4)), $1]])
      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, *($5, -(1, $6))]])
          LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1995-02-01)])])
            JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0], exprs=[[LIKE($4, 'PROMO%')]])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/(*(100.00:DECIMAL(5, 2), $0), $1)]])
  LogicalAggregate(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
    LogicalProject(exprs=[[CASE($3, $1, 0:DECIMAL(19, 4)), $1]])
      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, *($5, -(1, $6))]])
          LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 1:INTERVAL MONTH)))])
            JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0], exprs=[[LIKE($4, 'PROMO%')]])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: []
LLM Equivalence A->X: true
LLM Transformations (A to X): [CoerceInputsRule, ReduceExpressionsRule.FilterReduceExpressionsRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): []
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/(*(100.00:DECIMAL(5, 2), $0), $1)]])
  LogicalAggregate(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
    LogicalProject(exprs=[[CASE($3, $1, 0:DECIMAL(19, 4)), $1]])
      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, *($5, -(1, $6))]])
          LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1995-02-01)])])
            JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0], exprs=[[LIKE($4, 'PROMO%')]])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/(*(100.00:DECIMAL(5, 2), $0), $1)]])
  LogicalAggregate(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
    LogicalProject(exprs=[[CASE($3, $1, 0:DECIMAL(19, 4)), $1]])
      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, *($5, -(1, $6))]])
          LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 1:INTERVAL MONTH)))])
            JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0], exprs=[[LIKE($4, 'PROMO%')]])
          JdbcTableScan(table=[[public, part]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [CoerceInputsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM(revenue)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE(TIMES($x,100.00:DECIMAL(5, 2)),$x)]->Aggregate(groups=[], calls=[SUM($f0), SUM($f1)])->Project[CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)){Project[$x,LIKE($x,'PROMO%')]->Scan(public.part)|Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-02-01))->Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/(*(100.00:DECIMAL(5, 2), $0), $1)]])
  LogicalAggregate(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
    LogicalProject(exprs=[[CASE($3, $1, 0:DECIMAL(19, 4)), $1]])
      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, *($5, -(1, $6))]])
          LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1995-02-01)])])
            JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0], exprs=[[LIKE($4, 'PROMO%')]])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/(*(100.00:DECIMAL(5, 2), $0), $1)]])
  LogicalAggregate(group=[{}], agg#0=[SUM($0)], agg#1=[SUM($1)])
    LogicalProject(exprs=[[CASE($3, $1, 0:DECIMAL(19, 4)), $1]])
      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, *($5, -(1, $6))]])
          LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 1:INTERVAL MONTH)))])
            JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0], exprs=[[LIKE($4, 'PROMO%')]])
          JdbcTableScan(table=[[public, part]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN81
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [FilterJoinRule.FilterIntoJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)){Project[$x,$x,MAX($x)]->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,=($x,$x)){Project[$x,$x,MAX($x)]->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,=($x,$x)){Project[$x,$x,MAX($x)]->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,=($x,$x)){Project[$x,$x,MAX($x)]->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,=($x,$x)){Project[$x,$x,MAX($x)]->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,=($x,$x)){Project[$x,$x,MAX($x)]->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,=($x,$x)){Project[$x,$x,MAX($x)]->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,=($x,$x)){Project[$x,$x,MAX($x)]->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)){Project[$x,$x,MAX($x)]->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Project[$x,$x,MAX($x)]->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Project[$x,$x,MAX($x)]->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Project[$x,$x,MAX($x)]->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)){Project[$x,$x,MAX($x)]->Aggregate(groups=[supplier_no], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[], calls=[MAX(expr)])->Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Aggregate(groups=[l_suppkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1995-04-01))->Scan(public.lineitem)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(exprs=[[$2, $3, $4, $5, $1]])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(inputs=[0..1])
        LogicalFilter(condition=[=($1, $2)])
          LogicalProject(inputs=[0..1], exprs=[[MAX($1) OVER ()]])
            LogicalAggregate(group=[{0}], total_revenue=[SUM($1)])
              LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
                LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 3:INTERVAL MONTH)))])
                  JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0..2], exprs=[[$4]])
        JdbcTableScan(table=[[public, supplier]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..3], exprs=[[$5]])
    LogicalJoin(condition=[=($0, $4)], joinType=[inner])
      LogicalProject(inputs=[0..2], exprs=[[$4]])
        JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0..1])
        LogicalJoin(condition=[=($1, $2)], joinType=[inner])
          LogicalAggregate(group=[{0}], EXPR$1=[SUM($1)])
            LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
              LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 3:INTERVAL MONTH)))])
                JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{}], EXPR$0=[MAX($1)])
            LogicalAggregate(group=[{0}], EXPR$1=[SUM($1)])
              LogicalProject(exprs=[[$2, *($5, -(1, $6))]])
                LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 3:INTERVAL MONTH)))])
                  JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence B->A 2: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN82
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: []
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [SemiJoinRule.JoinToSemiJoinRule, SemiJoinJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&SEARCH($x,Sarg[1, 4, 7])){Scan(public.part)|Scan(public.partsupp)}|Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[p_brand, p_size, p_type], calls=[COUNT(ps_suppkey):DISTINCT])->Join(INNER,<>($x,'Brand#23')&=($x,$x)&NOT(LIKE($x,'MEDIUM POLISHED%'))&OR(=($x,0),AND(<=($x,$x)&IS_NULL($x)))&SEARCH($x,Sarg[1, 4, 7])){Join(LEFT,=($x,$x)){Join(INNER,true){Aggregate(groups=[], calls=[COUNT(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)|Scan(public.partsupp)}|Aggregate(groups=[s_suppkey], calls=[LITERAL_AGG(*)])->Filter(LIKE($x,'%Customer%Complaints%'))->Scan(public.supplier)}|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $10)])
    LogicalFilter(condition=[IS NULL($14)])
      LogicalJoin(condition=[=($10, $14)], joinType=[left])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
            JdbcTableScan(table=[[public, part]])
          JdbcTableScan(table=[[public, partsupp]])
        LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
          JdbcTableScan(table=[[public, supplier]])


Rel2: 
LogicalSort(sort0=[$3], sort1=[$0], sort2=[$1], sort3=[$2], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC])
  LogicalAggregate(group=[{3, 4, 5}], supplier_cnt=[COUNT(DISTINCT $1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(inputs=[0..1])
        LogicalFilter(condition=[OR(=($5, 0), AND(IS NULL($8), >=($6, $5)))])
          LogicalJoin(condition=[=($1, $7)], joinType=[left])
            LogicalJoin(condition=[true], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$0]])
                LogicalAggregate(group=[{}], c=[COUNT()])
                  LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                    JdbcTableScan(table=[[public, supplier]])
            LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
              LogicalFilter(condition=[LIKE($6, '%Customer%Complaints%')])
                JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
        LogicalFilter(condition=[AND(<>($3, 'Brand#23'), SEARCH($5, Sarg[1, 4, 7]), NOT(LIKE($4, 'MEDIUM POLISHED%')))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [SemiJoinJoinTransposeRule]
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN83
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [JoinToCorrelateRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($2)])
    LogicalJoin(condition=[AND(=($0, $3), =($1, $4))], joinType=[inner])
      LogicalProject(inputs=[0..2])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(exprs=[[$1, $4, $5]])
            JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
              JdbcTableScan(table=[[public, part]])
      LogicalProject(exprs=[[$2, $3]])
        LogicalJoin(condition=[AND(=($2, $0), <($3, $1))], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[*(0.7:DECIMAL(2, 1), $1)]])
            LogicalAggregate(group=[{1}], agg#0=[AVG($4)])
              JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{0, 1}])
            LogicalJoin(condition=[=($0, $2)], joinType=[inner])
              LogicalProject(exprs=[[$1, $4]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
                  JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalFilter(condition=[<($4, $16)])
          LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{16}])
            JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
              LogicalProject(exprs=[[*(0.7:DECIMAL(2, 1), $0)]])
                LogicalAggregate(group=[{}], agg#0=[AVG($4)])
                  LogicalFilter(condition=[=($1, $cor0.p_partkey)])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence B->A 2: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN84
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN85
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN86
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN87
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN88
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: []
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: []
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: []
LLM Equivalence A->X: true
LLM Transformations (A to X): []
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN89
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN90
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinExtractFilterRule, JoinAddRedundantSemiJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Project[$x*]->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Project[$x*]->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Project[$x*]->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Project[$x*]->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$2], sort2=[$1], sort3=[$3], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100])
  LogicalProject(exprs=[[$5, $2, $8, $0, $1, $3, $4, $6]])
    LogicalJoin(condition=[=($0, $7)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2]])
        LogicalFilter(condition=[AND(=($5, 15), LIKE($4, '%BRASS'))])
          JdbcTableScan(table=[[public, part]])
      LogicalProject(exprs=[[$1, $2, $4, $5, $6, $7, $10]])
        LogicalJoin(condition=[AND(=($3, $9), =($0, $8))], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[AND(=($0, $5), =($3, $6))], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):DECIMAL(15, 2)]])
                  LogicalAggregate(group=[{0}], EXPR$0=[MIN($1)])
                    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$2, $4]])
                        LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                          LogicalProject(inputs=[0..1], exprs=[[$3]])
                            JdbcTableScan(table=[[public, partsupp]])
                          LogicalProject(inputs=[0], exprs=[[$3]])
                            JdbcTableScan(table=[[public, supplier]])
                      LogicalProject(inputs=[0])
                        LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                          LogicalProject(inputs=[0], exprs=[[$2]])
                            JdbcTableScan(table=[[public, nation]])
                          LogicalProject(inputs=[0])
                            LogicalFilter(condition=[=($1, 'EUROPE                   ')])
                              JdbcTableScan(table=[[public, region]])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                LogicalProject(inputs=[0..2])
                  JdbcTableScan(table=[[public, nation]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[=($1, 'EUROPE                   ')])
                    JdbcTableScan(table=[[public, region]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$2], sort2=[$1], sort3=[$3], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100])
  LogicalProject(exprs=[[$5, $2, $8, $0, $1, $3, $4, $6]])
    LogicalJoin(condition=[=($0, $7)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2]])
        LogicalFilter(condition=[AND(=($5, 15), LIKE($4, '%BRASS'))])
          JdbcTableScan(table=[[public, part]])
      LogicalProject(exprs=[[$1, $2, $4, $5, $6, $7, $10]])
        LogicalJoin(condition=[AND(=($3, $9), =($0, $8))], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[AND(=($0, $5), =($3, $6))], joinType=[inner])
                LogicalProject(inputs=[0..4])
                  LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                    JdbcTableScan(table=[[public, partsupp]])
                    LogicalAggregate(group=[{0}])
                      LogicalFilter(condition=[=($5, 15)])
                        JdbcTableScan(table=[[public, part]])
                LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):DECIMAL(15, 2)]])
                  LogicalAggregate(group=[{0}], EXPR$0=[MIN($1)])
                    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$2, $4]])
                        LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                          LogicalProject(inputs=[0..1], exprs=[[$3]])
                            JdbcTableScan(table=[[public, partsupp]])
                          LogicalProject(inputs=[0], exprs=[[$3]])
                            JdbcTableScan(table=[[public, supplier]])
                      LogicalProject(inputs=[0])
                        LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                          LogicalProject(inputs=[0], exprs=[[$2]])
                            JdbcTableScan(table=[[public, nation]])
                          LogicalProject(inputs=[0])
                            LogicalFilter(condition=[=($1, 'EUROPE                   ')])
                              JdbcTableScan(table=[[public, region]])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                LogicalProject(inputs=[0..2])
                  JdbcTableScan(table=[[public, nation]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[=($1, 'EUROPE                   ')])
                    JdbcTableScan(table=[[public, region]])


Equivalence with transformations: false
LLM Equivalence A->B 2: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Project[$x*]->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Project[$x*]->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Project[$x*]->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Project[$x*]->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$2], sort2=[$1], sort3=[$3], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100])
  LogicalProject(exprs=[[$5, $2, $8, $0, $1, $3, $4, $6]])
    LogicalJoin(condition=[=($0, $7)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2]])
        LogicalFilter(condition=[AND(=($5, 15), LIKE($4, '%BRASS'))])
          JdbcTableScan(table=[[public, part]])
      LogicalProject(exprs=[[$1, $2, $4, $5, $6, $7, $10]])
        LogicalJoin(condition=[AND(=($3, $9), =($0, $8))], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[AND(=($0, $5), =($3, $6))], joinType=[inner])
                LogicalProject(inputs=[0..4])
                  LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                    JdbcTableScan(table=[[public, partsupp]])
                    LogicalAggregate(group=[{0}])
                      LogicalFilter(condition=[=($5, 15)])
                        JdbcTableScan(table=[[public, part]])
                LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):DECIMAL(15, 2)]])
                  LogicalAggregate(group=[{0}], EXPR$0=[MIN($1)])
                    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$2, $4]])
                        LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                          LogicalProject(inputs=[0..1], exprs=[[$3]])
                            JdbcTableScan(table=[[public, partsupp]])
                          LogicalProject(inputs=[0], exprs=[[$3]])
                            JdbcTableScan(table=[[public, supplier]])
                      LogicalProject(inputs=[0])
                        LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                          LogicalProject(inputs=[0], exprs=[[$2]])
                            JdbcTableScan(table=[[public, nation]])
                          LogicalProject(inputs=[0])
                            LogicalFilter(condition=[=($1, 'EUROPE                   ')])
                              JdbcTableScan(table=[[public, region]])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                LogicalProject(inputs=[0..2])
                  JdbcTableScan(table=[[public, nation]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[=($1, 'EUROPE                   ')])
                    JdbcTableScan(table=[[public, region]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$2], sort2=[$1], sort3=[$3], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100])
  LogicalProject(exprs=[[$5, $2, $8, $0, $1, $3, $4, $6]])
    LogicalJoin(condition=[=($0, $7)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2]])
        LogicalFilter(condition=[AND(=($5, 15), LIKE($4, '%BRASS'))])
          JdbcTableScan(table=[[public, part]])
      LogicalProject(exprs=[[$1, $2, $4, $5, $6, $7, $10]])
        LogicalJoin(condition=[AND(=($3, $9), =($0, $8))], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[AND(=($0, $5), =($3, $6))], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):DECIMAL(15, 2)]])
                  LogicalAggregate(group=[{0}], EXPR$0=[MIN($1)])
                    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$2, $4]])
                        LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                          LogicalProject(inputs=[0..1], exprs=[[$3]])
                            JdbcTableScan(table=[[public, partsupp]])
                          LogicalProject(inputs=[0], exprs=[[$3]])
                            JdbcTableScan(table=[[public, supplier]])
                      LogicalProject(inputs=[0])
                        LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                          LogicalProject(inputs=[0], exprs=[[$2]])
                            JdbcTableScan(table=[[public, nation]])
                          LogicalProject(inputs=[0])
                            LogicalFilter(condition=[=($1, 'EUROPE                   ')])
                              JdbcTableScan(table=[[public, region]])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                LogicalProject(inputs=[0..2])
                  JdbcTableScan(table=[[public, nation]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[=($1, 'EUROPE                   ')])
                    JdbcTableScan(table=[[public, region]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [ProjectJoinJoinRemoveRule, FilterJoinRule.JoinConditionPushRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Project[$x*]->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Project[$x*]->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Project[$x*]->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Project[$x*]->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&=($x,15)&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort(fetch=100,order=[0:DESCENDING:FIRST, 2:ASCENDING:LAST, 1:ASCENDING:LAST, 3:ASCENDING:LAST])->Join(INNER,=($x,$x)&=($x,'EUROPE')&LIKE($x,'%BRASS')&RANGE($x,15,15)){Aggregate(groups=[ps_partkey], calls=[MIN(ps_supplycost)])->Join(INNER,=($x,$x)&=($x,'EUROPE')){Scan(public.nation)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.region)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$2], sort2=[$1], sort3=[$3], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100])
  LogicalProject(exprs=[[$5, $2, $8, $0, $1, $3, $4, $6]])
    LogicalJoin(condition=[=($0, $7)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2]])
        LogicalFilter(condition=[AND(=($5, 15), LIKE($4, '%BRASS'))])
          JdbcTableScan(table=[[public, part]])
      LogicalProject(exprs=[[$1, $2, $4, $5, $6, $7, $10]])
        LogicalJoin(condition=[AND(=($3, $9), =($0, $8))], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[AND(=($0, $5), =($3, $6))], joinType=[inner])
                LogicalProject(inputs=[0..4])
                  LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                    JdbcTableScan(table=[[public, partsupp]])
                    LogicalAggregate(group=[{0}])
                      LogicalFilter(condition=[=($5, 15)])
                        JdbcTableScan(table=[[public, part]])
                LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):DECIMAL(15, 2)]])
                  LogicalAggregate(group=[{0}], EXPR$0=[MIN($1)])
                    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$2, $4]])
                        LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                          LogicalProject(inputs=[0..1], exprs=[[$3]])
                            JdbcTableScan(table=[[public, partsupp]])
                          LogicalProject(inputs=[0], exprs=[[$3]])
                            JdbcTableScan(table=[[public, supplier]])
                      LogicalProject(inputs=[0])
                        LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                          LogicalProject(inputs=[0], exprs=[[$2]])
                            JdbcTableScan(table=[[public, nation]])
                          LogicalProject(inputs=[0])
                            LogicalFilter(condition=[=($1, 'EUROPE                   ')])
                              JdbcTableScan(table=[[public, region]])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                LogicalProject(inputs=[0..2])
                  JdbcTableScan(table=[[public, nation]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[=($1, 'EUROPE                   ')])
                    JdbcTableScan(table=[[public, region]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$2], sort2=[$1], sort3=[$3], dir0=[DESC], dir1=[ASC], dir2=[ASC], dir3=[ASC], fetch=[100])
  LogicalProject(exprs=[[$5, $2, $8, $0, $1, $3, $4, $6]])
    LogicalJoin(condition=[=($0, $7)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$2]])
        LogicalFilter(condition=[AND(=($5, 15), LIKE($4, '%BRASS'))])
          JdbcTableScan(table=[[public, part]])
      LogicalProject(exprs=[[$1, $2, $4, $5, $6, $7, $10]])
        LogicalJoin(condition=[AND(=($3, $9), =($0, $8))], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[AND(=($0, $5), =($3, $6))], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):DECIMAL(15, 2)]])
                  LogicalAggregate(group=[{0}], EXPR$0=[MIN($1)])
                    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$2, $4]])
                        LogicalJoin(condition=[=($3, $1)], joinType=[inner])
                          LogicalProject(inputs=[0..1], exprs=[[$3]])
                            JdbcTableScan(table=[[public, partsupp]])
                          LogicalProject(inputs=[0], exprs=[[$3]])
                            JdbcTableScan(table=[[public, supplier]])
                      LogicalProject(inputs=[0])
                        LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                          LogicalProject(inputs=[0], exprs=[[$2]])
                            JdbcTableScan(table=[[public, nation]])
                          LogicalProject(inputs=[0])
                            LogicalFilter(condition=[=($1, 'EUROPE                   ')])
                              JdbcTableScan(table=[[public, region]])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                LogicalProject(inputs=[0..2])
                  JdbcTableScan(table=[[public, nation]])
                LogicalProject(inputs=[0])
                  LogicalFilter(condition=[=($1, 'EUROPE                   ')])
                    JdbcTableScan(table=[[public, region]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinExtractFilterRule, JoinAddRedundantSemiJoinRule]
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN91
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN92
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN93
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinAddRedundantSemiJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)|Scan(public.customer)}|Scan(public.orders)}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)|Scan(public.customer)}|Scan(public.orders)}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)|Scan(public.customer)}|Scan(public.orders)}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)|Scan(public.customer)}|Scan(public.orders)}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{4}], revenue=[SUM($5)])
    LogicalJoin(condition=[AND(=($0, $3), =($2, $1))], joinType=[inner], semiJoinDone=[true])
      LogicalJoin(condition=[AND(=($0, $3), =($2, $1))], joinType=[semi])
        LogicalProject(exprs=[[$1, $2]])
          LogicalJoin(condition=[=($0, $3)], joinType=[inner], semiJoinDone=[true])
            LogicalJoin(condition=[=($0, $2)], joinType=[semi])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, customer]])
              LogicalProject(exprs=[[$1]])
                LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
                  JdbcTableScan(table=[[public, orders]])
            LogicalProject(inputs=[0..1])
              LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
                JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0], exprs=[[$3]])
          LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
            LogicalJoin(condition=[=($1, $2)], joinType=[semi])
              LogicalProject(inputs=[0], exprs=[[$2]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalProject(inputs=[0])
                LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                  LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                    LogicalProject(inputs=[0], exprs=[[$3]])
                      JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                        LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                          LogicalProject(inputs=[0], exprs=[[$2]])
                            JdbcTableScan(table=[[public, nation]])
                          LogicalProject(inputs=[0])
                            LogicalFilter(condition=[=($1, 'ASIA                     ')])
                              JdbcTableScan(table=[[public, region]])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[=($1, 'ASIA                     ')])
                            JdbcTableScan(table=[[public, region]])
                  LogicalProject(inputs=[0])
                    LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                      LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                        LogicalProject(inputs=[0], exprs=[[$2]])
                          JdbcTableScan(table=[[public, nation]])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[=($1, 'ASIA                     ')])
                            JdbcTableScan(table=[[public, region]])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($1, 'ASIA                     ')])
                          JdbcTableScan(table=[[public, region]])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
                  LogicalProject(inputs=[0])
                    LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                      LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                        LogicalProject(inputs=[0], exprs=[[$2]])
                          JdbcTableScan(table=[[public, nation]])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[=($1, 'ASIA                     ')])
                            JdbcTableScan(table=[[public, region]])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($1, 'ASIA                     ')])
                          JdbcTableScan(table=[[public, region]])
                LogicalProject(inputs=[0])
                  LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                    LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                      LogicalProject(inputs=[0], exprs=[[$2]])
                        JdbcTableScan(table=[[public, nation]])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($1, 'ASIA                     ')])
                          JdbcTableScan(table=[[public, region]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'ASIA                     ')])
                        JdbcTableScan(table=[[public, region]])
      LogicalProject(inputs=[0], exprs=[[$4, $5, $2]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner], semiJoinDone=[true])
          LogicalJoin(condition=[=($1, $3)], joinType=[semi])
            LogicalProject(inputs=[0], exprs=[[$2, *($5, -(1, $6))]])
              JdbcTableScan(table=[[public, lineitem]])
            LogicalProject(inputs=[0])
              LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
                  LogicalProject(inputs=[0])
                    LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                      LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                        LogicalProject(inputs=[0], exprs=[[$2]])
                          JdbcTableScan(table=[[public, nation]])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[=($1, 'ASIA                     ')])
                            JdbcTableScan(table=[[public, region]])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($1, 'ASIA                     ')])
                          JdbcTableScan(table=[[public, region]])
                LogicalProject(inputs=[0])
                  LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                    LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                      LogicalProject(inputs=[0], exprs=[[$2]])
                        JdbcTableScan(table=[[public, nation]])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($1, 'ASIA                     ')])
                          JdbcTableScan(table=[[public, region]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'ASIA                     ')])
                        JdbcTableScan(table=[[public, region]])
          LogicalProject(inputs=[0..1], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
              LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, supplier]])
                LogicalProject(inputs=[0])
                  LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                    LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                      LogicalProject(inputs=[0], exprs=[[$2]])
                        JdbcTableScan(table=[[public, nation]])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($1, 'ASIA                     ')])
                          JdbcTableScan(table=[[public, region]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'ASIA                     ')])
                        JdbcTableScan(table=[[public, region]])
              LogicalProject(inputs=[0..1])
                LogicalJoin(condition=[=($2, $3)], joinType=[inner], semiJoinDone=[true])
                  LogicalJoin(condition=[=($2, $3)], joinType=[semi])
                    LogicalProject(inputs=[0..2])
                      JdbcTableScan(table=[[public, nation]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'ASIA                     ')])
                        JdbcTableScan(table=[[public, region]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])


Rel2: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{4}], revenue=[SUM($5)])
    LogicalJoin(condition=[AND(=($0, $3), =($2, $1))], joinType=[inner])
      LogicalProject(exprs=[[$1, $2]])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$3]])
            JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
              LogicalProject(inputs=[0..8])
                LogicalJoin(condition=[=($0, $9)], joinType=[inner])
                  JdbcTableScan(table=[[public, orders]])
                  LogicalAggregate(group=[{0}])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$4, $5, $2]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$2, *($5, -(1, $6))]])
            JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0..1], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0..1])
                LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                  LogicalProject(inputs=[0..2])
                    JdbcTableScan(table=[[public, nation]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [JoinAddRedundantSemiJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)|Scan(public.customer)}|Scan(public.orders)}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)|Scan(public.customer)}|Scan(public.orders)}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Project[$x*]->Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)|Scan(public.customer)}|Scan(public.orders)}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)|Scan(public.customer)}|Scan(public.orders)}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}|Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.nation)}|Scan(public.region)}|Scan(public.supplier)}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)&RANGE($x,1995-01-01,1996-01-01)){Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Join(INNER,=($x,$x)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Scan(public.region)}}|Scan(public.region)}}|Scan(public.region)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{4}], revenue=[SUM($5)])
    LogicalJoin(condition=[AND(=($0, $3), =($2, $1))], joinType=[inner], semiJoinDone=[true])
      LogicalJoin(condition=[AND(=($0, $3), =($2, $1))], joinType=[semi])
        LogicalProject(exprs=[[$1, $2]])
          LogicalJoin(condition=[=($0, $3)], joinType=[inner], semiJoinDone=[true])
            LogicalJoin(condition=[=($0, $2)], joinType=[semi])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, customer]])
              LogicalProject(exprs=[[$1]])
                LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
                  JdbcTableScan(table=[[public, orders]])
            LogicalProject(inputs=[0..1])
              LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
                JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0], exprs=[[$3]])
          LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
            LogicalJoin(condition=[=($1, $2)], joinType=[semi])
              LogicalProject(inputs=[0], exprs=[[$2]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalProject(inputs=[0])
                LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                  LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                    LogicalProject(inputs=[0], exprs=[[$3]])
                      JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                        LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                          LogicalProject(inputs=[0], exprs=[[$2]])
                            JdbcTableScan(table=[[public, nation]])
                          LogicalProject(inputs=[0])
                            LogicalFilter(condition=[=($1, 'ASIA                     ')])
                              JdbcTableScan(table=[[public, region]])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[=($1, 'ASIA                     ')])
                            JdbcTableScan(table=[[public, region]])
                  LogicalProject(inputs=[0])
                    LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                      LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                        LogicalProject(inputs=[0], exprs=[[$2]])
                          JdbcTableScan(table=[[public, nation]])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[=($1, 'ASIA                     ')])
                            JdbcTableScan(table=[[public, region]])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($1, 'ASIA                     ')])
                          JdbcTableScan(table=[[public, region]])
            LogicalProject(inputs=[0..1])
              LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
                  LogicalProject(inputs=[0])
                    LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                      LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                        LogicalProject(inputs=[0], exprs=[[$2]])
                          JdbcTableScan(table=[[public, nation]])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[=($1, 'ASIA                     ')])
                            JdbcTableScan(table=[[public, region]])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($1, 'ASIA                     ')])
                          JdbcTableScan(table=[[public, region]])
                LogicalProject(inputs=[0])
                  LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                    LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                      LogicalProject(inputs=[0], exprs=[[$2]])
                        JdbcTableScan(table=[[public, nation]])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($1, 'ASIA                     ')])
                          JdbcTableScan(table=[[public, region]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'ASIA                     ')])
                        JdbcTableScan(table=[[public, region]])
      LogicalProject(inputs=[0], exprs=[[$4, $5, $2]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner], semiJoinDone=[true])
          LogicalJoin(condition=[=($1, $3)], joinType=[semi])
            LogicalProject(inputs=[0], exprs=[[$2, *($5, -(1, $6))]])
              JdbcTableScan(table=[[public, lineitem]])
            LogicalProject(inputs=[0])
              LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
                  LogicalProject(inputs=[0])
                    LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                      LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                        LogicalProject(inputs=[0], exprs=[[$2]])
                          JdbcTableScan(table=[[public, nation]])
                        LogicalProject(inputs=[0])
                          LogicalFilter(condition=[=($1, 'ASIA                     ')])
                            JdbcTableScan(table=[[public, region]])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($1, 'ASIA                     ')])
                          JdbcTableScan(table=[[public, region]])
                LogicalProject(inputs=[0])
                  LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                    LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                      LogicalProject(inputs=[0], exprs=[[$2]])
                        JdbcTableScan(table=[[public, nation]])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($1, 'ASIA                     ')])
                          JdbcTableScan(table=[[public, region]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'ASIA                     ')])
                        JdbcTableScan(table=[[public, region]])
          LogicalProject(inputs=[0..1], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
              LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, supplier]])
                LogicalProject(inputs=[0])
                  LogicalJoin(condition=[=($1, $2)], joinType=[inner], semiJoinDone=[true])
                    LogicalJoin(condition=[=($1, $2)], joinType=[semi])
                      LogicalProject(inputs=[0], exprs=[[$2]])
                        JdbcTableScan(table=[[public, nation]])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[=($1, 'ASIA                     ')])
                          JdbcTableScan(table=[[public, region]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'ASIA                     ')])
                        JdbcTableScan(table=[[public, region]])
              LogicalProject(inputs=[0..1])
                LogicalJoin(condition=[=($2, $3)], joinType=[inner], semiJoinDone=[true])
                  LogicalJoin(condition=[=($2, $3)], joinType=[semi])
                    LogicalProject(inputs=[0..2])
                      JdbcTableScan(table=[[public, nation]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'ASIA                     ')])
                        JdbcTableScan(table=[[public, region]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])


Rel2: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{4}], revenue=[SUM($5)])
    LogicalJoin(condition=[AND(=($0, $3), =($2, $1))], joinType=[inner])
      LogicalProject(exprs=[[$1, $2]])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$3]])
            JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
              LogicalProject(inputs=[0..8])
                LogicalJoin(condition=[=($0, $9)], joinType=[inner])
                  JdbcTableScan(table=[[public, orders]])
                  LogicalAggregate(group=[{0}])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$4, $5, $2]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$2, *($5, -(1, $6))]])
            JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0..1], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0..1])
                LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                  LogicalProject(inputs=[0..2])
                    JdbcTableScan(table=[[public, nation]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{4}], revenue=[SUM($5)])
    LogicalJoin(condition=[AND(=($0, $3), =($2, $1))], joinType=[inner])
      LogicalProject(exprs=[[$1, $2]])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$3]])
            JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
              LogicalProject(inputs=[0..8])
                LogicalJoin(condition=[=($0, $9)], joinType=[inner])
                  JdbcTableScan(table=[[public, orders]])
                  LogicalAggregate(group=[{0}])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$4, $5, $2]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$2, *($5, -(1, $6))]])
            JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0..1], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0..1])
                LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                  LogicalProject(inputs=[0..2])
                    JdbcTableScan(table=[[public, nation]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])


Rel2: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{4}], revenue=[SUM($5)])
    LogicalJoin(condition=[AND(=($0, $3), =($2, $1))], joinType=[inner])
      LogicalProject(exprs=[[$1, $2]])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$3]])
            JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
              JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$4, $5, $2]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$2, *($5, -(1, $6))]])
            JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0..1], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0..1])
                LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                  LogicalProject(inputs=[0..2])
                    JdbcTableScan(table=[[public, nation]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{4}], revenue=[SUM($5)])
    LogicalJoin(condition=[AND(=($0, $3), =($2, $1))], joinType=[inner])
      LogicalProject(exprs=[[$1, $2]])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$3]])
            JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
              LogicalProject(inputs=[0..8])
                LogicalJoin(condition=[=($0, $9)], joinType=[inner])
                  JdbcTableScan(table=[[public, orders]])
                  LogicalAggregate(group=[{0}])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$4, $5, $2]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$2, *($5, -(1, $6))]])
            JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0..1], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0..1])
                LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                  LogicalProject(inputs=[0..2])
                    JdbcTableScan(table=[[public, nation]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])


Rel2: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{4}], revenue=[SUM($5)])
    LogicalJoin(condition=[AND(=($0, $3), =($2, $1))], joinType=[inner])
      LogicalProject(exprs=[[$1, $2]])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$3]])
            JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
              JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$4, $5, $2]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$2, *($5, -(1, $6))]])
            JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0..1], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0..1])
                LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                  LogicalProject(inputs=[0..2])
                    JdbcTableScan(table=[[public, nation]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinAddRedundantSemiJoinRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{4}], revenue=[SUM($5)])
    LogicalJoin(condition=[AND(=($0, $3), =($2, $1))], joinType=[inner])
      LogicalProject(exprs=[[$1, $2]])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$3]])
            JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
              LogicalProject(inputs=[0..8])
                LogicalJoin(condition=[=($0, $9)], joinType=[inner])
                  JdbcTableScan(table=[[public, orders]])
                  LogicalAggregate(group=[{0}])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$4, $5, $2]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$2, *($5, -(1, $6))]])
            JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0..1], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0..1])
                LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                  LogicalProject(inputs=[0..2])
                    JdbcTableScan(table=[[public, nation]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])


Rel2: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{4}], revenue=[SUM($5)])
    LogicalJoin(condition=[AND(=($0, $3), =($1, $2))], joinType=[inner])
      LogicalProject(exprs=[[$1, $2]])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$3]])
            JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
              JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$4, $5, $2]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$2, *($5, -(1, $6))]])
            JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0..1], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0..1])
                LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                  LogicalProject(inputs=[0..2])
                    JdbcTableScan(table=[[public, nation]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [SemiJoinRemoveRule, JoinPushTransitivePredicatesRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.region)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.region)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.region)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.region)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.region)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.region)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.region)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.region)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.region)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.region)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.region)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.region)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.region)|Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name], calls=[SUM($f1)])->Join(INNER,=($x,$x)&=($x,'ASIA')&RANGE($x,1995-01-01,1996-01-01)){Project[$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.customer)|Scan(public.nation)|Scan(public.orders)|Scan(public.region)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{4}], revenue=[SUM($5)])
    LogicalJoin(condition=[AND(=($0, $3), =($2, $1))], joinType=[inner])
      LogicalProject(exprs=[[$1, $2]])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$3]])
            JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
              LogicalProject(inputs=[0..8])
                LogicalJoin(condition=[=($0, $9)], joinType=[inner])
                  JdbcTableScan(table=[[public, orders]])
                  LogicalAggregate(group=[{0}])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$19, $24, *($5, -(1, $6))]])
        LogicalJoin(condition=[=($0, $30)], joinType=[inner])
          LogicalJoin(condition=[=($2, $16)], joinType=[inner])
            JdbcTableScan(table=[[public, lineitem]])
            LogicalJoin(condition=[=($3, $7)], joinType=[inner])
              JdbcTableScan(table=[[public, supplier]])
              LogicalJoin(condition=[=($2, $4)], joinType=[inner])
                JdbcTableScan(table=[[public, nation]])
                LogicalFilter(condition=[=($1, 'ASIA                     ')])
                  JdbcTableScan(table=[[public, region]])
          LogicalAggregate(group=[{0}])
            JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{4}], revenue=[SUM($5)])
    LogicalJoin(condition=[AND(=($0, $3), =($1, $2))], joinType=[inner])
      LogicalProject(exprs=[[$1, $2]])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$3]])
            JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
              JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$4, $5, $2]])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$2, *($5, -(1, $6))]])
            JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0..1], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0..1])
                LogicalJoin(condition=[=($2, $3)], joinType=[inner])
                  LogicalProject(inputs=[0..2])
                    JdbcTableScan(table=[[public, nation]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN94
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN95
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinAssociateRule, JoinAddRedundantSemiJoinRule, JoinAddRedundantSemiJoinRule, JoinAddRedundantSemiJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Project[$x*]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x*]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.customer)}|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x*]->Join(INNER,=($x,$x)){Project[$x*]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.customer)}|Project[$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}}|Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Project[$x*]->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}}|Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}}|Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}}|Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}}|Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}}|Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)}|Scan(public.orders)}}|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}}|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)|Join(INNER,=($x,$x)){Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.orders)}}|Project[$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}}|Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Scan(public.supplier)}|Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)}|Scan(public.orders)}}|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}}|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)|Join(INNER,=($x,$x)){Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.orders)}}|Project[$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}}|Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Scan(public.supplier)}|Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Project[$x*]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x*]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.customer)}|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Join(INNER,=($x,$x)){Project[$x*]->Scan(public.supplier)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x*]->Join(INNER,=($x,$x)){Project[$x*]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.customer)}|Project[$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}}|Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Project[$x*]->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}}|Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)}|Scan(public.orders)}}|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}}|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)|Join(INNER,=($x,$x)){Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.orders)}}|Project[$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}}|Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Scan(public.supplier)}|Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)}|Scan(public.orders)}}|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}}|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)|Join(INNER,=($x,$x)){Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.orders)}}|Project[$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}}|Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Scan(public.supplier)}|Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)&OR($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.orders)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.customer)}|Project[$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Scan(public.customer)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}|Project[$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}}|Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC])
  LogicalAggregate(group=[{4, 5, 6}], revenue=[SUM($7)])
    LogicalJoin(condition=[AND(=($1, $3), =($0, $2))], joinType=[inner], semiJoinDone=[true])
      LogicalJoin(condition=[AND(=($1, $3), =($0, $2))], joinType=[semi])
        LogicalProject(inputs=[0], exprs=[[$3]])
          JdbcTableScan(table=[[public, supplier]])
        LogicalProject(inputs=[0], exprs=[[$2]])
          LogicalJoin(condition=[AND(=($1, $5), OR(AND($3, $6), AND($4, $7)))], joinType=[inner], semiJoinDone=[true])
            LogicalJoin(condition=[AND(=($1, $5), OR(AND($3, $6), AND($4, $7)))], joinType=[semi])
              LogicalJoin(condition=[true], joinType=[inner])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  LogicalJoin(condition=[=($2, $1)], joinType=[inner], semiJoinDone=[true])
                    LogicalJoin(condition=[=($2, $1)], joinType=[semi])
                      LogicalProject(exprs=[[$1, $3]])
                        LogicalJoin(condition=[=($2, $0)], joinType=[inner], semiJoinDone=[true])
                          LogicalJoin(condition=[=($2, $0)], joinType=[semi])
                            LogicalProject(inputs=[0], exprs=[[$2]])
                              LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-12-31]])])
                                JdbcTableScan(table=[[public, lineitem]])
                            LogicalProject(inputs=[0])
                              JdbcTableScan(table=[[public, orders]])
                          LogicalProject(inputs=[0..1])
                            JdbcTableScan(table=[[public, orders]])
                      LogicalProject(inputs=[0])
                        JdbcTableScan(table=[[public, customer]])
                    LogicalProject(inputs=[0], exprs=[[$3]])
                      JdbcTableScan(table=[[public, customer]])
                LogicalProject(inputs=[0], exprs=[[=($1, 'GERMANY                  '), =($1, 'FRANCE                   ')]])
                  JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0], exprs=[[=($1, 'FRANCE                   '), =($1, 'GERMANY                  ')]])
                JdbcTableScan(table=[[public, nation]])
            LogicalProject(inputs=[0], exprs=[[=($1, 'FRANCE                   '), =($1, 'GERMANY                  ')]])
              JdbcTableScan(table=[[public, nation]])
      LogicalProject(inputs=[0], exprs=[[$2, $3, $9, $4, $5]])
        LogicalJoin(condition=[AND(=($1, $8), OR(AND($6, $10), AND($7, $11)))], joinType=[inner], semiJoinDone=[true])
          LogicalJoin(condition=[AND(=($1, $8), OR(AND($6, $9), AND($7, $10)))], joinType=[semi])
            LogicalProject(inputs=[0..1], exprs=[[$4, $5, $2, $3, $6, $7]])
              LogicalJoin(condition=[true], joinType=[inner])
                LogicalProject(inputs=[0], exprs=[[$5, $2, $3]])
                  LogicalJoin(condition=[=($4, $1)], joinType=[inner], semiJoinDone=[true])
                    LogicalJoin(condition=[=($4, $1)], joinType=[semi])
                      LogicalProject(exprs=[[$1, $5, $2, $3]])
                        LogicalJoin(condition=[=($4, $0)], joinType=[inner], semiJoinDone=[true])
                          LogicalJoin(condition=[=($4, $0)], joinType=[semi])
                            LogicalProject(inputs=[0], exprs=[[$2, EXTRACT(FLAG(YEAR), $10), *($5, -(1, $6))]])
                              LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-12-31]])])
                                JdbcTableScan(table=[[public, lineitem]])
                            LogicalProject(inputs=[0])
                              JdbcTableScan(table=[[public, orders]])
                          LogicalProject(inputs=[0..1])
                            JdbcTableScan(table=[[public, orders]])
                      LogicalProject(inputs=[0])
                        JdbcTableScan(table=[[public, customer]])
                    LogicalProject(inputs=[0], exprs=[[$3]])
                      JdbcTableScan(table=[[public, customer]])
                LogicalProject(inputs=[0..1], exprs=[[=($1, 'GERMANY                  '), =($1, 'FRANCE                   ')]])
                  JdbcTableScan(table=[[public, nation]])
            LogicalProject(inputs=[0], exprs=[[=($1, 'FRANCE                   '), =($1, 'GERMANY                  ')]])
              JdbcTableScan(table=[[public, nation]])
          LogicalProject(inputs=[0..1], exprs=[[=($1, 'FRANCE                   '), =($1, 'GERMANY                  ')]])
            JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC])
  LogicalProject(exprs=[[$1, $2, $0, $3]])
    LogicalAggregate(group=[{2, 6, 7}], revenue=[SUM($3)])
      LogicalJoin(condition=[AND(=($5, $0), =($4, $1))], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$2, EXTRACT(FLAG(YEAR), $10), *($5, -(1, $6))]])
          LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-12-31]])])
            LogicalProject(inputs=[0..15])
              LogicalJoin(condition=[=($0, $16)], joinType=[inner])
                LogicalProject(inputs=[0..15])
                  LogicalJoin(condition=[=($2, $16)], joinType=[inner])
                    JdbcTableScan(table=[[public, lineitem]])
                    LogicalAggregate(group=[{0}])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalAggregate(group=[{0}])
                          LogicalFilter(condition=[SEARCH($1, Sarg['FRANCE':CHAR(7), 'GERMANY']:CHAR(7))])
                            JdbcTableScan(table=[[public, nation]])
                LogicalAggregate(group=[{0}])
                  LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                    LogicalProject(inputs=[0..1])
                      JdbcTableScan(table=[[public, orders]])
                    LogicalAggregate(group=[{0}])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, customer]])
                        LogicalAggregate(group=[{0}])
                          LogicalFilter(condition=[SEARCH($1, Sarg['FRANCE':CHAR(7), 'GERMANY']:CHAR(7))])
                            JdbcTableScan(table=[[public, nation]])
        LogicalProject(inputs=[0], exprs=[[$2, $4, $5]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3]])
              JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
              LogicalJoin(condition=[=($2, $1)], joinType=[inner])
                LogicalProject(inputs=[0..1])
                  JdbcTableScan(table=[[public, orders]])
                LogicalProject(inputs=[0], exprs=[[$2, $3, $5]])
                  LogicalJoin(condition=[=($1, $4)], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$3]])
                      JdbcTableScan(table=[[public, customer]])
                    LogicalProject(inputs=[0..1], exprs=[[$4, $5]])
                      LogicalJoin(condition=[OR(AND($2, $6), AND($3, $7))], joinType=[inner])
                        LogicalProject(inputs=[0..1], exprs=[[=($1, 'GERMANY                  '), =($1, 'FRANCE                   ')]])
                          JdbcTableScan(table=[[public, nation]])
                        LogicalProject(inputs=[0..1], exprs=[[=($1, 'FRANCE                   '), =($1, 'GERMANY                  ')]])
                          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->B 2: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [FilterJoinRule.FilterIntoJoinRule, JoinAssociateRule, SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Project[$x*]->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Project[$x*]->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC])
  LogicalProject(exprs=[[$1, $2, $0, $3]])
    LogicalAggregate(group=[{2, 6, 7}], revenue=[SUM($3)])
      LogicalJoin(condition=[AND(=($5, $0), =($4, $1))], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$2, EXTRACT(FLAG(YEAR), $10), *($5, -(1, $6))]])
          LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-12-31]])])
            LogicalProject(inputs=[0..15])
              LogicalJoin(condition=[=($0, $16)], joinType=[inner])
                LogicalProject(inputs=[0..15])
                  LogicalJoin(condition=[=($2, $16)], joinType=[inner])
                    JdbcTableScan(table=[[public, lineitem]])
                    LogicalAggregate(group=[{0}])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalAggregate(group=[{0}])
                          LogicalFilter(condition=[SEARCH($1, Sarg['FRANCE':CHAR(7), 'GERMANY']:CHAR(7))])
                            JdbcTableScan(table=[[public, nation]])
                LogicalAggregate(group=[{0}])
                  LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                    LogicalProject(inputs=[0..1])
                      JdbcTableScan(table=[[public, orders]])
                    LogicalAggregate(group=[{0}])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, customer]])
                        LogicalAggregate(group=[{0}])
                          LogicalFilter(condition=[SEARCH($1, Sarg['FRANCE':CHAR(7), 'GERMANY']:CHAR(7))])
                            JdbcTableScan(table=[[public, nation]])
        LogicalProject(inputs=[0], exprs=[[$2, $4, $5]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3]])
              JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
              LogicalJoin(condition=[=($2, $1)], joinType=[inner])
                LogicalProject(inputs=[0..1])
                  JdbcTableScan(table=[[public, orders]])
                LogicalProject(inputs=[0], exprs=[[$2, $3, $5]])
                  LogicalJoin(condition=[=($1, $4)], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$3]])
                      JdbcTableScan(table=[[public, customer]])
                    LogicalProject(inputs=[0..1], exprs=[[$4, $5]])
                      LogicalJoin(condition=[OR(AND($2, $6), AND($3, $7))], joinType=[inner])
                        LogicalProject(inputs=[0..1], exprs=[[=($1, 'GERMANY                  '), =($1, 'FRANCE                   ')]])
                          JdbcTableScan(table=[[public, nation]])
                        LogicalProject(inputs=[0..1], exprs=[[=($1, 'FRANCE                   '), =($1, 'GERMANY                  ')]])
                          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC])
  LogicalAggregate(group=[{4, 5, 6}], revenue=[SUM($7)])
    LogicalJoin(condition=[AND(=($1, $3), =($0, $2))], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$3]])
        JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$2, $3, $9, $4, $5]])
        LogicalJoin(condition=[AND(=($1, $8), OR(AND($6, $10), AND($7, $11)))], joinType=[inner])
          LogicalProject(inputs=[0..1], exprs=[[$4, $5, $2, $3, $6, $7]])
            LogicalJoin(condition=[true], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$5, $2, $3]])
                LogicalJoin(condition=[=($4, $1)], joinType=[inner])
                  LogicalProject(exprs=[[$1, $5, $2, $3]])
                    LogicalJoin(condition=[=($4, $0)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$2, EXTRACT(FLAG(YEAR), $10), *($5, -(1, $6))]])
                        LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-12-31]])])
                          JdbcTableScan(table=[[public, lineitem]])
                      LogicalProject(inputs=[0..1])
                        JdbcTableScan(table=[[public, orders]])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, customer]])
              LogicalProject(inputs=[0..1], exprs=[[=($1, 'GERMANY                  '), =($1, 'FRANCE                   ')]])
                JdbcTableScan(table=[[public, nation]])
          LogicalProject(inputs=[0..1], exprs=[[=($1, 'FRANCE                   '), =($1, 'GERMANY                  ')]])
            JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule, SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Project[$x*]->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Project[$x*]->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC])
  LogicalProject(exprs=[[$1, $2, $0, $3]])
    LogicalAggregate(group=[{2, 6, 7}], revenue=[SUM($3)])
      LogicalJoin(condition=[AND(=($5, $0), =($4, $1))], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$2, EXTRACT(FLAG(YEAR), $10), *($5, -(1, $6))]])
          LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-12-31]])])
            LogicalProject(inputs=[0..15])
              LogicalJoin(condition=[=($0, $16)], joinType=[inner])
                LogicalProject(inputs=[0..15])
                  LogicalJoin(condition=[=($2, $16)], joinType=[inner])
                    JdbcTableScan(table=[[public, lineitem]])
                    LogicalAggregate(group=[{0}])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalAggregate(group=[{0}])
                          LogicalFilter(condition=[SEARCH($1, Sarg['FRANCE':CHAR(7), 'GERMANY']:CHAR(7))])
                            JdbcTableScan(table=[[public, nation]])
                LogicalAggregate(group=[{0}])
                  LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                    LogicalProject(inputs=[0..1])
                      JdbcTableScan(table=[[public, orders]])
                    LogicalAggregate(group=[{0}])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, customer]])
                        LogicalAggregate(group=[{0}])
                          LogicalFilter(condition=[SEARCH($1, Sarg['FRANCE':CHAR(7), 'GERMANY']:CHAR(7))])
                            JdbcTableScan(table=[[public, nation]])
        LogicalProject(inputs=[0], exprs=[[$2, $4, $5]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3]])
              JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
              LogicalJoin(condition=[=($2, $1)], joinType=[inner])
                LogicalProject(inputs=[0..1])
                  JdbcTableScan(table=[[public, orders]])
                LogicalProject(inputs=[0], exprs=[[$2, $3, $5]])
                  LogicalJoin(condition=[=($1, $4)], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$3]])
                      JdbcTableScan(table=[[public, customer]])
                    LogicalProject(inputs=[0..1], exprs=[[$4, $5]])
                      LogicalJoin(condition=[OR(AND($2, $6), AND($3, $7))], joinType=[inner])
                        LogicalProject(inputs=[0..1], exprs=[[=($1, 'GERMANY                  '), =($1, 'FRANCE                   ')]])
                          JdbcTableScan(table=[[public, nation]])
                        LogicalProject(inputs=[0..1], exprs=[[=($1, 'FRANCE                   '), =($1, 'GERMANY                  ')]])
                          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC])
  LogicalAggregate(group=[{4, 5, 6}], revenue=[SUM($7)])
    LogicalJoin(condition=[AND(=($1, $3), =($0, $2))], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$3]])
        JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$2, $3, $9, $4, $5]])
        LogicalJoin(condition=[AND(=($1, $8), OR(AND($6, $10), AND($7, $11)))], joinType=[inner])
          LogicalProject(inputs=[0..1], exprs=[[$4, $5, $2, $3, $6, $7]])
            LogicalJoin(condition=[true], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$5, $2, $3]])
                LogicalJoin(condition=[=($4, $1)], joinType=[inner])
                  LogicalProject(exprs=[[$1, $5, $2, $3]])
                    LogicalJoin(condition=[=($4, $0)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$2, EXTRACT(FLAG(YEAR), $10), *($5, -(1, $6))]])
                        LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-12-31]])])
                          JdbcTableScan(table=[[public, lineitem]])
                      LogicalProject(inputs=[0..1])
                        JdbcTableScan(table=[[public, orders]])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, customer]])
              LogicalProject(inputs=[0..1], exprs=[[=($1, 'GERMANY                  '), =($1, 'FRANCE                   ')]])
                JdbcTableScan(table=[[public, nation]])
          LogicalProject(inputs=[0..1], exprs=[[=($1, 'FRANCE                   '), =($1, 'GERMANY                  ')]])
            JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinAddRedundantSemiJoinRule, SemiJoinJoinTransposeRule, JoinAssociateRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [SemiJoinRemoveRule, FilterJoinRule.FilterIntoJoinRule, JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Project[$x*]->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Project[$x*]->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC])
  LogicalProject(exprs=[[$1, $2, $0, $3]])
    LogicalAggregate(group=[{2, 6, 7}], revenue=[SUM($3)])
      LogicalJoin(condition=[AND(=($5, $0), =($4, $1))], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$2, EXTRACT(FLAG(YEAR), $10), *($5, -(1, $6))]])
          LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-12-31]])])
            LogicalProject(inputs=[0..15])
              LogicalJoin(condition=[=($0, $16)], joinType=[inner])
                LogicalProject(inputs=[0..15])
                  LogicalJoin(condition=[=($2, $16)], joinType=[inner])
                    JdbcTableScan(table=[[public, lineitem]])
                    LogicalAggregate(group=[{0}])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalAggregate(group=[{0}])
                          LogicalFilter(condition=[SEARCH($1, Sarg['FRANCE':CHAR(7), 'GERMANY']:CHAR(7))])
                            JdbcTableScan(table=[[public, nation]])
                LogicalAggregate(group=[{0}])
                  LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                    LogicalProject(inputs=[0..1])
                      JdbcTableScan(table=[[public, orders]])
                    LogicalAggregate(group=[{0}])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, customer]])
                        LogicalAggregate(group=[{0}])
                          LogicalFilter(condition=[SEARCH($1, Sarg['FRANCE':CHAR(7), 'GERMANY']:CHAR(7))])
                            JdbcTableScan(table=[[public, nation]])
        LogicalProject(inputs=[0], exprs=[[$2, $4, $5]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3]])
              JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
              LogicalJoin(condition=[=($2, $1)], joinType=[inner])
                LogicalProject(inputs=[0..1])
                  JdbcTableScan(table=[[public, orders]])
                LogicalProject(inputs=[0], exprs=[[$2, $3, $5]])
                  LogicalJoin(condition=[=($1, $4)], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$3]])
                      JdbcTableScan(table=[[public, customer]])
                    LogicalProject(inputs=[0..1], exprs=[[$4, $5]])
                      LogicalJoin(condition=[OR(AND($2, $6), AND($3, $7))], joinType=[inner])
                        LogicalProject(inputs=[0..1], exprs=[[=($1, 'GERMANY                  '), =($1, 'FRANCE                   ')]])
                          JdbcTableScan(table=[[public, nation]])
                        LogicalProject(inputs=[0..1], exprs=[[=($1, 'FRANCE                   '), =($1, 'GERMANY                  ')]])
                          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC])
  LogicalAggregate(group=[{4, 5, 6}], revenue=[SUM($7)])
    LogicalJoin(condition=[AND(=($1, $3), =($0, $2))], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$3]])
        JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$2, $3, $9, $4, $5]])
        LogicalJoin(condition=[AND(=($1, $8), OR(AND($6, $10), AND($7, $11)))], joinType=[inner])
          LogicalProject(inputs=[0..1], exprs=[[$4, $5, $2, $3, $6, $7]])
            LogicalJoin(condition=[true], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$5, $2, $3]])
                LogicalJoin(condition=[=($1, $4)], joinType=[inner])
                  LogicalProject(exprs=[[$1, $5, $2, $3]])
                    LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$2, EXTRACT(FLAG(YEAR), $10), *($5, -(1, $6))]])
                        LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-12-31]])])
                          JdbcTableScan(table=[[public, lineitem]])
                      LogicalProject(inputs=[0..1])
                        JdbcTableScan(table=[[public, orders]])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, customer]])
              LogicalProject(inputs=[0..1], exprs=[[=($1, 'GERMANY                  '), =($1, 'FRANCE                   ')]])
                JdbcTableScan(table=[[public, nation]])
          LogicalProject(inputs=[0..1], exprs=[[=($1, 'FRANCE                   '), =($1, 'GERMANY                  ')]])
            JdbcTableScan(table=[[public, nation]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [JoinToMultiJoinRule, FilterJoinRule.FilterIntoJoinRule, SemiJoinRemoveRule, MultiJoinOptimizeBushyRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Project[$x*]->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Project[$x*]->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Join(INNER,=($x,$x)&SEARCH($x,'FRANCE')){Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.orders)|Scan(public.supplier)}|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_year, n_name, n_name0], calls=[SUM(volume)])->Join(INNER,=($x,$x)&OR($x,$x)){Project[$x,$x,=($x,'FRANCE'),=($x,'GERMANY')]->Scan(public.nation)|Project[$x,$x,=($x,'GERMANY'),=($x,'FRANCE')]->Scan(public.nation)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x),TIMES($x,MINUS(1,$x))]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC])
  LogicalProject(exprs=[[$1, $2, $0, $3]])
    LogicalAggregate(group=[{2, 6, 7}], revenue=[SUM($3)])
      LogicalJoin(condition=[AND(=($5, $0), =($4, $1))], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$2, EXTRACT(FLAG(YEAR), $10), *($5, -(1, $6))]])
          LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-12-31]])])
            LogicalProject(inputs=[0..15])
              LogicalJoin(condition=[=($0, $16)], joinType=[inner])
                LogicalProject(inputs=[0..15])
                  LogicalJoin(condition=[=($2, $16)], joinType=[inner])
                    JdbcTableScan(table=[[public, lineitem]])
                    LogicalAggregate(group=[{0}])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalAggregate(group=[{0}])
                          LogicalFilter(condition=[SEARCH($1, Sarg['FRANCE':CHAR(7), 'GERMANY']:CHAR(7))])
                            JdbcTableScan(table=[[public, nation]])
                LogicalAggregate(group=[{0}])
                  LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                    LogicalProject(inputs=[0..1])
                      JdbcTableScan(table=[[public, orders]])
                    LogicalAggregate(group=[{0}])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, customer]])
                        LogicalAggregate(group=[{0}])
                          LogicalFilter(condition=[SEARCH($1, Sarg['FRANCE':CHAR(7), 'GERMANY']:CHAR(7))])
                            JdbcTableScan(table=[[public, nation]])
        LogicalProject(inputs=[0], exprs=[[$2, $4, $5]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3]])
              JdbcTableScan(table=[[public, supplier]])
            LogicalProject(inputs=[0], exprs=[[$3, $4, $5]])
              LogicalJoin(condition=[=($2, $1)], joinType=[inner])
                LogicalProject(inputs=[0..1])
                  JdbcTableScan(table=[[public, orders]])
                LogicalProject(inputs=[0], exprs=[[$2, $3, $5]])
                  LogicalJoin(condition=[=($1, $4)], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$3]])
                      JdbcTableScan(table=[[public, customer]])
                    LogicalProject(inputs=[0..1], exprs=[[$4, $5]])
                      LogicalJoin(condition=[OR(AND($2, $6), AND($3, $7))], joinType=[inner])
                        LogicalProject(inputs=[0..1], exprs=[[=($1, 'GERMANY                  '), =($1, 'FRANCE                   ')]])
                          JdbcTableScan(table=[[public, nation]])
                        LogicalProject(inputs=[0..1], exprs=[[=($1, 'FRANCE                   '), =($1, 'GERMANY                  ')]])
                          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC])
  LogicalAggregate(group=[{4, 5, 6}], revenue=[SUM($7)])
    LogicalJoin(condition=[AND(=($1, $3), =($0, $2))], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[$3]])
        JdbcTableScan(table=[[public, supplier]])
      LogicalProject(inputs=[0], exprs=[[$2, $3, $9, $4, $5]])
        LogicalJoin(condition=[AND(=($1, $8), OR(AND($6, $10), AND($7, $11)))], joinType=[inner])
          LogicalProject(inputs=[0..1], exprs=[[$4, $5, $2, $3, $6, $7]])
            LogicalJoin(condition=[true], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$5, $2, $3]])
                LogicalJoin(condition=[=($1, $4)], joinType=[inner])
                  LogicalProject(exprs=[[$1, $5, $2, $3]])
                    LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$2, EXTRACT(FLAG(YEAR), $10), *($5, -(1, $6))]])
                        LogicalFilter(condition=[SEARCH($10, Sarg[[1995-01-01..1996-12-31]])])
                          JdbcTableScan(table=[[public, lineitem]])
                      LogicalProject(inputs=[0..1])
                        JdbcTableScan(table=[[public, orders]])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, customer]])
              LogicalProject(inputs=[0..1], exprs=[[=($1, 'GERMANY                  '), =($1, 'FRANCE                   ')]])
                JdbcTableScan(table=[[public, nation]])
          LogicalProject(inputs=[0..1], exprs=[[=($1, 'FRANCE                   '), =($1, 'GERMANY                  ')]])
            JdbcTableScan(table=[[public, nation]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN96
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: []
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0], exprs=[[/($1, $2)]])
    LogicalAggregate(group=[{2}], agg#0=[SUM($3)], agg#1=[SUM($4)])
      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($4, 'ECONOMY ANODIZED STEEL')])
            JdbcTableScan(table=[[public, part]])
        LogicalProject(exprs=[[$2, $5, $6, $7]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3]])
              JdbcTableScan(table=[[public, supplier]])
            LogicalProject(exprs=[[$1, $2, $5, $6, CASE($7, $3, 0:DECIMAL(19, 4)), $3]])
              LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                LogicalProject(inputs=[0..2], exprs=[[*($5, -(1, $6))]])
                  JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0], exprs=[[$4, $2, $5]])
                  LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                    LogicalProject(inputs=[0..1], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
                      LogicalFilter(condition=[SEARCH($4, Sarg[[1995-01-01..1996-12-31]])])
                        LogicalFilter(condition=[SEARCH($4, Sarg[[1995-01-01..1996-12-31]])])
                          JdbcTableScan(table=[[public, orders]])
                    LogicalProject(inputs=[0], exprs=[[$3, $4]])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, customer]])
                        LogicalProject(inputs=[0], exprs=[[$2, $4]])
                          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                            LogicalProject(inputs=[0], exprs=[[$2]])
                              JdbcTableScan(table=[[public, nation]])
                            LogicalProject(inputs=[0], exprs=[[$2, $1]])
                              LogicalJoin(condition=[true], joinType=[inner])
                                LogicalProject(inputs=[0], exprs=[[=($1, 'INDIA                    ')]])
                                  JdbcTableScan(table=[[public, nation]])
                                LogicalProject(inputs=[0])
                                  LogicalFilter(condition=[=($1, 'ASIA')])
                                    JdbcTableScan(table=[[public, region]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0], exprs=[[/($1, $2)]])
    LogicalAggregate(group=[{2}], agg#0=[SUM($3)], agg#1=[SUM($4)])
      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($4, 'ECONOMY ANODIZED STEEL')])
            JdbcTableScan(table=[[public, part]])
        LogicalProject(exprs=[[$2, $5, $6, $7]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3]])
              JdbcTableScan(table=[[public, supplier]])
            LogicalProject(exprs=[[$1, $2, $5, $6, CASE($7, $3, 0:DECIMAL(19, 4)), $3]])
              LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                LogicalProject(inputs=[0..2], exprs=[[*($5, -(1, $6))]])
                  JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0], exprs=[[$4, $2, $5]])
                  LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                    LogicalProject(inputs=[0..1], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
                      LogicalFilter(condition=[SEARCH($4, Sarg[[1995-01-01..1996-12-31]])])
                        JdbcTableScan(table=[[public, orders]])
                    LogicalProject(inputs=[0], exprs=[[$3, $4]])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, customer]])
                        LogicalProject(inputs=[0], exprs=[[$2, $4]])
                          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                            LogicalProject(inputs=[0], exprs=[[$2]])
                              JdbcTableScan(table=[[public, nation]])
                            LogicalProject(inputs=[0], exprs=[[$2, $1]])
                              LogicalJoin(condition=[true], joinType=[inner])
                                LogicalProject(inputs=[0], exprs=[[=($1, 'INDIA                    ')]])
                                  JdbcTableScan(table=[[public, nation]])
                                LogicalProject(inputs=[0])
                                  LogicalFilter(condition=[=($1, 'ASIA')])
                                    JdbcTableScan(table=[[public, region]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0], exprs=[[/($1, $2)]])
    LogicalAggregate(group=[{2}], agg#0=[SUM($3)], agg#1=[SUM($4)])
      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($4, 'ECONOMY ANODIZED STEEL')])
            JdbcTableScan(table=[[public, part]])
        LogicalProject(exprs=[[$2, $5, $6, $7]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3]])
              JdbcTableScan(table=[[public, supplier]])
            LogicalProject(exprs=[[$1, $2, $5, $6, CASE($7, $3, 0:DECIMAL(19, 4)), $3]])
              LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                LogicalProject(inputs=[0..2], exprs=[[*($5, -(1, $6))]])
                  JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0], exprs=[[$4, $2, $5]])
                  LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                    LogicalProject(inputs=[0..1], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
                      LogicalFilter(condition=[SEARCH($4, Sarg[[1995-01-01..1996-12-31]])])
                        LogicalFilter(condition=[SEARCH($4, Sarg[[1995-01-01..1996-12-31]])])
                          JdbcTableScan(table=[[public, orders]])
                    LogicalProject(inputs=[0], exprs=[[$3, $4]])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, customer]])
                        LogicalProject(inputs=[0], exprs=[[$2, $4]])
                          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                            LogicalProject(inputs=[0], exprs=[[$2]])
                              JdbcTableScan(table=[[public, nation]])
                            LogicalProject(inputs=[0], exprs=[[$2, $1]])
                              LogicalJoin(condition=[true], joinType=[inner])
                                LogicalProject(inputs=[0], exprs=[[=($1, 'INDIA                    ')]])
                                  JdbcTableScan(table=[[public, nation]])
                                LogicalProject(inputs=[0])
                                  LogicalFilter(condition=[=($1, 'ASIA')])
                                    JdbcTableScan(table=[[public, region]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0], exprs=[[/($1, $2)]])
    LogicalAggregate(group=[{2}], agg#0=[SUM($3)], agg#1=[SUM($4)])
      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($4, 'ECONOMY ANODIZED STEEL')])
            JdbcTableScan(table=[[public, part]])
        LogicalProject(exprs=[[$2, $5, $6, $7]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3]])
              JdbcTableScan(table=[[public, supplier]])
            LogicalProject(exprs=[[$1, $2, $5, $6, CASE($7, $3, 0:DECIMAL(19, 4)), $3]])
              LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                LogicalProject(inputs=[0..2], exprs=[[*($5, -(1, $6))]])
                  JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0], exprs=[[$4, $2, $5]])
                  LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                    LogicalProject(inputs=[0..1], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
                      LogicalFilter(condition=[SEARCH($4, Sarg[[1995-01-01..1996-12-31]])])
                        JdbcTableScan(table=[[public, orders]])
                    LogicalProject(inputs=[0], exprs=[[$3, $4]])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, customer]])
                        LogicalProject(inputs=[0], exprs=[[$2, $4]])
                          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                            LogicalProject(inputs=[0], exprs=[[$2]])
                              JdbcTableScan(table=[[public, nation]])
                            LogicalProject(inputs=[0], exprs=[[$2, $1]])
                              LogicalJoin(condition=[true], joinType=[inner])
                                LogicalProject(inputs=[0], exprs=[[=($1, 'INDIA                    ')]])
                                  JdbcTableScan(table=[[public, nation]])
                                LogicalProject(inputs=[0])
                                  LogicalFilter(condition=[=($1, 'ASIA')])
                                    JdbcTableScan(table=[[public, region]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): []
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0], exprs=[[/($1, $2)]])
    LogicalAggregate(group=[{2}], agg#0=[SUM($3)], agg#1=[SUM($4)])
      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($4, 'ECONOMY ANODIZED STEEL')])
            JdbcTableScan(table=[[public, part]])
        LogicalProject(exprs=[[$2, $5, $6, $7]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3]])
              JdbcTableScan(table=[[public, supplier]])
            LogicalProject(exprs=[[$1, $2, $5, $6, CASE($7, $3, 0:DECIMAL(19, 4)), $3]])
              LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                LogicalProject(inputs=[0..2], exprs=[[*($5, -(1, $6))]])
                  JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0], exprs=[[$4, $2, $5]])
                  LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                    LogicalProject(inputs=[0..1], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
                      LogicalFilter(condition=[SEARCH($4, Sarg[[1995-01-01..1996-12-31]])])
                        LogicalFilter(condition=[SEARCH($4, Sarg[[1995-01-01..1996-12-31]])])
                          JdbcTableScan(table=[[public, orders]])
                    LogicalProject(inputs=[0], exprs=[[$3, $4]])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, customer]])
                        LogicalProject(inputs=[0], exprs=[[$2, $4]])
                          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                            LogicalProject(inputs=[0], exprs=[[$2]])
                              JdbcTableScan(table=[[public, nation]])
                            LogicalProject(inputs=[0], exprs=[[$2, $1]])
                              LogicalJoin(condition=[true], joinType=[inner])
                                LogicalProject(inputs=[0], exprs=[[=($1, 'INDIA                    ')]])
                                  JdbcTableScan(table=[[public, nation]])
                                LogicalProject(inputs=[0])
                                  LogicalFilter(condition=[=($1, 'ASIA')])
                                    JdbcTableScan(table=[[public, region]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0], exprs=[[/($1, $2)]])
    LogicalAggregate(group=[{2}], agg#0=[SUM($3)], agg#1=[SUM($4)])
      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($4, 'ECONOMY ANODIZED STEEL')])
            JdbcTableScan(table=[[public, part]])
        LogicalProject(exprs=[[$2, $5, $6, $7]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3]])
              JdbcTableScan(table=[[public, supplier]])
            LogicalProject(exprs=[[$1, $2, $5, $6, CASE($7, $3, 0:DECIMAL(19, 4)), $3]])
              LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                LogicalProject(inputs=[0..2], exprs=[[*($5, -(1, $6))]])
                  JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0], exprs=[[$4, $2, $5]])
                  LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                    LogicalProject(inputs=[0..1], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
                      LogicalFilter(condition=[SEARCH($4, Sarg[[1995-01-01..1996-12-31]])])
                        JdbcTableScan(table=[[public, orders]])
                    LogicalProject(inputs=[0], exprs=[[$3, $4]])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, customer]])
                        LogicalProject(inputs=[0], exprs=[[$2, $4]])
                          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                            LogicalProject(inputs=[0], exprs=[[$2]])
                              JdbcTableScan(table=[[public, nation]])
                            LogicalProject(inputs=[0], exprs=[[$2, $1]])
                              LogicalJoin(condition=[true], joinType=[inner])
                                LogicalProject(inputs=[0], exprs=[[=($1, 'INDIA                    ')]])
                                  JdbcTableScan(table=[[public, nation]])
                                LogicalProject(inputs=[0])
                                  LogicalFilter(condition=[=($1, 'ASIA                     ')])
                                    JdbcTableScan(table=[[public, region]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Project[$x,DIVIDE($x,$x)]->Aggregate(groups=[o_year], calls=[SUM($f1), SUM(volume)])->Join(INNER,=($x,$x)&=($x,'ECONOMY ANODIZED STEEL')){Project[$x,$x,$x,$x,CASE($x,$x,0:DECIMAL(19, 4)),$x]->Join(INNER,=($x,$x)&=($x,'ASIA')){Project[$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,EXTRACT(FLAG(YEAR),$x)]->Filter(RANGE($x,1995-01-01,1996-12-31))->Scan(public.orders)|Project[$x,=($x,'INDIA')]->Scan(public.nation)|Scan(public.customer)|Scan(public.nation)|Scan(public.region)}|Scan(public.part)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0], exprs=[[/($1, $2)]])
    LogicalAggregate(group=[{2}], agg#0=[SUM($3)], agg#1=[SUM($4)])
      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($4, 'ECONOMY ANODIZED STEEL')])
            JdbcTableScan(table=[[public, part]])
        LogicalProject(exprs=[[$2, $5, $6, $7]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3]])
              JdbcTableScan(table=[[public, supplier]])
            LogicalProject(exprs=[[$1, $2, $5, $6, CASE($7, $3, 0:DECIMAL(19, 4)), $3]])
              LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                LogicalProject(inputs=[0..2], exprs=[[*($5, -(1, $6))]])
                  JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0], exprs=[[$4, $2, $5]])
                  LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                    LogicalProject(inputs=[0..1], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
                      LogicalFilter(condition=[SEARCH($4, Sarg[[1995-01-01..1996-12-31]])])
                        LogicalFilter(condition=[SEARCH($4, Sarg[[1995-01-01..1996-12-31]])])
                          JdbcTableScan(table=[[public, orders]])
                    LogicalProject(inputs=[0], exprs=[[$3, $4]])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, customer]])
                        LogicalProject(inputs=[0], exprs=[[$2, $4]])
                          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                            LogicalProject(inputs=[0], exprs=[[$2]])
                              JdbcTableScan(table=[[public, nation]])
                            LogicalProject(inputs=[0], exprs=[[$2, $1]])
                              LogicalJoin(condition=[true], joinType=[inner])
                                LogicalProject(inputs=[0], exprs=[[=($1, 'INDIA                    ')]])
                                  JdbcTableScan(table=[[public, nation]])
                                LogicalProject(inputs=[0])
                                  LogicalFilter(condition=[=($1, 'ASIA')])
                                    JdbcTableScan(table=[[public, region]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0], exprs=[[/($1, $2)]])
    LogicalAggregate(group=[{2}], agg#0=[SUM($3)], agg#1=[SUM($4)])
      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($4, 'ECONOMY ANODIZED STEEL')])
            JdbcTableScan(table=[[public, part]])
        LogicalProject(exprs=[[$2, $5, $6, $7]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$3]])
              JdbcTableScan(table=[[public, supplier]])
            LogicalProject(exprs=[[$1, $2, $5, $6, CASE($7, $3, 0:DECIMAL(19, 4)), $3]])
              LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                LogicalProject(inputs=[0..2], exprs=[[*($5, -(1, $6))]])
                  JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0], exprs=[[$4, $2, $5]])
                  LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                    LogicalProject(inputs=[0..1], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
                      LogicalFilter(condition=[SEARCH($4, Sarg[[1995-01-01..1996-12-31]])])
                        JdbcTableScan(table=[[public, orders]])
                    LogicalProject(inputs=[0], exprs=[[$3, $4]])
                      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, customer]])
                        LogicalProject(inputs=[0], exprs=[[$2, $4]])
                          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                            LogicalProject(inputs=[0], exprs=[[$2]])
                              JdbcTableScan(table=[[public, nation]])
                            LogicalProject(inputs=[0], exprs=[[$2, $1]])
                              LogicalJoin(condition=[true], joinType=[inner])
                                LogicalProject(inputs=[0], exprs=[[=($1, 'INDIA                    ')]])
                                  JdbcTableScan(table=[[public, nation]])
                                LogicalProject(inputs=[0])
                                  LogicalFilter(condition=[=($1, 'ASIA                     ')])
                                    JdbcTableScan(table=[[public, region]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN97
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinAddRedundantSemiJoinRule, SemiJoinRule.JoinToSemiJoinRule, SemiJoinJoinTransposeRule]
[Calcite.convertRelNodetoJSONQueryPlan] Error while obtaining plan: ERROR: missing FROM-clause entry for table "t3"
  Position: 865
[Calcite.convertRelNodetoJSONQueryPlan] Generated SQL (preview):
SELECT "t13"."n_name", "t12"."o_year", SUM("t12"."amount") AS "sum_profit"
FROM (SELECT "t10"."s_nationkey", "t11"."o_year", "t10"."amount"
FROM (SELECT "t8"."s_nationkey", "t8"."l_orderkey", "t8"."EXPR$0" - "t9"."ps_supplycost" * "t8"."l_quantity" AS "amount"
FROM (SELECT "t30"."s_nationkey", "t500"."l_orderkey", "t500"."l_partkey", "t500"."l_suppkey", "t500"."l_quantity", "t500"."EXPR$0"
FROM (SELECT *
FROM (SELECT "p_partkey"
FROM "public"."part"
WHERE "p_name" LIKE 'co%') AS "t0"
CROSS JOIN (SELECT "s_suppkey", "s_nationkey"
FROM "public"."supplier") AS "t1"
WHERE EXISTS (SELECT 1
FROM (SELECT "l_partkey", "l_suppkey"
FROM "public"."lineitem") AS "t2"
WHERE "t1"."s_suppkey" = "t2"."l_suppkey" AND "t0"."p_partkey" = "t2"."l_partkey") AND EXISTS (SELECT 1
FROM (SELECT "n_nationkey"
FROM "public"."nation") AS "t4"
WHERE "t3"."s_nationkey" = "t4"."n_nationkey")) AS "t30"
INNER JOIN (SELECT *
FROM (SELECT "l_orderkey", "l_partkey", "l_suppkey", "l_quantity", "l_extendedprice" * (1 - "l_discount") AS "EXPR$0"
FROM "public"."lineitem"
WHERE EXISTS (SELECT 1
FROM (SELECT "ps_partkey", "ps_suppkey"
FROM "public"."partsupp") AS "t6"
WHERE "l_suppkey" = "t6"."ps_suppkey" AND "l_partkey" = "t6"."ps_partkey")) AS "t5"
WHERE EXISTS (SELECT 1
FROM (SELECT "o_orderkey"
FROM "public"."orders") AS "t7"
WHERE "t50"."l_orderkey" = "t7"."o_orderkey")) AS "t500" ON "t30"."s_suppkey" = "t500"."l_suppkey" AND "t30"."p_partkey" = "t500"."l_partkey") AS "t8"
INNER JOIN (SELECT "ps_partkey", "ps_suppkey", "ps_supplycost"
FROM "public"."partsupp") AS "t9" ON "t8"."l_suppkey" = "t9"."ps_suppkey" AND "t8"."l_partkey" = "t9"."ps_partkey") AS "t10"
INNER JOIN (SELECT "o_orderkey", EXTRACT(YEAR FROM "o_orderdate") AS "o_year"
FROM "public"."orders") AS "t11" ON "t10"."l_orderkey" = "t11"."o_orderkey") AS "t12"
INNER JOIN (SELECT "n_nationkey", "n_name"
FROM "public"."nation") AS "t13" ON "t12"."s_nationkey" = "t13"."n_nationkey"
GROUP BY "t12"."o_year", "t13"."n_name"
ORDER BY "t13"."n_name", " ...[truncated]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)|Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)|Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)|Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)|Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner], semiJoinDone=[true])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner], semiJoinDone=[true])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner], semiJoinDone=[true])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner], semiJoinDone=[true])
                    LogicalJoin(condition=[=($2, $3)], joinType=[semi])
                      LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[semi])
                        LogicalJoin(condition=[true], joinType=[inner])
                          LogicalProject(inputs=[0])
                            LogicalFilter(condition=[LIKE($1, 'co%')])
                              JdbcTableScan(table=[[public, part]])
                          LogicalProject(inputs=[0], exprs=[[$3]])
                            JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(exprs=[[$1, $2]])
                          JdbcTableScan(table=[[public, lineitem]])
                      LogicalProject(inputs=[0])
                        JdbcTableScan(table=[[public, nation]])
                    LogicalJoin(condition=[=($5, $0)], joinType=[semi])
                      LogicalJoin(condition=[AND(=($6, $2), =($5, $1))], joinType=[semi])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                        LogicalProject(inputs=[0..1])
                          JdbcTableScan(table=[[public, partsupp]])
                      LogicalProject(inputs=[0])
                        JdbcTableScan(table=[[public, orders]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                  LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                      LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          LogicalJoin(condition=[=($1, $16)], joinType=[inner])
                            LogicalProject(inputs=[0..15])
                              LogicalJoin(condition=[=($2, $16)], joinType=[inner])
                                JdbcTableScan(table=[[public, lineitem]])
                                LogicalAggregate(group=[{0}])
                                  LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                                    LogicalProject(inputs=[0], exprs=[[$3]])
                                      JdbcTableScan(table=[[public, supplier]])
                                    LogicalAggregate(group=[{0}])
                                      JdbcTableScan(table=[[public, nation]])
                            LogicalAggregate(group=[{0}])
                              LogicalFilter(condition=[LIKE($1, 'co%')])
                                JdbcTableScan(table=[[public, part]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [JoinAddRedundantSemiJoinRule, JoinAddRedundantSemiJoinRule, SemiJoinJoinTransposeRule, JoinAssociateRule]
[Calcite.convertRelNodetoJSONQueryPlan] Error while obtaining plan: ERROR: missing FROM-clause entry for table "t3"
  Position: 865
[Calcite.convertRelNodetoJSONQueryPlan] Generated SQL (preview):
SELECT "t13"."n_name", "t12"."o_year", SUM("t12"."amount") AS "sum_profit"
FROM (SELECT "t10"."s_nationkey", "t11"."o_year", "t10"."amount"
FROM (SELECT "t8"."s_nationkey", "t8"."l_orderkey", "t8"."EXPR$0" - "t9"."ps_supplycost" * "t8"."l_quantity" AS "amount"
FROM (SELECT "t30"."s_nationkey", "t500"."l_orderkey", "t500"."l_partkey", "t500"."l_suppkey", "t500"."l_quantity", "t500"."EXPR$0"
FROM (SELECT *
FROM (SELECT "p_partkey"
FROM "public"."part"
WHERE "p_name" LIKE 'co%') AS "t0"
CROSS JOIN (SELECT "s_suppkey", "s_nationkey"
FROM "public"."supplier") AS "t1"
WHERE EXISTS (SELECT 1
FROM (SELECT "l_partkey", "l_suppkey"
FROM "public"."lineitem") AS "t2"
WHERE "t1"."s_suppkey" = "t2"."l_suppkey" AND "t0"."p_partkey" = "t2"."l_partkey") AND EXISTS (SELECT 1
FROM (SELECT "n_nationkey"
FROM "public"."nation") AS "t4"
WHERE "t3"."s_nationkey" = "t4"."n_nationkey")) AS "t30"
INNER JOIN (SELECT *
FROM (SELECT "l_orderkey", "l_partkey", "l_suppkey", "l_quantity", "l_extendedprice" * (1 - "l_discount") AS "EXPR$0"
FROM "public"."lineitem"
WHERE EXISTS (SELECT 1
FROM (SELECT "ps_partkey", "ps_suppkey"
FROM "public"."partsupp") AS "t6"
WHERE "l_suppkey" = "t6"."ps_suppkey" AND "l_partkey" = "t6"."ps_partkey")) AS "t5"
WHERE EXISTS (SELECT 1
FROM (SELECT "o_orderkey"
FROM "public"."orders") AS "t7"
WHERE "t50"."l_orderkey" = "t7"."o_orderkey")) AS "t500" ON "t30"."s_suppkey" = "t500"."l_suppkey" AND "t30"."p_partkey" = "t500"."l_partkey") AS "t8"
INNER JOIN (SELECT "ps_partkey", "ps_suppkey", "ps_supplycost"
FROM "public"."partsupp") AS "t9" ON "t8"."l_suppkey" = "t9"."ps_suppkey" AND "t8"."l_partkey" = "t9"."ps_partkey") AS "t10"
INNER JOIN (SELECT "o_orderkey", EXTRACT(YEAR FROM "o_orderdate") AS "o_year"
FROM "public"."orders") AS "t11" ON "t10"."l_orderkey" = "t11"."o_orderkey") AS "t12"
INNER JOIN (SELECT "n_nationkey", "n_name"
FROM "public"."nation") AS "t13" ON "t12"."s_nationkey" = "t13"."n_nationkey"
GROUP BY "t12"."o_year", "t13"."n_name"
ORDER BY "t13"."n_name", " ...[truncated]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)|Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)|Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Project[$x*]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)|Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)|Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}}}|Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)|Join(INNER,=($x,$x)){Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Join(INNER,LIKE($x,'co%')){Scan(public.part)|Scan(public.supplier)}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.lineitem)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.nation)}|Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Scan(public.partsupp)}|Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.orders)}|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner], semiJoinDone=[true])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner], semiJoinDone=[true])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner], semiJoinDone=[true])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner], semiJoinDone=[true])
                    LogicalJoin(condition=[=($2, $3)], joinType=[semi])
                      LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[semi])
                        LogicalJoin(condition=[true], joinType=[inner])
                          LogicalProject(inputs=[0])
                            LogicalFilter(condition=[LIKE($1, 'co%')])
                              JdbcTableScan(table=[[public, part]])
                          LogicalProject(inputs=[0], exprs=[[$3]])
                            JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(exprs=[[$1, $2]])
                          JdbcTableScan(table=[[public, lineitem]])
                      LogicalProject(inputs=[0])
                        JdbcTableScan(table=[[public, nation]])
                    LogicalJoin(condition=[=($5, $0)], joinType=[semi])
                      LogicalJoin(condition=[AND(=($6, $2), =($5, $1))], joinType=[semi])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                        LogicalProject(inputs=[0..1])
                          JdbcTableScan(table=[[public, partsupp]])
                      LogicalProject(inputs=[0])
                        JdbcTableScan(table=[[public, orders]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                  LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                      LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          LogicalJoin(condition=[=($1, $16)], joinType=[inner])
                            LogicalProject(inputs=[0..15])
                              LogicalJoin(condition=[=($2, $16)], joinType=[inner])
                                JdbcTableScan(table=[[public, lineitem]])
                                LogicalAggregate(group=[{0}])
                                  LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                                    LogicalProject(inputs=[0], exprs=[[$3]])
                                      JdbcTableScan(table=[[public, supplier]])
                                    LogicalAggregate(group=[{0}])
                                      JdbcTableScan(table=[[public, nation]])
                            LogicalAggregate(group=[{0}])
                              LogicalFilter(condition=[LIKE($1, 'co%')])
                                JdbcTableScan(table=[[public, part]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [SemiJoinRemoveRule, JoinPushTransitivePredicatesRule, JoinAssociateRule, FilterJoinRule.JoinConditionPushRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(exprs=[[$1, $2, $4]])
              LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                LogicalProject(inputs=[0])
                  LogicalJoin(condition=[=($0, $9)], joinType=[inner])
                    LogicalFilter(condition=[LIKE($1, 'co%')])
                      JdbcTableScan(table=[[public, part]])
                    LogicalAggregate(group=[{0}])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                LogicalProject(exprs=[[$1, $2, $3, $5]])
                  LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$3]])
                      LogicalJoin(condition=[=($0, $7)], joinType=[inner])
                        JdbcTableScan(table=[[public, supplier]])
                        LogicalAggregate(group=[{0}])
                          LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                            LogicalProject(inputs=[0], exprs=[[$3]])
                              JdbcTableScan(table=[[public, supplier]])
                            LogicalAggregate(group=[{0}])
                              JdbcTableScan(table=[[public, nation]])
                    LogicalProject(inputs=[0..2], exprs=[[-($4, *($7, $3))]])
                      LogicalJoin(condition=[AND(=($6, $2), =($5, $1))], joinType=[inner])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          LogicalJoin(condition=[=($1, $16)], joinType=[inner])
                            LogicalProject(inputs=[0..15])
                              LogicalJoin(condition=[=($2, $16)], joinType=[inner])
                                JdbcTableScan(table=[[public, lineitem]])
                                LogicalAggregate(group=[{0}])
                                  LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                                    LogicalProject(inputs=[0], exprs=[[$3]])
                                      JdbcTableScan(table=[[public, supplier]])
                                    LogicalAggregate(group=[{0}])
                                      JdbcTableScan(table=[[public, nation]])
                            LogicalAggregate(group=[{0}])
                              LogicalFilter(condition=[LIKE($1, 'co%')])
                                JdbcTableScan(table=[[public, part]])
                        LogicalProject(inputs=[0..1], exprs=[[$3]])
                          LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                            LogicalProject(inputs=[0..4])
                              LogicalJoin(condition=[=($1, $5)], joinType=[inner])
                                JdbcTableScan(table=[[public, partsupp]])
                                LogicalAggregate(group=[{0}])
                                  LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                                    LogicalProject(inputs=[0], exprs=[[$3]])
                                      JdbcTableScan(table=[[public, supplier]])
                                    LogicalAggregate(group=[{0}])
                                      JdbcTableScan(table=[[public, nation]])
                            LogicalAggregate(group=[{0}])
                              LogicalFilter(condition=[LIKE($1, 'co%')])
                                JdbcTableScan(table=[[public, part]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [SemiJoinRemoveRule, FilterJoinRule.FilterIntoJoinRule, JoinToMultiJoinRule, MultiJoinOptimizeBushyRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.part)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.part)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.part)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.part)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.part)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.part)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.part)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.part)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.part)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.part)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.part)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.part)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.part)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Project[$x,$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.partsupp)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$3, $7, $8, $9, $11, *($12, -(1, $13))]])
                  LogicalJoin(condition=[=($23, $8)], joinType=[inner])
                    LogicalProject(exprs=[[$16, $17, $18, $19, $20, $21, $22, $0, $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15]])
                      LogicalJoin(condition=[=($16, $2)], joinType=[inner])
                        LogicalProject(inputs=[0..15])
                          LogicalJoin(condition=[=($1, $16)], joinType=[inner])
                            LogicalProject(inputs=[0..15])
                              LogicalJoin(condition=[=($2, $16)], joinType=[inner])
                                JdbcTableScan(table=[[public, lineitem]])
                                LogicalAggregate(group=[{0}])
                                  LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                                    LogicalProject(inputs=[0], exprs=[[$3]])
                                      JdbcTableScan(table=[[public, supplier]])
                                    LogicalAggregate(group=[{0}])
                                      JdbcTableScan(table=[[public, nation]])
                            LogicalAggregate(group=[{0}])
                              LogicalFilter(condition=[LIKE($1, 'co%')])
                                JdbcTableScan(table=[[public, part]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalFilter(condition=[LIKE($1, 'co%')])
                      JdbcTableScan(table=[[public, part]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$2, $3, $4, $5, $6, $7]])
                  LogicalJoin(condition=[AND(=($1, $5), =($0, $4))], joinType=[inner])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalProject(inputs=[0])
                        LogicalFilter(condition=[LIKE($1, 'co%')])
                          JdbcTableScan(table=[[public, part]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                      JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinAssociateRule, JoinAddRedundantSemiJoinRule, JoinAddRedundantSemiJoinRule, SemiJoinJoinTransposeRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [SemiJoinRemoveRule, JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($7, $3), =($6, $2))], joinType=[inner])
                LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                  LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                      LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          LogicalJoin(condition=[=($1, $16)], joinType=[inner])
                            LogicalProject(inputs=[0..15])
                              LogicalJoin(condition=[=($2, $16)], joinType=[inner])
                                JdbcTableScan(table=[[public, lineitem]])
                                LogicalAggregate(group=[{0}])
                                  LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                                    LogicalProject(inputs=[0], exprs=[[$3]])
                                      JdbcTableScan(table=[[public, supplier]])
                                    LogicalAggregate(group=[{0}])
                                      JdbcTableScan(table=[[public, nation]])
                            LogicalAggregate(group=[{0}])
                              LogicalFilter(condition=[LIKE($1, 'co%')])
                                JdbcTableScan(table=[[public, part]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($3, $7), =($2, $6))], joinType=[inner])
                LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                  LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                      LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [FilterJoinRule.FilterIntoJoinRule, SemiJoinRemoveRule, JoinPushTransitivePredicatesRule, JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.nation)|Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.supplier)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.part)|Scan(public.supplier)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[n_name, o_year], calls=[SUM(amount)])->Join(INNER,=($x,$x)){Project[$x,$x,MINUS($x,TIMES($x,$x))]->Join(INNER,=($x,$x)&LIKE($x,'co%')){Project[$x,$x,$x,$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Project[$x,EXTRACT(FLAG(YEAR),$x)]->Scan(public.orders)|Scan(public.nation)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($3, $1)], joinType=[inner])
            LogicalProject(exprs=[[$1, $2, $4]])
              LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                LogicalProject(inputs=[0])
                  LogicalJoin(condition=[=($0, $9)], joinType=[inner])
                    LogicalFilter(condition=[LIKE($1, 'co%')])
                      JdbcTableScan(table=[[public, part]])
                    LogicalAggregate(group=[{0}])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                LogicalProject(exprs=[[$1, $2, $3, $5]])
                  LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$3]])
                      LogicalJoin(condition=[=($0, $7)], joinType=[inner])
                        JdbcTableScan(table=[[public, supplier]])
                        LogicalAggregate(group=[{0}])
                          LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                            LogicalProject(inputs=[0], exprs=[[$3]])
                              JdbcTableScan(table=[[public, supplier]])
                            LogicalAggregate(group=[{0}])
                              JdbcTableScan(table=[[public, nation]])
                    LogicalProject(inputs=[0..2], exprs=[[-($4, *($7, $3))]])
                      LogicalJoin(condition=[AND(=($6, $2), =($5, $1))], joinType=[inner])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          LogicalJoin(condition=[=($1, $16)], joinType=[inner])
                            LogicalProject(inputs=[0..15])
                              LogicalJoin(condition=[=($2, $16)], joinType=[inner])
                                JdbcTableScan(table=[[public, lineitem]])
                                LogicalAggregate(group=[{0}])
                                  LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                                    LogicalProject(inputs=[0], exprs=[[$3]])
                                      JdbcTableScan(table=[[public, supplier]])
                                    LogicalAggregate(group=[{0}])
                                      JdbcTableScan(table=[[public, nation]])
                            LogicalAggregate(group=[{0}])
                              LogicalFilter(condition=[LIKE($1, 'co%')])
                                JdbcTableScan(table=[[public, part]])
                        LogicalProject(inputs=[0..1], exprs=[[$3]])
                          LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                            LogicalProject(inputs=[0..4])
                              LogicalJoin(condition=[=($1, $5)], joinType=[inner])
                                JdbcTableScan(table=[[public, partsupp]])
                                LogicalAggregate(group=[{0}])
                                  LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                                    LogicalProject(inputs=[0], exprs=[[$3]])
                                      JdbcTableScan(table=[[public, supplier]])
                                    LogicalAggregate(group=[{0}])
                                      JdbcTableScan(table=[[public, nation]])
                            LogicalAggregate(group=[{0}])
                              LogicalFilter(condition=[LIKE($1, 'co%')])
                                JdbcTableScan(table=[[public, part]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], sort1=[$1], dir0=[ASC], dir1=[DESC])
  LogicalProject(exprs=[[$1, $0, $2]])
    LogicalAggregate(group=[{1, 4}], sum_profit=[SUM($2)])
      LogicalJoin(condition=[=($0, $3)], joinType=[inner])
        LogicalProject(inputs=[0], exprs=[[$4, $2]])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[-($5, *($8, $4))]])
              LogicalJoin(condition=[AND(=($3, $7), =($2, $6))], joinType=[inner])
                LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                  LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[LIKE($1, 'co%')])
                        JdbcTableScan(table=[[public, part]])
                    LogicalProject(exprs=[[$1, $2, $3, $4, $5, $6]])
                      LogicalJoin(condition=[=($0, $4)], joinType=[inner])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                        LogicalProject(inputs=[0..2], exprs=[[$4, *($5, -(1, $6))]])
                          JdbcTableScan(table=[[public, lineitem]])
                LogicalProject(inputs=[0..1], exprs=[[$3]])
                  JdbcTableScan(table=[[public, partsupp]])
            LogicalProject(inputs=[0], exprs=[[EXTRACT(FLAG(YEAR), $4)]])
              JdbcTableScan(table=[[public, orders]])
        LogicalProject(inputs=[0..1])
          JdbcTableScan(table=[[public, nation]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN98
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN99
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [SemiJoinRule.JoinOnUniqueToSemiJoinRule, SemiJoinRule.JoinOnUniqueToSemiJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..2])
    LogicalJoin(condition=[>($2, $3)], joinType=[inner])
      LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$4, $2]])
            LogicalJoin(condition=[=($1, $3)], joinType=[inner])
              LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[=($1, 'INDIA                    ')])
              JdbcTableScan(table=[[public, nation]])
      LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
        LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
          LogicalAggregate(group=[{}], agg#0=[SUM($1)])
            LogicalJoin(condition=[=($0, $2)], joinType=[inner])
              LogicalProject(exprs=[[$3, $1]])
                LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                  LogicalProject(exprs=[[$1, *($3, $2)]])
                    JdbcTableScan(table=[[public, partsupp]])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[=($1, 'INDIA                    ')])
                  JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..2])
    LogicalJoin(condition=[>($2, $3)], joinType=[inner])
      LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
            LogicalJoin(condition=[=($1, $5)], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalAggregate(group=[{0}])
                LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
                  LogicalAggregate(group=[{0}])
                    LogicalFilter(condition=[=($1, 'INDIA                    ')])
                      JdbcTableScan(table=[[public, nation]])
          LogicalProject(inputs=[0], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0..1])
                LogicalFilter(condition=[=($1, 'INDIA                    ')])
                  JdbcTableScan(table=[[public, nation]])
      LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
        LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
          LogicalAggregate(group=[{}], agg#0=[SUM($1)])
            LogicalJoin(condition=[=($0, $2)], joinType=[inner])
              LogicalProject(exprs=[[$1, *($3, $2)]])
                LogicalJoin(condition=[=($1, $5)], joinType=[inner])
                  JdbcTableScan(table=[[public, partsupp]])
                  LogicalAggregate(group=[{0}])
                    LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                      LogicalAggregate(group=[{0}])
                        LogicalFilter(condition=[=($1, 'INDIA                    ')])
                          JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0])
                LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'INDIA                    ')])
                      JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->B 2: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [SemiJoinJoinTransposeRule, SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..2])
    LogicalJoin(condition=[>($2, $3)], joinType=[inner])
      LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
            LogicalJoin(condition=[=($1, $5)], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalAggregate(group=[{0}])
                LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
                  LogicalAggregate(group=[{0}])
                    LogicalFilter(condition=[=($1, 'INDIA                    ')])
                      JdbcTableScan(table=[[public, nation]])
          LogicalProject(inputs=[0], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0..1])
                LogicalFilter(condition=[=($1, 'INDIA                    ')])
                  JdbcTableScan(table=[[public, nation]])
      LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
        LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
          LogicalAggregate(group=[{}], agg#0=[SUM($1)])
            LogicalJoin(condition=[=($0, $2)], joinType=[inner])
              LogicalProject(exprs=[[$1, *($3, $2)]])
                LogicalJoin(condition=[=($1, $5)], joinType=[inner])
                  JdbcTableScan(table=[[public, partsupp]])
                  LogicalAggregate(group=[{0}])
                    LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                      LogicalAggregate(group=[{0}])
                        LogicalFilter(condition=[=($1, 'INDIA                    ')])
                          JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0])
                LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'INDIA                    ')])
                      JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..2])
    LogicalJoin(condition=[>($2, $3)], joinType=[inner])
      LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$4, $2]])
            LogicalJoin(condition=[=($1, $3)], joinType=[inner])
              LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[=($1, 'INDIA                    ')])
              JdbcTableScan(table=[[public, nation]])
      LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
        LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
          LogicalAggregate(group=[{}], agg#0=[SUM($1)])
            LogicalJoin(condition=[=($0, $2)], joinType=[inner])
              LogicalProject(exprs=[[$3, $1]])
                LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                  LogicalProject(exprs=[[$1, *($3, $2)]])
                    JdbcTableScan(table=[[public, partsupp]])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[=($1, 'INDIA                    ')])
                  JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [SemiJoinRemoveRule, SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..2])
    LogicalJoin(condition=[>($2, $3)], joinType=[inner])
      LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
            LogicalJoin(condition=[=($1, $5)], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalAggregate(group=[{0}])
                LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
                  LogicalAggregate(group=[{0}])
                    LogicalFilter(condition=[=($1, 'INDIA                    ')])
                      JdbcTableScan(table=[[public, nation]])
          LogicalProject(inputs=[0], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0..1])
                LogicalFilter(condition=[=($1, 'INDIA                    ')])
                  JdbcTableScan(table=[[public, nation]])
      LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
        LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
          LogicalAggregate(group=[{}], agg#0=[SUM($1)])
            LogicalJoin(condition=[=($0, $2)], joinType=[inner])
              LogicalProject(exprs=[[$1, *($3, $2)]])
                LogicalJoin(condition=[=($1, $5)], joinType=[inner])
                  JdbcTableScan(table=[[public, partsupp]])
                  LogicalAggregate(group=[{0}])
                    LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                      LogicalAggregate(group=[{0}])
                        LogicalFilter(condition=[=($1, 'INDIA                    ')])
                          JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0])
                LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'INDIA                    ')])
                      JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..2])
    LogicalJoin(condition=[>($2, $3)], joinType=[inner])
      LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$4, $2]])
            LogicalJoin(condition=[=($1, $3)], joinType=[inner])
              LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[=($1, 'INDIA                    ')])
              JdbcTableScan(table=[[public, nation]])
      LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
        LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
          LogicalAggregate(group=[{}], agg#0=[SUM($1)])
            LogicalJoin(condition=[=($0, $2)], joinType=[inner])
              LogicalProject(exprs=[[$3, $1]])
                LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                  LogicalProject(exprs=[[$1, *($3, $2)]])
                    JdbcTableScan(table=[[public, partsupp]])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[=($1, 'INDIA                    ')])
                  JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [SemiJoinRule.JoinOnUniqueToSemiJoinRule, JoinAddRedundantSemiJoinRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): []
[Calcite.convertRelNodetoJSONQueryPlan] Error while obtaining plan: ERROR: CASE types numeric and text cannot be matched
  Position: 1498
[Calcite.convertRelNodetoJSONQueryPlan] Generated SQL (preview):
SELECT "t4"."ps_partkey", "t4"."n_name", "t4"."total_value"
FROM (SELECT "t1"."ps_partkey", "t3"."n_name", SUM("t1"."$f2") AS "total_value"
FROM (SELECT "t"."ps_partkey", "t0"."s_nationkey", "t"."$f2"
FROM (SELECT "ps_partkey", "ps_suppkey", "ps_supplycost" * "ps_availqty" AS "$f2"
FROM "public"."partsupp") AS "t"
INNER JOIN (SELECT "s_suppkey", "s_nationkey"
FROM "public"."supplier") AS "t0" ON "t"."ps_suppkey" = "t0"."s_suppkey") AS "t1"
INNER JOIN (SELECT "n_nationkey", "n_name"
FROM "public"."nation"
WHERE "n_name" = 'INDIA                    ') AS "t3" ON "t1"."s_nationkey" = "t3"."n_nationkey"
GROUP BY "t1"."ps_partkey", "t3"."n_name") AS "t4"
INNER JOIN (SELECT CASE WHEN "t13"."EXPR$0" THEN NULL WHEN "t13"."EXPR$1" THEN "t13"."$f1" ELSE "t17"."$f0" END AS "$f0"
FROM (SELECT MIN("t11"."EXPR$0") AS "$f1", COUNT("t11"."EXPR$0") = 0 AS "EXPR$0", COUNT("t11"."EXPR$0") = 1 AS "EXPR$1"
FROM (SELECT SUM("t7"."$f0") * 0.00001 AS "EXPR$0"
FROM (SELECT "t6"."s_nationkey", "t5"."$f0"
FROM (SELECT "ps_suppkey", "ps_supplycost" * "ps_availqty" AS "$f0"
FROM "public"."partsupp") AS "t5"
INNER JOIN (SELECT "s_suppkey", "s_nationkey"
FROM "public"."supplier") AS "t6" ON "t5"."ps_suppkey" = "t6"."s_suppkey") AS "t7"
INNER JOIN (SELECT "n_nationkey"
FROM "public"."nation"
WHERE "n_name" = 'INDIA                    ') AS "t9" ON "t7"."s_nationkey" = "t9"."n_nationkey") AS "t11") AS "t13"
LEFT JOIN (SELECT CASE COUNT("EXPR$0") WHEN 0 THEN NULL WHEN 1 THEN MIN("EXPR$0") ELSE (SELECT CAST(NULL AS DECIMAL(19, 7))
UNION ALL
SELECT CAST(NULL AS DECIMAL(19, 7))) END AS "$f0"
FROM (SELECT *
FROM (VALUES (NULL)) AS "t" ("EXPR$0")
UNION ALL
SELECT *
FROM (VALUES (NULL)) AS "t" ("EXPR$0")) AS "t16") AS "t17" ON TRUE) AS "t18" ON "t4"."total_value" > "t18"."$f0"
ORDER BY "t4"."total_value" DESC
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.nation)|Scan(public.supplier)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..2])
    LogicalJoin(condition=[>($2, $3)], joinType=[inner])
      LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
            LogicalJoin(condition=[=($1, $5)], joinType=[inner])
              JdbcTableScan(table=[[public, partsupp]])
              LogicalAggregate(group=[{0}])
                LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
                  LogicalAggregate(group=[{0}])
                    LogicalFilter(condition=[=($1, 'INDIA                    ')])
                      JdbcTableScan(table=[[public, nation]])
          LogicalProject(inputs=[0], exprs=[[$3]])
            LogicalJoin(condition=[=($1, $2)], joinType=[inner])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0..1])
                LogicalFilter(condition=[=($1, 'INDIA                    ')])
                  JdbcTableScan(table=[[public, nation]])
      LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
        LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
          LogicalAggregate(group=[{}], agg#0=[SUM($1)])
            LogicalJoin(condition=[=($0, $2)], joinType=[inner])
              LogicalProject(exprs=[[$1, *($3, $2)]])
                LogicalJoin(condition=[=($1, $5)], joinType=[inner])
                  JdbcTableScan(table=[[public, partsupp]])
                  LogicalAggregate(group=[{0}])
                    LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                      LogicalAggregate(group=[{0}])
                        LogicalFilter(condition=[=($1, 'INDIA                    ')])
                          JdbcTableScan(table=[[public, nation]])
              LogicalProject(inputs=[0])
                LogicalJoin(condition=[=($1, $2)], joinType=[inner])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'INDIA                    ')])
                      JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..2])
    LogicalJoin(condition=[>($2, $3)], joinType=[inner])
      LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$4, $2]])
            LogicalJoin(condition=[=($1, $3)], joinType=[inner])
              LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[=($1, 'INDIA                    ')])
              JdbcTableScan(table=[[public, nation]])
      LogicalProject(exprs=[[CASE($1, null:DECIMAL(19, 7), $2, $0, $3)]])
        LogicalJoin(condition=[true], joinType=[left])
          LogicalProject(exprs=[[$1, =($0, 0), =($0, 1)]])
            LogicalAggregate(group=[{}], agg#0=[COUNT($0)], agg#1=[MIN($0)])
              LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
                LogicalAggregate(group=[{}], agg#0=[SUM($1)])
                  LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                    LogicalProject(exprs=[[$3, $1]])
                      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                        LogicalProject(exprs=[[$1, *($3, $2)]])
                          JdbcTableScan(table=[[public, partsupp]])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'INDIA                    ')])
                        JdbcTableScan(table=[[public, nation]])
          LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
            LogicalUnion(all=[true])
              LogicalValues(type=[RecordType(DECIMAL(19, 7) EXPR$0)], tuples=[[{ null }]])
              LogicalValues(type=[RecordType(DECIMAL(19, 7) EXPR$0)], tuples=[[{ null }]])


Equivalence: false
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN100
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinAddRedundantSemiJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Project[$x*]->Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)|Scan(public.orders)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)|Scan(public.orders)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Project[$x*]->Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)|Scan(public.orders)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)|Scan(public.orders)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner], semiJoinDone=[true])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($1, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($1, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        LogicalJoin(condition=[=($0, $2)], joinType=[semi])
          LogicalProject(inputs=[0], exprs=[[$5]])
            JdbcTableScan(table=[[public, orders]])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          JdbcTableScan(table=[[public, orders]])
          LogicalAggregate(group=[{0}])
            LogicalFilter(condition=[=($14, 'SHIP      ')])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [JoinAddRedundantSemiJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Project[$x*]->Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)|Scan(public.orders)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)|Scan(public.orders)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Project[$x*]->Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)|Scan(public.orders)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)|Scan(public.orders)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Join(INNER,=($x,$x)){Scan(public.orders)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(<($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)))->Scan(public.lineitem)}|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner], semiJoinDone=[true])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($1, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($1, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        LogicalJoin(condition=[=($0, $2)], joinType=[semi])
          LogicalProject(inputs=[0], exprs=[[$5]])
            JdbcTableScan(table=[[public, orders]])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          JdbcTableScan(table=[[public, orders]])
          LogicalAggregate(group=[{0}])
            LogicalFilter(condition=[=($14, 'SHIP      ')])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          JdbcTableScan(table=[[public, orders]])
          LogicalAggregate(group=[{0}])
            LogicalFilter(condition=[=($14, 'SHIP      ')])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          JdbcTableScan(table=[[public, orders]])
          LogicalAggregate(group=[{0}])
            LogicalFilter(condition=[=($14, 'SHIP      ')])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinAddRedundantSemiJoinRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          JdbcTableScan(table=[[public, orders]])
          LogicalAggregate(group=[{0}])
            LogicalFilter(condition=[=($14, 'SHIP      ')])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT', '2-HIGH':CHAR(8)]:CHAR(8)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT'), ('1-URGENT'..'2-HIGH':CHAR(8)), ('2-HIGH':CHAR(8)..+)]:CHAR(8)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [SemiJoinRemoveRule, ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&=($x,'SHIP')&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)|Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_shipmode], calls=[SUM($f1), SUM($f2)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,1995-01-01,1996-01-01)&RANGE($x,SHIP,SHIP)){Project[$x,CASE(SEARCH($x,'1-URGENT'),1,0),CASE(SEARCH($x,'1-URGENT'),1,0)]->Scan(public.orders)|Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT       ', '2-HIGH         ']:CHAR(15)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT       '), ('1-URGENT       '..'2-HIGH         '), ('2-HIGH         '..+)]:CHAR(15)), 1, 0)]])
        LogicalJoin(condition=[=($0, $9)], joinType=[inner])
          JdbcTableScan(table=[[public, orders]])
          LogicalAggregate(group=[{0}])
            LogicalFilter(condition=[=($14, 'SHIP      ')])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{4}], high_line_count=[SUM($1)], low_line_count=[SUM($2)])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(inputs=[0], exprs=[[CASE(SEARCH($5, Sarg['1-URGENT', '2-HIGH':CHAR(8)]:CHAR(8)), 1, 0), CASE(SEARCH($5, Sarg[(-..'1-URGENT'), ('1-URGENT'..'2-HIGH':CHAR(8)), ('2-HIGH':CHAR(8)..+)]:CHAR(8)), 1, 0)]])
        JdbcTableScan(table=[[public, orders]])
      LogicalProject(inputs=[0], exprs=[[$14]])
        LogicalFilter(condition=[AND(=($14, 'SHIP      '), <($11, $12), <($10, $11), >=($12, 1995-01-01), <($12, +(1995-01-01, 12:INTERVAL YEAR)))])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN101
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN102
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN103
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN104
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN105
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinPushTransitivePredicatesRule, FilterJoinRule.JoinConditionPushRule, SemiJoinRule.JoinToSemiJoinRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalFilter(condition=[<($4, $16)])
          LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{16}])
            JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
              LogicalProject(exprs=[[*(0.7:DECIMAL(2, 1), $0)]])
                LogicalAggregate(group=[{}], agg#0=[AVG($4)])
                  LogicalFilter(condition=[=($1, $cor0.p_partkey)])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($5)])
    LogicalJoin(condition=[AND(=($1, $16), <($4, $19))], joinType=[inner])
      LogicalProject(inputs=[0..15])
        LogicalJoin(condition=[=($1, $16)], joinType=[inner])
          JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{0}])
            LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
              JdbcTableScan(table=[[public, part]])
      LogicalProject(inputs=[0], exprs=[[CAST($0):INTEGER, CAST($1):DECIMAL(15, 2), *(0.7:DECIMAL(2, 1), $1)]])
        LogicalAggregate(group=[{1}], agg#0=[AVG($4)])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [JoinExtractFilterRule, JoinPushTransitivePredicatesRule, FilterJoinRule.JoinConditionPushRule, SemiJoinRule.JoinOnUniqueToSemiJoinRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalFilter(condition=[<($4, $16)])
          LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{16}])
            JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
              LogicalProject(exprs=[[*(0.7:DECIMAL(2, 1), $0)]])
                LogicalAggregate(group=[{}], agg#0=[AVG($4)])
                  LogicalFilter(condition=[=($1, $cor0.p_partkey)])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($5)])
    LogicalJoin(condition=[AND(=($1, $16), <($4, $19))], joinType=[inner])
      LogicalProject(inputs=[0..15])
        LogicalJoin(condition=[=($1, $16)], joinType=[inner])
          JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{0}])
            LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
              JdbcTableScan(table=[[public, part]])
      LogicalProject(inputs=[0], exprs=[[CAST($0):INTEGER, CAST($1):DECIMAL(15, 2), *(0.7:DECIMAL(2, 1), $1)]])
        LogicalAggregate(group=[{1}], agg#0=[AVG($4)])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [JoinPushTransitivePredicatesRule, FilterJoinRule.FilterIntoJoinRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($5)])
    LogicalJoin(condition=[AND(=($1, $16), <($4, $19))], joinType=[inner])
      LogicalProject(inputs=[0..15])
        LogicalJoin(condition=[=($1, $16)], joinType=[inner])
          JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{0}])
            LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
              JdbcTableScan(table=[[public, part]])
      LogicalProject(inputs=[0], exprs=[[CAST($0):INTEGER, CAST($1):DECIMAL(15, 2), *(0.7:DECIMAL(2, 1), $1)]])
        LogicalAggregate(group=[{1}], agg#0=[AVG($4)])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalFilter(condition=[<($4, $16)])
          LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{16}])
            JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
              LogicalProject(exprs=[[*(0.7:DECIMAL(2, 1), $0)]])
                LogicalAggregate(group=[{}], agg#0=[AVG($4)])
                  LogicalFilter(condition=[=($1, $cor0.p_partkey)])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence B->A 2: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinExtractFilterRule, JoinPushTransitivePredicatesRule, FilterJoinRule.JoinConditionPushRule, SemiJoinRule.JoinOnUniqueToSemiJoinRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Error obtaining query plans: ERROR: syntax error at or near "null"
  Position: 32
Exception in thread "main" java.lang.NullPointerException: Cannot invoke "com.ac.iisc.LLMResponse.areQueriesEquivalent()" because "llmResponse" is null
	at com.ac.iisc.Test.main(Test.java:195)
-----------------------------------------------------
Query ID: TPCHN106
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN107
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [SemiJoinRule.JoinOnUniqueToSemiJoinRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [SemiJoinFilterTransposeRule, SemiJoinRemoveRule, FilterJoinRule.FilterIntoJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,MINUS(1,$x))]->Filter(OR(AND(<=($x,PLUS(1,10))&IS_NOT_NULL($x)),AND(IS_NOT_NULL($x)&RANGE($x,10,20)),AND(IS_NOT_NULL($x)&RANGE($x,20,30))))->Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Project[$x*]->Join(INNER,=($x,$x)&OR(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])),AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])),AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))&RANGE($x,1,11)&RANGE($x,DELIVER IN PERSON,DELIVER IN PERSON)&SEARCH($x,Sarg['AIR', 'AIR REG'])){Scan(public.lineitem)|Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))->Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,OR(AND($x&=($x,$x)),AND($x&=($x,$x)),AND($x&=($x,$x)))){Project[$x,=($x,'Brand#12'),SEARCH($x,'SM BOX'),RANGE($x,1,5),=($x,'Brand#23'),SEARCH($x,'MED BAG'),RANGE($x,1,10),=($x,'Brand#34'),SEARCH($x,'LG BOX'),RANGE($x,1,15)]->Scan(public.part)|Project[$x,>=($x,1),<=($x,PLUS(1,10)),SEARCH($x,'AIR'),=($x,'DELIVER IN PERSON'),>=($x,10),<=($x,PLUS(10,10)),>=($x,20),<=($x,PLUS(10,20)),TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,MINUS(1,$x))]->Filter(OR(AND(<=($x,PLUS(1,10))&IS_NOT_NULL($x)),AND(IS_NOT_NULL($x)&RANGE($x,10,20)),AND(IS_NOT_NULL($x)&RANGE($x,20,30))))->Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)&OR(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])),AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])),AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))&RANGE($x,1,11)&RANGE($x,DELIVER IN PERSON,DELIVER IN PERSON)&SEARCH($x,Sarg['AIR', 'AIR REG'])){Scan(public.lineitem)|Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))->Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,OR(AND($x&=($x,$x)),AND($x&=($x,$x)),AND($x&=($x,$x)))){Project[$x,=($x,'Brand#12'),SEARCH($x,'SM BOX'),RANGE($x,1,5),=($x,'Brand#23'),SEARCH($x,'MED BAG'),RANGE($x,1,10),=($x,'Brand#34'),SEARCH($x,'LG BOX'),RANGE($x,1,15)]->Scan(public.part)|Project[$x,>=($x,1),<=($x,PLUS(1,10)),SEARCH($x,'AIR'),=($x,'DELIVER IN PERSON'),>=($x,10),<=($x,PLUS(10,10)),>=($x,20),<=($x,PLUS(10,20)),TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,MINUS(1,$x))]->Filter(OR(AND(<=($x,PLUS(1,10))&IS_NOT_NULL($x)),AND(IS_NOT_NULL($x)&RANGE($x,10,20)),AND(IS_NOT_NULL($x)&RANGE($x,20,30))))->Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)&OR(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])),AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])),AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))&RANGE($x,1,11)&RANGE($x,DELIVER IN PERSON,DELIVER IN PERSON)&SEARCH($x,Sarg['AIR', 'AIR REG'])){Scan(public.lineitem)|Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))->Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,OR(AND($x&=($x,$x)),AND($x&=($x,$x)),AND($x&=($x,$x)))){Project[$x,=($x,'Brand#12'),SEARCH($x,'SM BOX'),RANGE($x,1,5),=($x,'Brand#23'),SEARCH($x,'MED BAG'),RANGE($x,1,10),=($x,'Brand#34'),SEARCH($x,'LG BOX'),RANGE($x,1,15)]->Scan(public.part)|Project[$x,>=($x,1),<=($x,PLUS(1,10)),SEARCH($x,'AIR'),=($x,'DELIVER IN PERSON'),>=($x,10),<=($x,PLUS(10,10)),>=($x,20),<=($x,PLUS(10,20)),TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,MINUS(1,$x))]->Filter(OR(AND(<=($x,PLUS(1,10))&IS_NOT_NULL($x)),AND(IS_NOT_NULL($x)&RANGE($x,10,20)),AND(IS_NOT_NULL($x)&RANGE($x,20,30))))->Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)&OR(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])),AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])),AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))&RANGE($x,1,11)&RANGE($x,DELIVER IN PERSON,DELIVER IN PERSON)&SEARCH($x,Sarg['AIR', 'AIR REG'])){Scan(public.lineitem)|Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))->Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,OR(AND($x&=($x,$x)),AND($x&=($x,$x)),AND($x&=($x,$x)))){Project[$x,=($x,'Brand#12'),SEARCH($x,'SM BOX'),RANGE($x,1,5),=($x,'Brand#23'),SEARCH($x,'MED BAG'),RANGE($x,1,10),=($x,'Brand#34'),SEARCH($x,'LG BOX'),RANGE($x,1,15)]->Scan(public.part)|Project[$x,>=($x,1),<=($x,PLUS(1,10)),SEARCH($x,'AIR'),=($x,'DELIVER IN PERSON'),>=($x,10),<=($x,PLUS(10,10)),>=($x,20),<=($x,PLUS(10,20)),TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,MINUS(1,$x))]->Filter(OR(AND(<=($x,PLUS(1,10))&IS_NOT_NULL($x)),AND(IS_NOT_NULL($x)&RANGE($x,10,20)),AND(IS_NOT_NULL($x)&RANGE($x,20,30))))->Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)&OR(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])),AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])),AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))&RANGE($x,1,11)&RANGE($x,DELIVER IN PERSON,DELIVER IN PERSON)&SEARCH($x,Sarg['AIR', 'AIR REG'])){Scan(public.lineitem)|Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))->Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,OR(AND($x&=($x,$x)),AND($x&=($x,$x)),AND($x&=($x,$x)))){Project[$x,=($x,'Brand#12'),SEARCH($x,'SM BOX'),RANGE($x,1,5),=($x,'Brand#23'),SEARCH($x,'MED BAG'),RANGE($x,1,10),=($x,'Brand#34'),SEARCH($x,'LG BOX'),RANGE($x,1,15)]->Scan(public.part)|Project[$x,>=($x,1),<=($x,PLUS(1,10)),SEARCH($x,'AIR'),=($x,'DELIVER IN PERSON'),>=($x,10),<=($x,PLUS(10,10)),>=($x,20),<=($x,PLUS(10,20)),TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,MINUS(1,$x))]->Filter(OR(AND(<=($x,PLUS(1,10))&IS_NOT_NULL($x)),AND(IS_NOT_NULL($x)&RANGE($x,10,20)),AND(IS_NOT_NULL($x)&RANGE($x,20,30))))->Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)&OR(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])),AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])),AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))&RANGE($x,1,11)&RANGE($x,DELIVER IN PERSON,DELIVER IN PERSON)&SEARCH($x,Sarg['AIR', 'AIR REG'])){Scan(public.lineitem)|Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))->Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,OR(AND($x&=($x,$x)),AND($x&=($x,$x)),AND($x&=($x,$x)))){Project[$x,=($x,'Brand#12'),SEARCH($x,'SM BOX'),RANGE($x,1,5),=($x,'Brand#23'),SEARCH($x,'MED BAG'),RANGE($x,1,10),=($x,'Brand#34'),SEARCH($x,'LG BOX'),RANGE($x,1,15)]->Scan(public.part)|Project[$x,>=($x,1),<=($x,PLUS(1,10)),SEARCH($x,'AIR'),=($x,'DELIVER IN PERSON'),>=($x,10),<=($x,PLUS(10,10)),>=($x,20),<=($x,PLUS(10,20)),TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,MINUS(1,$x))]->Filter(OR(AND(<=($x,PLUS(1,10))&IS_NOT_NULL($x)),AND(IS_NOT_NULL($x)&RANGE($x,10,20)),AND(IS_NOT_NULL($x)&RANGE($x,20,30))))->Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)&OR(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])),AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])),AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))&RANGE($x,1,11)&RANGE($x,DELIVER IN PERSON,DELIVER IN PERSON)&SEARCH($x,Sarg['AIR', 'AIR REG'])){Scan(public.lineitem)|Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))->Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,OR(AND($x&=($x,$x)),AND($x&=($x,$x)),AND($x&=($x,$x)))){Project[$x,=($x,'Brand#12'),SEARCH($x,'SM BOX'),RANGE($x,1,5),=($x,'Brand#23'),SEARCH($x,'MED BAG'),RANGE($x,1,10),=($x,'Brand#34'),SEARCH($x,'LG BOX'),RANGE($x,1,15)]->Scan(public.part)|Project[$x,>=($x,1),<=($x,PLUS(1,10)),SEARCH($x,'AIR'),=($x,'DELIVER IN PERSON'),>=($x,10),<=($x,PLUS(10,10)),>=($x,20),<=($x,PLUS(10,20)),TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,MINUS(1,$x))]->Filter(OR(AND(<=($x,PLUS(1,10))&IS_NOT_NULL($x)),AND(IS_NOT_NULL($x)&RANGE($x,10,20)),AND(IS_NOT_NULL($x)&RANGE($x,20,30))))->Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)&OR(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])),AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])),AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))&RANGE($x,1,11)&RANGE($x,DELIVER IN PERSON,DELIVER IN PERSON)&SEARCH($x,Sarg['AIR', 'AIR REG'])){Scan(public.lineitem)|Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#12,Brand#12)&RANGE($x,1,5)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#23,Brand#23)&RANGE($x,1,10)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,Brand#34,Brand#34)&RANGE($x,1,15)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))->Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,OR(AND($x&=($x,$x)),AND($x&=($x,$x)),AND($x&=($x,$x)))){Project[$x,=($x,'Brand#12'),SEARCH($x,'SM BOX'),RANGE($x,1,5),=($x,'Brand#23'),SEARCH($x,'MED BAG'),RANGE($x,1,10),=($x,'Brand#34'),SEARCH($x,'LG BOX'),RANGE($x,1,15)]->Scan(public.part)|Project[$x,>=($x,1),<=($x,PLUS(1,10)),SEARCH($x,'AIR'),=($x,'DELIVER IN PERSON'),>=($x,10),<=($x,PLUS(10,10)),>=($x,20),<=($x,PLUS(10,20)),TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,MINUS(1,$x))]->Filter(OR(AND(<=($x,PLUS(1,10))&IS_NOT_NULL($x)),AND(IS_NOT_NULL($x)&RANGE($x,10,20)),AND(IS_NOT_NULL($x)&RANGE($x,20,30))))->Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Project[$x*]->Join(INNER,=($x,$x)&OR(AND(RANGE($x,1,5)&RANGE($x,Brand#12,Brand#12)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])),AND(RANGE($x,1,10)&RANGE($x,Brand#23,Brand#23)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])),AND(RANGE($x,1,15)&RANGE($x,Brand#34,Brand#34)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))&RANGE($x,1,11)&RANGE($x,DELIVER IN PERSON,DELIVER IN PERSON)&SEARCH($x,Sarg['AIR', 'AIR REG'])){Scan(public.lineitem)|Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,5)&RANGE($x,Brand#12,Brand#12)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,10)&RANGE($x,Brand#23,Brand#23)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,15)&RANGE($x,Brand#34,Brand#34)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))->Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,OR(AND($x&=($x,$x)),AND($x&=($x,$x)),AND($x&=($x,$x)))){Project[$x,=($x,'Brand#12'),SEARCH($x,'SM BOX'),RANGE($x,1,5),=($x,'Brand#23'),SEARCH($x,'MED BAG'),RANGE($x,1,10),=($x,'Brand#34'),SEARCH($x,'LG BOX'),RANGE($x,1,15)]->Scan(public.part)|Project[$x,>=($x,1),<=($x,PLUS(1,10)),SEARCH($x,'AIR'),=($x,'DELIVER IN PERSON'),>=($x,10),<=($x,PLUS(10,10)),>=($x,20),<=($x,PLUS(10,20)),TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,MINUS(1,$x))]->Filter(OR(AND(<=($x,PLUS(1,10))&IS_NOT_NULL($x)),AND(IS_NOT_NULL($x)&RANGE($x,10,20)),AND(IS_NOT_NULL($x)&RANGE($x,20,30))))->Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)&OR(AND(RANGE($x,1,5)&RANGE($x,Brand#12,Brand#12)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])),AND(RANGE($x,1,10)&RANGE($x,Brand#23,Brand#23)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])),AND(RANGE($x,1,15)&RANGE($x,Brand#34,Brand#34)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))&RANGE($x,1,11)&RANGE($x,DELIVER IN PERSON,DELIVER IN PERSON)&SEARCH($x,Sarg['AIR', 'AIR REG'])){Scan(public.lineitem)|Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,5)&RANGE($x,Brand#12,Brand#12)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,10)&RANGE($x,Brand#23,Brand#23)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,15)&RANGE($x,Brand#34,Brand#34)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))->Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,OR(AND($x&=($x,$x)),AND($x&=($x,$x)),AND($x&=($x,$x)))){Project[$x,=($x,'Brand#12'),SEARCH($x,'SM BOX'),RANGE($x,1,5),=($x,'Brand#23'),SEARCH($x,'MED BAG'),RANGE($x,1,10),=($x,'Brand#34'),SEARCH($x,'LG BOX'),RANGE($x,1,15)]->Scan(public.part)|Project[$x,>=($x,1),<=($x,PLUS(1,10)),SEARCH($x,'AIR'),=($x,'DELIVER IN PERSON'),>=($x,10),<=($x,PLUS(10,10)),>=($x,20),<=($x,PLUS(10,20)),TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,MINUS(1,$x))]->Filter(OR(AND(<=($x,PLUS(1,10))&IS_NOT_NULL($x)),AND(IS_NOT_NULL($x)&RANGE($x,10,20)),AND(IS_NOT_NULL($x)&RANGE($x,20,30))))->Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)&OR(AND(RANGE($x,1,5)&RANGE($x,Brand#12,Brand#12)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])),AND(RANGE($x,1,10)&RANGE($x,Brand#23,Brand#23)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])),AND(RANGE($x,1,15)&RANGE($x,Brand#34,Brand#34)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))&RANGE($x,1,11)&RANGE($x,DELIVER IN PERSON,DELIVER IN PERSON)&SEARCH($x,Sarg['AIR', 'AIR REG'])){Scan(public.lineitem)|Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,5)&RANGE($x,Brand#12,Brand#12)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,10)&RANGE($x,Brand#23,Brand#23)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,15)&RANGE($x,Brand#34,Brand#34)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))->Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,OR(AND($x&=($x,$x)),AND($x&=($x,$x)),AND($x&=($x,$x)))){Project[$x,=($x,'Brand#12'),SEARCH($x,'SM BOX'),RANGE($x,1,5),=($x,'Brand#23'),SEARCH($x,'MED BAG'),RANGE($x,1,10),=($x,'Brand#34'),SEARCH($x,'LG BOX'),RANGE($x,1,15)]->Scan(public.part)|Project[$x,>=($x,1),<=($x,PLUS(1,10)),SEARCH($x,'AIR'),=($x,'DELIVER IN PERSON'),>=($x,10),<=($x,PLUS(10,10)),>=($x,20),<=($x,PLUS(10,20)),TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,MINUS(1,$x))]->Filter(OR(AND(<=($x,PLUS(1,10))&IS_NOT_NULL($x)),AND(IS_NOT_NULL($x)&RANGE($x,10,20)),AND(IS_NOT_NULL($x)&RANGE($x,20,30))))->Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)&OR(AND(RANGE($x,1,5)&RANGE($x,Brand#12,Brand#12)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])),AND(RANGE($x,1,10)&RANGE($x,Brand#23,Brand#23)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])),AND(RANGE($x,1,15)&RANGE($x,Brand#34,Brand#34)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))&RANGE($x,1,11)&RANGE($x,DELIVER IN PERSON,DELIVER IN PERSON)&SEARCH($x,Sarg['AIR', 'AIR REG'])){Scan(public.lineitem)|Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,5)&RANGE($x,Brand#12,Brand#12)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,10)&RANGE($x,Brand#23,Brand#23)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,15)&RANGE($x,Brand#34,Brand#34)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))->Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,OR(AND($x&=($x,$x)),AND($x&=($x,$x)),AND($x&=($x,$x)))){Project[$x,=($x,'Brand#12'),SEARCH($x,'SM BOX'),RANGE($x,1,5),=($x,'Brand#23'),SEARCH($x,'MED BAG'),RANGE($x,1,10),=($x,'Brand#34'),SEARCH($x,'LG BOX'),RANGE($x,1,15)]->Scan(public.part)|Project[$x,>=($x,1),<=($x,PLUS(1,10)),SEARCH($x,'AIR'),=($x,'DELIVER IN PERSON'),>=($x,10),<=($x,PLUS(10,10)),>=($x,20),<=($x,PLUS(10,20)),TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,MINUS(1,$x))]->Filter(OR(AND(<=($x,PLUS(1,10))&IS_NOT_NULL($x)),AND(IS_NOT_NULL($x)&RANGE($x,10,20)),AND(IS_NOT_NULL($x)&RANGE($x,20,30))))->Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(LEFT,=($x,$x)){Join(INNER,=($x,$x)&OR(AND(RANGE($x,1,5)&RANGE($x,Brand#12,Brand#12)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])),AND(RANGE($x,1,10)&RANGE($x,Brand#23,Brand#23)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])),AND(RANGE($x,1,15)&RANGE($x,Brand#34,Brand#34)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))&RANGE($x,1,11)&RANGE($x,DELIVER IN PERSON,DELIVER IN PERSON)&SEARCH($x,Sarg['AIR', 'AIR REG'])){Scan(public.lineitem)|Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,5)&RANGE($x,Brand#12,Brand#12)&SEARCH($x,Sarg['SM BOX', 'SM CASE', 'SM PACK', 'SM PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,10)&RANGE($x,Brand#23,Brand#23)&SEARCH($x,Sarg['MED BAG', 'MED BOX', 'MED PACK', 'MED PKG'])))->Scan(public.part)}|Aggregate(groups=[p_partkey], calls=[LITERAL_AGG(*)])->Filter(AND(RANGE($x,1,15)&RANGE($x,Brand#34,Brand#34)&SEARCH($x,Sarg['LG BOX', 'LG CASE', 'LG PACK', 'LG PKG'])))->Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,OR(AND($x&=($x,$x)),AND($x&=($x,$x)),AND($x&=($x,$x)))){Project[$x,=($x,'Brand#12'),SEARCH($x,'SM BOX'),RANGE($x,1,5),=($x,'Brand#23'),SEARCH($x,'MED BAG'),RANGE($x,1,10),=($x,'Brand#34'),SEARCH($x,'LG BOX'),RANGE($x,1,15)]->Scan(public.part)|Project[$x,>=($x,1),<=($x,PLUS(1,10)),SEARCH($x,'AIR'),=($x,'DELIVER IN PERSON'),>=($x,10),<=($x,PLUS(10,10)),>=($x,20),<=($x,PLUS(10,20)),TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, -(1, $6))]])
    LogicalFilter(condition=[OR(AND(<=($4, +(1, 10)), IS NOT NULL($17)), AND(>=($4, 10), <=($4, +(10, 10)), IS NOT NULL($19)), AND(>=($4, 20), <=($4, +(20, 10)), IS NOT NULL($21)))])
      LogicalJoin(condition=[=($1, $20)], joinType=[left])
        LogicalJoin(condition=[=($1, $18)], joinType=[left])
          LogicalJoin(condition=[=($1, $16)], joinType=[left])
            LogicalProject(inputs=[0..15])
              LogicalJoin(condition=[=($1, $16)], joinType=[inner])
                LogicalFilter(condition=[AND(>=($4, 1), <=($4, +(1, 10)), SEARCH($14, Sarg['AIR':CHAR(7), 'AIR REG']:CHAR(7)), =($13, 'DELIVER IN PERSON'))])
                  JdbcTableScan(table=[[public, lineitem]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[OR(AND(=($3, 'Brand#12'), SEARCH($6, Sarg['SM BOX':CHAR(7), 'SM CASE', 'SM PACK', 'SM PKG':CHAR(7)]:CHAR(7)), SEARCH($5, Sarg[[1..5]])), AND(=($3, 'Brand#23'), SEARCH($6, Sarg['MED BAG':CHAR(8), 'MED BOX':CHAR(8), 'MED PACK', 'MED PKG':CHAR(8)]:CHAR(8)), SEARCH($5, Sarg[[1..10]])), AND(=($3, 'Brand#34'), SEARCH($6, Sarg['LG BOX':CHAR(7), 'LG CASE', 'LG PACK', 'LG PKG':CHAR(7)]:CHAR(7)), SEARCH($5, Sarg[[1..15]])))])
                    JdbcTableScan(table=[[public, part]])
            LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
              LogicalFilter(condition=[AND(=($3, 'Brand#12'), SEARCH($6, Sarg['SM BOX':CHAR(7), 'SM CASE', 'SM PACK', 'SM PKG':CHAR(7)]:CHAR(7)), SEARCH($5, Sarg[[1..5]]))])
                JdbcTableScan(table=[[public, part]])
          LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
            LogicalFilter(condition=[AND(=($3, 'Brand#23'), SEARCH($6, Sarg['MED BAG':CHAR(8), 'MED BOX':CHAR(8), 'MED PACK', 'MED PKG':CHAR(8)]:CHAR(8)), SEARCH($5, Sarg[[1..10]]))])
              JdbcTableScan(table=[[public, part]])
        LogicalAggregate(group=[{0}], i=[LITERAL_AGG(true)])
          LogicalFilter(condition=[AND(=($3, 'Brand#34'), SEARCH($6, Sarg['LG BOX':CHAR(7), 'LG CASE', 'LG PACK', 'LG PKG':CHAR(7)]:CHAR(7)), SEARCH($5, Sarg[[1..15]]))])
            JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalAggregate(group=[{}], revenue=[SUM($9)])
  LogicalJoin(condition=[OR(AND(=($0, $10), $11, $12, $1, $2, $13, $3, $4), AND(=($0, $10), $14, $15, $5, $6, $16, $3, $4), AND(=($0, $10), $17, $18, $7, $8, $19, $3, $4))], joinType=[inner])
    LogicalProject(exprs=[[$1, >=($4, 1), <=($4, +(1, 10)), SEARCH($14, Sarg['AIR':CHAR(7), 'AIR REG']:CHAR(7)), =($13, 'DELIVER IN PERSON        '), >=($4, 10), <=($4, +(10, 10)), >=($4, 20), <=($4, +(20, 10)), *($5, -(1, $6))]])
      JdbcTableScan(table=[[public, lineitem]])
    LogicalProject(inputs=[0], exprs=[[=($3, 'Brand#12  '), SEARCH($6, Sarg['SM BOX':CHAR(7), 'SM CASE', 'SM PACK', 'SM PKG':CHAR(7)]:CHAR(7)), SEARCH($5, Sarg[[1..5]]), =($3, 'Brand#23  '), SEARCH($6, Sarg['MED BAG':CHAR(8), 'MED BOX':CHAR(8), 'MED PACK', 'MED PKG':CHAR(8)]:CHAR(8)), SEARCH($5, Sarg[[1..10]]), =($3, 'Brand#34  '), SEARCH($6, Sarg['LG BOX':CHAR(7), 'LG CASE', 'LG PACK', 'LG PKG':CHAR(7)]:CHAR(7)), SEARCH($5, Sarg[[1..15]])]])
      JdbcTableScan(table=[[public, part]])


Equivalence: false
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN108
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinAddRedundantSemiJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)|Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)|Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)|Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)|Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalJoin(condition=[=($2, $3)], joinType=[semi])
        LogicalProject(exprs=[[$1, $2, $3]])
          LogicalJoin(condition=[=($0, $7)], joinType=[inner])
            JdbcTableScan(table=[[public, supplier]])
            LogicalAggregate(group=[{1}])
              LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
                LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                  JdbcTableScan(table=[[public, partsupp]])
                  LogicalAggregate(group=[{0}])
                    LogicalFilter(condition=[LIKE($1, '%ivory%')])
                      JdbcTableScan(table=[[public, part]])
                LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                  LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                    LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                      JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($1, 'FRANCE                   ')])
            JdbcTableScan(table=[[public, nation]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          LogicalProject(inputs=[0..6])
            LogicalJoin(condition=[=($3, $7)], joinType=[inner])
              JdbcTableScan(table=[[public, supplier]])
              LogicalAggregate(group=[{0}])
                LogicalFilter(condition=[=($1, 'FRANCE                   ')])
                  JdbcTableScan(table=[[public, nation]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[LIKE($1, '%ivory%')])
                    JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [JoinAddRedundantSemiJoinRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)|Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)|Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Project[$x*]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)|Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)|Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,=($x,$x)&=($x,'FRANCE')){Join(INNER,=($x,$x)){Join(INNER,<($x,$x)&=($x,$x)&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'FRANCE'))->Scan(public.nation)}|Scan(public.nation)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalJoin(condition=[=($2, $3)], joinType=[semi])
        LogicalProject(exprs=[[$1, $2, $3]])
          LogicalJoin(condition=[=($0, $7)], joinType=[inner])
            JdbcTableScan(table=[[public, supplier]])
            LogicalAggregate(group=[{1}])
              LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
                LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                  JdbcTableScan(table=[[public, partsupp]])
                  LogicalAggregate(group=[{0}])
                    LogicalFilter(condition=[LIKE($1, '%ivory%')])
                      JdbcTableScan(table=[[public, part]])
                LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                  LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                    LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                      JdbcTableScan(table=[[public, lineitem]])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($1, 'FRANCE                   ')])
            JdbcTableScan(table=[[public, nation]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          LogicalProject(inputs=[0..6])
            LogicalJoin(condition=[=($3, $7)], joinType=[inner])
              JdbcTableScan(table=[[public, supplier]])
              LogicalAggregate(group=[{0}])
                LogicalFilter(condition=[=($1, 'FRANCE                   ')])
                  JdbcTableScan(table=[[public, nation]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[LIKE($1, '%ivory%')])
                    JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          LogicalProject(inputs=[0..6])
            LogicalJoin(condition=[=($3, $7)], joinType=[inner])
              JdbcTableScan(table=[[public, supplier]])
              LogicalAggregate(group=[{0}])
                LogicalFilter(condition=[=($1, 'FRANCE                   ')])
                  JdbcTableScan(table=[[public, nation]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[LIKE($1, '%ivory%')])
                    JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[LIKE($1, '%ivory%')])
                    JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          LogicalProject(inputs=[0..6])
            LogicalJoin(condition=[=($3, $7)], joinType=[inner])
              JdbcTableScan(table=[[public, supplier]])
              LogicalAggregate(group=[{0}])
                LogicalFilter(condition=[=($1, 'FRANCE                   ')])
                  JdbcTableScan(table=[[public, nation]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[LIKE($1, '%ivory%')])
                    JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          JdbcTableScan(table=[[public, supplier]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[LIKE($1, '%ivory%')])
                    JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [JoinAddRedundantSemiJoinRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [FilterCorrelateRule, SemiJoinRemoveRule, AggregateJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          LogicalProject(inputs=[0..6])
            LogicalJoin(condition=[=($3, $7)], joinType=[inner])
              JdbcTableScan(table=[[public, supplier]])
              LogicalAggregate(group=[{0}])
                LogicalFilter(condition=[=($1, 'FRANCE                   ')])
                  JdbcTableScan(table=[[public, nation]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[LIKE($1, '%ivory%')])
                    JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $4)], joinType=[inner])
          LogicalProject(inputs=[0..3])
            JdbcTableScan(table=[[public, supplier]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $3), =($1, $4), >($2, $5))], joinType=[inner])
              LogicalProject(inputs=[0..2])
                LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                  LogicalProject(inputs=[0..2])
                    JdbcTableScan(table=[[public, partsupp]])
                  LogicalAggregate(group=[{0}])
                    LogicalFilter(condition=[LIKE($1, '%ivory%')])
                      JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[*(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [FilterCorrelateRule, SemiJoinRemoveRule, SemiJoinRemoveRule, SemiJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,<($x,$x)&=($x,$x)&=($x,'FRANCE')&LIKE($x,'%ivory%')){Aggregate(groups=[l_partkey, l_suppkey], calls=[SUM(l_quantity)])->Filter(RANGE($x,1995-01-01,1996-01-01))->Scan(public.lineitem)|Scan(public.nation)|Scan(public.part)|Scan(public.partsupp)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $7)], joinType=[inner])
          LogicalProject(inputs=[0..6])
            LogicalJoin(condition=[=($3, $7)], joinType=[inner])
              JdbcTableScan(table=[[public, supplier]])
              LogicalAggregate(group=[{0}])
                LogicalFilter(condition=[=($1, 'FRANCE                   ')])
                  JdbcTableScan(table=[[public, nation]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $6), =($1, $7), >($2, $11))], joinType=[inner])
              LogicalJoin(condition=[=($0, $5)], joinType=[inner])
                JdbcTableScan(table=[[public, partsupp]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[LIKE($1, '%ivory%')])
                    JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[CAST($0):INTEGER, CAST($1):INTEGER, CAST($2):DECIMAL(19, 2), *(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalProject(inputs=[0..1])
    LogicalJoin(condition=[=($2, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $2, $3]])
        LogicalJoin(condition=[=($0, $4)], joinType=[inner])
          LogicalProject(inputs=[0..3])
            JdbcTableScan(table=[[public, supplier]])
          LogicalAggregate(group=[{1}])
            LogicalJoin(condition=[AND(=($0, $3), =($1, $4), >($2, $5))], joinType=[inner])
              LogicalProject(inputs=[0..2])
                LogicalJoin(condition=[=($0, $3)], joinType=[inner])
                  LogicalProject(inputs=[0..2])
                    JdbcTableScan(table=[[public, partsupp]])
                  LogicalAggregate(group=[{0}])
                    LogicalFilter(condition=[LIKE($1, '%ivory%')])
                      JdbcTableScan(table=[[public, part]])
              LogicalProject(inputs=[0..1], exprs=[[*(0.5:DECIMAL(2, 1), $2)]])
                LogicalAggregate(group=[{1, 2}], agg#0=[SUM($4)])
                  LogicalFilter(condition=[AND(>=($10, 1995-01-01), <($10, +(1995-01-01, 12:INTERVAL YEAR)))])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[=($1, 'FRANCE                   ')])
          JdbcTableScan(table=[[public, nation]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN109
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule, SemiJoinRule.JoinToSemiJoinRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[DESC], dir1=[ASC])
  LogicalAggregate(group=[{3}], numwait=[COUNT()])
    LogicalJoin(condition=[AND(=($4, $1), =($2, $0))], joinType=[inner])
      LogicalProject(exprs=[[$15, $9]])
        LogicalJoin(condition=[=($0, $13)], joinType=[inner])
          LogicalFilter(condition=[=($2, 'F')])
            JdbcTableScan(table=[[public, orders]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalFilter(condition=[=($1, 'ARGENTINA                ')])
              JdbcTableScan(table=[[public, nation]])
            LogicalFilter(condition=[>($12, $11)])
              JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0..1], exprs=[[$3]])
        LogicalFilter(condition=[IS NULL($8)])
          LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{7, 9}])
            LogicalCorrelate(correlation=[$cor0], joinType=[inner], requiredColumns=[{7, 9}])
              JdbcTableScan(table=[[public, supplier]])
              LogicalAggregate(group=[{0}])
                LogicalProject(exprs=[[true]])
                  LogicalFilter(condition=[AND(=($0, $cor0.l_orderkey), <>($2, $cor0.l_suppkey))])
                    JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{0}])
              LogicalProject(exprs=[[true]])
                LogicalFilter(condition=[AND(=($0, $cor0.l_orderkey), <>($2, $cor0.l_suppkey), >($12, $11))])
                  JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[DESC], dir1=[ASC])
  LogicalAggregate(group=[{1}], numwait=[COUNT()])
    LogicalJoin(condition=[AND(=($2, $4), =($0, $3))], joinType=[inner])
      LogicalProject(inputs=[0..1], exprs=[[$3]])
        LogicalFilter(condition=[IS NULL($8)])
          LogicalCorrelate(correlation=[$cor4], joinType=[left], requiredColumns=[{7, 9}])
            LogicalCorrelate(correlation=[$cor4], joinType=[inner], requiredColumns=[{7, 9}])
              JdbcTableScan(table=[[public, supplier]])
              LogicalAggregate(group=[{0}])
                LogicalProject(exprs=[[true]])
                  LogicalFilter(condition=[AND(=($0, $cor4.l_orderkey), <>($2, $cor4.l_suppkey))])
                    JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{0}])
              LogicalProject(exprs=[[true]])
                LogicalFilter(condition=[AND(=($0, $cor4.l_orderkey), <>($2, $cor4.l_suppkey), >($12, $11))])
                  JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(exprs=[[$1, $3]])
        LogicalJoin(condition=[=($2, $0)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$2]])
            LogicalFilter(condition=[>($12, $11)])
              JdbcTableScan(table=[[public, lineitem]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalProject(inputs=[0])
              LogicalJoin(condition=[=($0, $9)], joinType=[inner])
                LogicalFilter(condition=[=($2, 'F')])
                  JdbcTableScan(table=[[public, orders]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[IS NULL($17)])
                    LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{0, 2}])
                      LogicalCorrelate(correlation=[$cor0], joinType=[inner], requiredColumns=[{0, 2}])
                        LogicalFilter(condition=[>($12, $11)])
                          JdbcTableScan(table=[[public, lineitem]])
                        LogicalAggregate(group=[{0}])
                          LogicalProject(exprs=[[true]])
                            LogicalFilter(condition=[AND(=($0, $cor0.l_orderkey), <>($2, $cor0.l_suppkey))])
                              JdbcTableScan(table=[[public, lineitem]])
                      LogicalAggregate(group=[{0}])
                        LogicalProject(exprs=[[true]])
                          LogicalFilter(condition=[AND(=($0, $cor0.l_orderkey), <>($2, $cor0.l_suppkey), >($12, $11))])
                            JdbcTableScan(table=[[public, lineitem]])
            LogicalProject(inputs=[0])
              LogicalFilter(condition=[=($1, 'ARGENTINA                ')])
                JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->B 2: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [JoinAssociateRule, SemiJoinJoinTransposeRule, JoinAssociateRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Filter(>($x,$x))->Scan(public.lineitem)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[s_name], calls=[COUNT(*)])->Join(INNER,=($x,$x)&=($x,'ARGENTINA')&=($x,'F')&>($x,$x)&IS_NULL($x)){LogicalCorrelate[LogicalCorrelate[Scan(public.supplier)|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Aggregate(groups=[i], calls=[])->Project[true]->Filter(AND(<($x,$x)&<>($x,$x)&=($x,$x)))->Scan(public.lineitem)]|Scan(public.lineitem)|Scan(public.nation)|Scan(public.orders)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[DESC], dir1=[ASC])
  LogicalAggregate(group=[{1}], numwait=[COUNT()])
    LogicalJoin(condition=[AND(=($2, $4), =($0, $3))], joinType=[inner])
      LogicalProject(inputs=[0..1], exprs=[[$3]])
        LogicalFilter(condition=[IS NULL($8)])
          LogicalCorrelate(correlation=[$cor4], joinType=[left], requiredColumns=[{7, 9}])
            LogicalCorrelate(correlation=[$cor4], joinType=[inner], requiredColumns=[{7, 9}])
              JdbcTableScan(table=[[public, supplier]])
              LogicalAggregate(group=[{0}])
                LogicalProject(exprs=[[true]])
                  LogicalFilter(condition=[AND(=($0, $cor4.l_orderkey), <>($2, $cor4.l_suppkey))])
                    JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{0}])
              LogicalProject(exprs=[[true]])
                LogicalFilter(condition=[AND(=($0, $cor4.l_orderkey), <>($2, $cor4.l_suppkey), >($12, $11))])
                  JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(exprs=[[$1, $3]])
        LogicalJoin(condition=[=($2, $0)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$2]])
            LogicalFilter(condition=[>($12, $11)])
              JdbcTableScan(table=[[public, lineitem]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalProject(inputs=[0])
              LogicalJoin(condition=[=($0, $9)], joinType=[inner])
                LogicalFilter(condition=[=($2, 'F')])
                  JdbcTableScan(table=[[public, orders]])
                LogicalAggregate(group=[{0}])
                  LogicalFilter(condition=[IS NULL($17)])
                    LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{0, 2}])
                      LogicalCorrelate(correlation=[$cor0], joinType=[inner], requiredColumns=[{0, 2}])
                        LogicalFilter(condition=[>($12, $11)])
                          JdbcTableScan(table=[[public, lineitem]])
                        LogicalAggregate(group=[{0}])
                          LogicalProject(exprs=[[true]])
                            LogicalFilter(condition=[AND(=($0, $cor0.l_orderkey), <>($2, $cor0.l_suppkey))])
                              JdbcTableScan(table=[[public, lineitem]])
                      LogicalAggregate(group=[{0}])
                        LogicalProject(exprs=[[true]])
                          LogicalFilter(condition=[AND(=($0, $cor0.l_orderkey), <>($2, $cor0.l_suppkey), >($12, $11))])
                            JdbcTableScan(table=[[public, lineitem]])
            LogicalProject(inputs=[0])
              LogicalFilter(condition=[=($1, 'ARGENTINA                ')])
                JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[DESC], dir1=[ASC])
  LogicalAggregate(group=[{1}], numwait=[COUNT()])
    LogicalJoin(condition=[AND(=($2, $4), =($0, $3))], joinType=[inner])
      LogicalProject(inputs=[0..1], exprs=[[$3]])
        LogicalFilter(condition=[IS NULL($8)])
          LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{7, 9}])
            LogicalCorrelate(correlation=[$cor0], joinType=[inner], requiredColumns=[{7, 9}])
              JdbcTableScan(table=[[public, supplier]])
              LogicalAggregate(group=[{0}])
                LogicalProject(exprs=[[true]])
                  LogicalFilter(condition=[AND(=($0, $cor0.l_orderkey), <>($2, $cor0.l_suppkey))])
                    JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{0}])
              LogicalProject(exprs=[[true]])
                LogicalFilter(condition=[AND(=($0, $cor0.l_orderkey), <>($2, $cor0.l_suppkey), >($12, $11))])
                  JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(exprs=[[$1, $3]])
        LogicalJoin(condition=[=($2, $0)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$2]])
            LogicalFilter(condition=[>($12, $11)])
              JdbcTableScan(table=[[public, lineitem]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalProject(inputs=[0])
              LogicalFilter(condition=[=($2, 'F')])
                JdbcTableScan(table=[[public, orders]])
            LogicalProject(inputs=[0])
              LogicalFilter(condition=[=($1, 'ARGENTINA                ')])
                JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 2: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN110
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [FilterMergeRule, FilterProjectTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(>($x,0.00:DECIMAL(3, 2)))->Filter(OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(AND(<($x,0.00:DECIMAL(3, 2))&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(>($x,0.00:DECIMAL(3, 2)))->Filter(OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(AND(<($x,0.00:DECIMAL(3, 2))&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(>($x,0.00:DECIMAL(3, 2)))->Filter(OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(AND(<($x,0.00:DECIMAL(3, 2))&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(>($x,0.00:DECIMAL(3, 2)))->Filter(OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(AND(<($x,0.00:DECIMAL(3, 2))&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(>($x,0.00:DECIMAL(3, 2)))->Filter(OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(AND(<($x,0.00:DECIMAL(3, 2))&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(>($x,0.00:DECIMAL(3, 2)))->Filter(OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(AND(<($x,0.00:DECIMAL(3, 2))&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(>($x,0.00:DECIMAL(3, 2)))->Filter(OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(AND(<($x,0.00:DECIMAL(3, 2))&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(>($x,0.00:DECIMAL(3, 2)))->Filter(OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(AND(<($x,0.00:DECIMAL(3, 2))&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(>($x,0.00:DECIMAL(3, 2)))->Filter(OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(AND(<($x,0.00:DECIMAL(3, 2))&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(>($x,0.00:DECIMAL(3, 2)))->Filter(OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(AND(<($x,0.00:DECIMAL(3, 2))&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(>($x,0.00:DECIMAL(3, 2)))->Filter(OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(AND(<($x,0.00:DECIMAL(3, 2))&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(>($x,0.00:DECIMAL(3, 2)))->Filter(OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(AND(<($x,0.00:DECIMAL(3, 2))&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(>($x,0.00:DECIMAL(3, 2)))->Filter(OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[cntrycode], calls=[COUNT(*), SUM(c_acctbal)])->Project[OTHER_FUNCTION($x,1,2),$x]->Filter(IS_NULL($x))->Join(LEFT,=($x,$x)){Join(INNER,>($x,$x)&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))){Aggregate(groups=[], calls=[AVG(c_acctbal)])->Filter(AND(<($x,0.00:DECIMAL(3, 2))&OR(=('13',OTHER_FUNCTION($x,1,2)),=('17',OTHER_FUNCTION($x,1,2)),=('18',OTHER_FUNCTION($x,1,2)),=('23',OTHER_FUNCTION($x,1,2)),=('29',OTHER_FUNCTION($x,1,2)),=('30',OTHER_FUNCTION($x,1,2)),=('31',OTHER_FUNCTION($x,1,2)))))->Scan(public.customer)|Scan(public.customer)}|Project[$x,true]->Aggregate(groups=[o_custkey], calls=[])->Scan(public.orders)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{0}], numcust=[COUNT()], totacctbal=[SUM($1)])
    LogicalProject(exprs=[[SUBSTRING($4, 1, 2), $5]])
      LogicalFilter(condition=[IS NULL($10)])
        LogicalJoin(condition=[=($0, $9)], joinType=[left])
          LogicalJoin(condition=[>($5, $8)], joinType=[inner])
            LogicalFilter(condition=[OR(=(SUBSTRING($4, 1, 2), '13'), =(SUBSTRING($4, 1, 2), '31'), =(SUBSTRING($4, 1, 2), '23'), =(SUBSTRING($4, 1, 2), '29'), =(SUBSTRING($4, 1, 2), '30'), =(SUBSTRING($4, 1, 2), '18'), =(SUBSTRING($4, 1, 2), '17'))])
              JdbcTableScan(table=[[public, customer]])
            LogicalAggregate(group=[{}], EXPR$0=[AVG($5)])
              LogicalFilter(condition=[>($5, 0.00:DECIMAL(3, 2))])
                LogicalFilter(condition=[OR(=(SUBSTRING($4, 1, 2), '13'), =(SUBSTRING($4, 1, 2), '31'), =(SUBSTRING($4, 1, 2), '23'), =(SUBSTRING($4, 1, 2), '29'), =(SUBSTRING($4, 1, 2), '30'), =(SUBSTRING($4, 1, 2), '18'), =(SUBSTRING($4, 1, 2), '17'))])
                  JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0], exprs=[[true]])
            LogicalAggregate(group=[{1}])
              JdbcTableScan(table=[[public, orders]])


Rel2: 
LogicalSort(sort0=[$0], dir0=[ASC])
  LogicalAggregate(group=[{0}], numcust=[COUNT()], totacctbal=[SUM($1)])
    LogicalProject(exprs=[[SUBSTRING($4, 1, 2), $5]])
      LogicalFilter(condition=[IS NULL($10)])
        LogicalJoin(condition=[=($0, $9)], joinType=[left])
          LogicalJoin(condition=[>($5, $8)], joinType=[inner])
            LogicalFilter(condition=[OR(=(SUBSTRING($4, 1, 2), '13'), =(SUBSTRING($4, 1, 2), '31'), =(SUBSTRING($4, 1, 2), '23'), =(SUBSTRING($4, 1, 2), '29'), =(SUBSTRING($4, 1, 2), '30'), =(SUBSTRING($4, 1, 2), '18'), =(SUBSTRING($4, 1, 2), '17'))])
              JdbcTableScan(table=[[public, customer]])
            LogicalAggregate(group=[{}], EXPR$0=[AVG($5)])
              LogicalFilter(condition=[AND(>($5, 0.00:DECIMAL(3, 2)), OR(=(SUBSTRING($4, 1, 2), '13'), =(SUBSTRING($4, 1, 2), '31'), =(SUBSTRING($4, 1, 2), '23'), =(SUBSTRING($4, 1, 2), '29'), =(SUBSTRING($4, 1, 2), '30'), =(SUBSTRING($4, 1, 2), '18'), =(SUBSTRING($4, 1, 2), '17')))])
                JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0], exprs=[[true]])
            LogicalAggregate(group=[{1}])
              JdbcTableScan(table=[[public, orders]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: []
LLM Equivalence A->X: true
LLM Transformations (A to X): []
LLM Equivalence 2 B->X: false
-----------------------------------------------------
Query ID: TPCHN111
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN112
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [AggregateJoinTransposeRule, AggregateJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], sort1=[$2], dir0=[DESC], dir1=[ASC])
  LogicalProject(exprs=[[$2, $3, $0, $1]])
    LogicalAggregate(group=[{2, 3, 4}], revenue=[SUM($5)])
      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($6, 'FURNITURE ')])
            JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$1, $2, $3, $4, $5]])
          LogicalJoin(condition=[=($4, $0)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[$4, $7]])
              LogicalFilter(condition=[<($4, 1995-01-01)])
                JdbcTableScan(table=[[public, orders]])
            LogicalProject(inputs=[0], exprs=[[*($5, -(1, $6))]])
              LogicalFilter(condition=[>($10, 1995-01-01)])
                JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$1], sort1=[$2], dir0=[DESC], dir1=[ASC])
  LogicalProject(inputs=[0], exprs=[[$4, $1, $2]])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $3, $4]])
        LogicalJoin(condition=[=($0, $2)], joinType=[inner])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[=($6, 'FURNITURE ')])
              JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1], exprs=[[$4, $7]])
            LogicalFilter(condition=[<($4, 1995-01-01)])
              JdbcTableScan(table=[[public, orders]])
      LogicalAggregate(group=[{0}], revenue=[SUM($1)])
        LogicalProject(inputs=[0], exprs=[[*($5, -(1, $6))]])
          LogicalFilter(condition=[>($10, 1995-01-01)])
            JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [AggregateJoinTransposeRule, AggregateRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], sort1=[$2], dir0=[DESC], dir1=[ASC])
  LogicalProject(exprs=[[$2, $3, $0, $1]])
    LogicalAggregate(group=[{2, 3, 4}], revenue=[SUM($5)])
      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($6, 'FURNITURE ')])
            JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$1, $2, $3, $4, $5]])
          LogicalJoin(condition=[=($4, $0)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[$4, $7]])
              LogicalFilter(condition=[<($4, 1995-01-01)])
                JdbcTableScan(table=[[public, orders]])
            LogicalProject(inputs=[0], exprs=[[*($5, -(1, $6))]])
              LogicalFilter(condition=[>($10, 1995-01-01)])
                JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$1], sort1=[$2], dir0=[DESC], dir1=[ASC])
  LogicalProject(inputs=[0], exprs=[[$4, $1, $2]])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $3, $4]])
        LogicalJoin(condition=[=($0, $2)], joinType=[inner])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[=($6, 'FURNITURE ')])
              JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1], exprs=[[$4, $7]])
            LogicalFilter(condition=[<($4, 1995-01-01)])
              JdbcTableScan(table=[[public, orders]])
      LogicalAggregate(group=[{0}], revenue=[SUM($1)])
        LogicalProject(inputs=[0], exprs=[[*($5, -(1, $6))]])
          LogicalFilter(condition=[>($10, 1995-01-01)])
            JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [AggregateJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], sort1=[$2], dir0=[DESC], dir1=[ASC])
  LogicalProject(inputs=[0], exprs=[[$4, $1, $2]])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $3, $4]])
        LogicalJoin(condition=[=($0, $2)], joinType=[inner])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[=($6, 'FURNITURE ')])
              JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1], exprs=[[$4, $7]])
            LogicalFilter(condition=[<($4, 1995-01-01)])
              JdbcTableScan(table=[[public, orders]])
      LogicalAggregate(group=[{0}], revenue=[SUM($1)])
        LogicalProject(inputs=[0], exprs=[[*($5, -(1, $6))]])
          LogicalFilter(condition=[>($10, 1995-01-01)])
            JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$1], sort1=[$2], dir0=[DESC], dir1=[ASC])
  LogicalProject(exprs=[[$2, $3, $0, $1]])
    LogicalAggregate(group=[{2, 3, 4}], revenue=[SUM($5)])
      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($6, 'FURNITURE ')])
            JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$1, $2, $3, $4, $5]])
          LogicalJoin(condition=[=($4, $0)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[$4, $7]])
              LogicalFilter(condition=[<($4, 1995-01-01)])
                JdbcTableScan(table=[[public, orders]])
            LogicalProject(inputs=[0], exprs=[[*($5, -(1, $6))]])
              LogicalFilter(condition=[>($10, 1995-01-01)])
                JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence B->A 2: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [AggregateJoinTransposeRule, AggregateRemoveRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [AggregateJoinTransposeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], sort1=[$2], dir0=[DESC], dir1=[ASC])
  LogicalProject(inputs=[0], exprs=[[$4, $1, $2]])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $3, $4]])
        LogicalJoin(condition=[=($0, $2)], joinType=[inner])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[=($6, 'FURNITURE ')])
              JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1], exprs=[[$4, $7]])
            LogicalFilter(condition=[<($4, 1995-01-01)])
              JdbcTableScan(table=[[public, orders]])
      LogicalAggregate(group=[{0}], revenue=[SUM($1)])
        LogicalProject(inputs=[0], exprs=[[*($5, -(1, $6))]])
          LogicalFilter(condition=[>($10, 1995-01-01)])
            JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$1], sort1=[$2], dir0=[DESC], dir1=[ASC])
  LogicalProject(exprs=[[$2, $3, $0, $1]])
    LogicalAggregate(group=[{2, 3, 4}], revenue=[SUM($5)])
      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($6, 'FURNITURE ')])
            JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$1, $2, $3, $4, $5]])
          LogicalJoin(condition=[=($0, $4)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[$4, $7]])
              LogicalFilter(condition=[<($4, 1995-01-01)])
                JdbcTableScan(table=[[public, orders]])
            LogicalProject(inputs=[0], exprs=[[*($5, -(1, $6))]])
              LogicalFilter(condition=[>($10, 1995-01-01)])
                JdbcTableScan(table=[[public, lineitem]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [AggregateJoinTransposeRule, ProjectRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Aggregate(groups=[l_orderkey], calls=[SUM($f1)])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Aggregate(groups=[l_orderkey, o_orderdate, o_shippriority], calls=[SUM($f3)])->Join(INNER,<($x,1995-01-01)&=($x,$x)&=($x,'FURNITURE')){Project[$x,TIMES($x,MINUS(1,$x))]->Filter(>($x,1995-01-01))->Scan(public.lineitem)|Scan(public.customer)|Scan(public.orders)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], sort1=[$2], dir0=[DESC], dir1=[ASC])
  LogicalProject(inputs=[0], exprs=[[$4, $1, $2]])
    LogicalJoin(condition=[=($0, $3)], joinType=[inner])
      LogicalProject(exprs=[[$1, $3, $4]])
        LogicalJoin(condition=[=($0, $2)], joinType=[inner])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[=($6, 'FURNITURE ')])
              JdbcTableScan(table=[[public, customer]])
          LogicalProject(inputs=[0..1], exprs=[[$4, $7]])
            LogicalFilter(condition=[<($4, 1995-01-01)])
              JdbcTableScan(table=[[public, orders]])
      LogicalAggregate(group=[{0}], revenue=[SUM($1)])
        LogicalProject(inputs=[0], exprs=[[*($5, -(1, $6))]])
          LogicalFilter(condition=[>($10, 1995-01-01)])
            JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$1], sort1=[$2], dir0=[DESC], dir1=[ASC])
  LogicalProject(exprs=[[$2, $3, $0, $1]])
    LogicalAggregate(group=[{2, 3, 4}], revenue=[SUM($5)])
      LogicalJoin(condition=[=($0, $1)], joinType=[inner])
        LogicalProject(inputs=[0])
          LogicalFilter(condition=[=($6, 'FURNITURE ')])
            JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$1, $2, $3, $4, $5]])
          LogicalJoin(condition=[=($0, $4)], joinType=[inner])
            LogicalProject(inputs=[0..1], exprs=[[$4, $7]])
              LogicalFilter(condition=[<($4, 1995-01-01)])
                JdbcTableScan(table=[[public, orders]])
            LogicalProject(inputs=[0], exprs=[[*($5, -(1, $6))]])
              LogicalFilter(condition=[>($10, 1995-01-01)])
                JdbcTableScan(table=[[public, lineitem]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN113
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN114
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Project[$x*]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Project[$x*]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(>=($10, 1993-01-01), <($10, +(1994-03-01, 12:INTERVAL YEAR)), >=($6, -(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <=($6, +(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($0, $1)]])
    LogicalFilter(condition=[AND(>=($1, -(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <=($1, +(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))))])
      LogicalProject(exprs=[[$5, $6]])
        LogicalFilter(condition=[AND(>=($10, 1993-01-01), <($10, +(1994-03-01, 12:INTERVAL YEAR)), <($4, 10))])
          JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: []
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Project[$x*]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Project[$x*]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($0, $1)]])
    LogicalFilter(condition=[AND(>=($1, -(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <=($1, +(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))))])
      LogicalProject(exprs=[[$5, $6]])
        LogicalFilter(condition=[AND(>=($10, 1993-01-01), <($10, +(1994-03-01, 12:INTERVAL YEAR)), <($4, 10))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(>=($10, 1993-01-01), <($10, +(1994-03-01, 12:INTERVAL YEAR)), >=($6, -(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <=($6, +(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): []
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): []
[Calcite.compareQueries] canonicalDigest Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Project[$x*]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Project[$x*]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($0, $1)]])
    LogicalFilter(condition=[AND(>=($1, -(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <=($1, +(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))))])
      LogicalProject(exprs=[[$5, $6]])
        LogicalFilter(condition=[AND(>=($10, 1993-01-01), <($10, +(1994-03-01, 12:INTERVAL YEAR)), <($4, 10))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(>=($10, 1993-01-01), <($10, +(1994-03-01, 12:INTERVAL YEAR)), >=($6, -(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <=($6, +(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [ReduceExpressionsRule.FilterReduceExpressionsRule]
[Calcite.compareQueries] canonicalDigest Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Project[$x*]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Project[$x*]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2))))->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)))->Scan(public.lineitem)
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Aggregate(groups=[], calls=[SUM($f0)])->Project[TIMES($x,$x)]->Filter(AND(<($x,10)&RANGE($x,1993-01-01,1995-03-01)&RANGE($x,MINUS(0.06:DECIMAL(3, 2),0.01:DECIMAL(3, 2)),PLUS(0.01:DECIMAL(3, 2),0.06:DECIMAL(3, 2)))))->Scan(public.lineitem)

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($0, $1)]])
    LogicalFilter(condition=[AND(>=($1, -(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <=($1, +(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))))])
      LogicalProject(exprs=[[$5, $6]])
        LogicalFilter(condition=[AND(>=($10, 1993-01-01), <($10, +(1994-03-01, 12:INTERVAL YEAR)), <($4, 10))])
          JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalAggregate(group=[{}], revenue=[SUM($0)])
  LogicalProject(exprs=[[*($5, $6)]])
    LogicalFilter(condition=[AND(>=($10, 1993-01-01), <($10, +(1994-03-01, 12:INTERVAL YEAR)), >=($6, -(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <=($6, +(0.06:DECIMAL(3, 2), 0.01:DECIMAL(3, 2))), <($4, 10))])
      JdbcTableScan(table=[[public, lineitem]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN115
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN116
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN117
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN118
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: []
LLM Equivalence A->B 2: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [AggregateProjectPullUpConstantsRule, AggregateJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..1], exprs=[[$3]])
    LogicalFilter(condition=[>($3, $2)])
      LogicalProject(inputs=[0], exprs=[['INDIA                    ', $1, $2]])
        LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$4, $2]])
              LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                  JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, supplier]])
            LogicalJoin(condition=[true], joinType=[inner])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[=($1, 'INDIA                    ')])
                  JdbcTableScan(table=[[public, nation]])
              LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
                LogicalAggregate(group=[{}], agg#0=[SUM($1)])
                  LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                    LogicalProject(exprs=[[$3, $1]])
                      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                        LogicalProject(exprs=[[$1, *($3, $2)]])
                          JdbcTableScan(table=[[public, partsupp]])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'INDIA                    ')])
                        JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..2])
    LogicalJoin(condition=[>($2, $3)], joinType=[inner])
      LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$4, $2]])
            LogicalJoin(condition=[=($1, $3)], joinType=[inner])
              LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[=($1, 'INDIA                    ')])
              JdbcTableScan(table=[[public, nation]])
      LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
        LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
          LogicalAggregate(group=[{}], agg#0=[SUM($1)])
            LogicalJoin(condition=[=($0, $2)], joinType=[inner])
              LogicalProject(exprs=[[$3, $1]])
                LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                  LogicalProject(exprs=[[$1, *($3, $2)]])
                    JdbcTableScan(table=[[public, partsupp]])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[=($1, 'INDIA                    ')])
                  JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [AggregateProjectPullUpConstantsRule, ProjectRemoveRule, ProjectJoinRemoveRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Filter(>($x,$x))->Project[$x,'INDIA',$x,$x]->Aggregate(groups=[ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..1], exprs=[[$3]])
    LogicalFilter(condition=[>($3, $2)])
      LogicalProject(inputs=[0], exprs=[['INDIA                    ', $1, $2]])
        LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
          LogicalJoin(condition=[=($1, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$4, $2]])
              LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                  JdbcTableScan(table=[[public, partsupp]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, supplier]])
            LogicalJoin(condition=[true], joinType=[inner])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[=($1, 'INDIA                    ')])
                  JdbcTableScan(table=[[public, nation]])
              LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
                LogicalAggregate(group=[{}], agg#0=[SUM($1)])
                  LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                    LogicalProject(exprs=[[$3, $1]])
                      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                        LogicalProject(exprs=[[$1, *($3, $2)]])
                          JdbcTableScan(table=[[public, partsupp]])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'INDIA                    ')])
                        JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..2])
    LogicalJoin(condition=[>($2, $3)], joinType=[inner])
      LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$4, $2]])
            LogicalJoin(condition=[=($1, $3)], joinType=[inner])
              LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[=($1, 'INDIA                    ')])
              JdbcTableScan(table=[[public, nation]])
      LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
        LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
          LogicalAggregate(group=[{}], agg#0=[SUM($1)])
            LogicalJoin(condition=[=($0, $2)], joinType=[inner])
              LogicalProject(exprs=[[$3, $1]])
                LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                  LogicalProject(exprs=[[$1, *($3, $2)]])
                    JdbcTableScan(table=[[public, partsupp]])
                  LogicalProject(inputs=[0], exprs=[[$3]])
                    JdbcTableScan(table=[[public, supplier]])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[=($1, 'INDIA                    ')])
                  JdbcTableScan(table=[[public, nation]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [AggregateJoinTransposeRule]
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [AggregateJoinTransposeRule, FilterJoinRule.FilterIntoJoinRule]
[Calcite.convertRelNodetoJSONQueryPlan] Error while obtaining plan: ERROR: CASE types numeric and text cannot be matched
  Position: 1498
[Calcite.convertRelNodetoJSONQueryPlan] Generated SQL (preview):
SELECT "t4"."ps_partkey", "t4"."n_name", "t4"."total_value"
FROM (SELECT "t1"."ps_partkey", "t3"."n_name", SUM("t1"."$f2") AS "total_value"
FROM (SELECT "t"."ps_partkey", "t0"."s_nationkey", "t"."$f2"
FROM (SELECT "ps_partkey", "ps_suppkey", "ps_supplycost" * "ps_availqty" AS "$f2"
FROM "public"."partsupp") AS "t"
INNER JOIN (SELECT "s_suppkey", "s_nationkey"
FROM "public"."supplier") AS "t0" ON "t"."ps_suppkey" = "t0"."s_suppkey") AS "t1"
INNER JOIN (SELECT "n_nationkey", "n_name"
FROM "public"."nation"
WHERE "n_name" = 'INDIA                    ') AS "t3" ON "t1"."s_nationkey" = "t3"."n_nationkey"
GROUP BY "t1"."ps_partkey", "t3"."n_name") AS "t4"
INNER JOIN (SELECT CASE WHEN "t13"."EXPR$0" THEN NULL WHEN "t13"."EXPR$1" THEN "t13"."$f1" ELSE "t17"."$f0" END AS "$f0"
FROM (SELECT MIN("t11"."EXPR$0") AS "$f1", COUNT("t11"."EXPR$0") = 0 AS "EXPR$0", COUNT("t11"."EXPR$0") = 1 AS "EXPR$1"
FROM (SELECT SUM("t7"."$f0") * 0.00001 AS "EXPR$0"
FROM (SELECT "t6"."s_nationkey", "t5"."$f0"
FROM (SELECT "ps_suppkey", "ps_supplycost" * "ps_availqty" AS "$f0"
FROM "public"."partsupp") AS "t5"
INNER JOIN (SELECT "s_suppkey", "s_nationkey"
FROM "public"."supplier") AS "t6" ON "t5"."ps_suppkey" = "t6"."s_suppkey") AS "t7"
INNER JOIN (SELECT "n_nationkey"
FROM "public"."nation"
WHERE "n_name" = 'INDIA                    ') AS "t9" ON "t7"."s_nationkey" = "t9"."n_nationkey") AS "t11") AS "t13"
LEFT JOIN (SELECT CASE COUNT("EXPR$0") WHEN 0 THEN NULL WHEN 1 THEN MIN("EXPR$0") ELSE (SELECT CAST(NULL AS DECIMAL(19, 7))
UNION ALL
SELECT CAST(NULL AS DECIMAL(19, 7))) END AS "$f0"
FROM (SELECT *
FROM (VALUES (NULL)) AS "t" ("EXPR$0")
UNION ALL
SELECT *
FROM (VALUES (NULL)) AS "t" ("EXPR$0")) AS "t16") AS "t17" ON TRUE) AS "t18" ON "t4"."total_value" > "t18"."$f0"
ORDER BY "t4"."total_value" DESC
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..1], exprs=[[$3]])
    LogicalFilter(condition=[>($3, $2)])
      LogicalAggregate(group=[{0, 4, 5}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$4, $2]])
            LogicalJoin(condition=[=($1, $3)], joinType=[inner])
              LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalProject(inputs=[0..1])
              LogicalFilter(condition=[=($1, 'INDIA                    ')])
                JdbcTableScan(table=[[public, nation]])
            LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
              LogicalAggregate(group=[{}], agg#0=[SUM($1)])
                LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                  LogicalProject(exprs=[[$3, $1]])
                    LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                      LogicalProject(exprs=[[$1, *($3, $2)]])
                        JdbcTableScan(table=[[public, partsupp]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'INDIA                    ')])
                      JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..2])
    LogicalJoin(condition=[>($2, $3)], joinType=[inner])
      LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$4, $2]])
            LogicalJoin(condition=[=($1, $3)], joinType=[inner])
              LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[=($1, 'INDIA                    ')])
              JdbcTableScan(table=[[public, nation]])
      LogicalProject(exprs=[[CASE($1, null:DECIMAL(19, 7), $2, $0, $3)]])
        LogicalJoin(condition=[true], joinType=[left])
          LogicalProject(exprs=[[$1, =($0, 0), =($0, 1)]])
            LogicalAggregate(group=[{}], agg#0=[COUNT($0)], agg#1=[MIN($0)])
              LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
                LogicalAggregate(group=[{}], agg#0=[SUM($1)])
                  LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                    LogicalProject(exprs=[[$3, $1]])
                      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                        LogicalProject(exprs=[[$1, *($3, $2)]])
                          JdbcTableScan(table=[[public, partsupp]])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'INDIA                    ')])
                        JdbcTableScan(table=[[public, nation]])
          LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
            LogicalUnion(all=[true])
              LogicalValues(type=[RecordType(DECIMAL(19, 7) EXPR$0)], tuples=[[{ null }]])
              LogicalValues(type=[RecordType(DECIMAL(19, 7) EXPR$0)], tuples=[[{ null }]])


Equivalence: false
LLM Equivalence 2 B->X: true
LLM Transformations (B to X): [AggregateJoinTransposeRule, FilterJoinRule.FilterIntoJoinRule, AggregateFilterToCaseRule]
[Calcite.convertRelNodetoJSONQueryPlan] Error while obtaining plan: ERROR: CASE types numeric and text cannot be matched
  Position: 1498
[Calcite.convertRelNodetoJSONQueryPlan] Generated SQL (preview):
SELECT "t4"."ps_partkey", "t4"."n_name", "t4"."total_value"
FROM (SELECT "t1"."ps_partkey", "t3"."n_name", SUM("t1"."$f2") AS "total_value"
FROM (SELECT "t"."ps_partkey", "t0"."s_nationkey", "t"."$f2"
FROM (SELECT "ps_partkey", "ps_suppkey", "ps_supplycost" * "ps_availqty" AS "$f2"
FROM "public"."partsupp") AS "t"
INNER JOIN (SELECT "s_suppkey", "s_nationkey"
FROM "public"."supplier") AS "t0" ON "t"."ps_suppkey" = "t0"."s_suppkey") AS "t1"
INNER JOIN (SELECT "n_nationkey", "n_name"
FROM "public"."nation"
WHERE "n_name" = 'INDIA                    ') AS "t3" ON "t1"."s_nationkey" = "t3"."n_nationkey"
GROUP BY "t1"."ps_partkey", "t3"."n_name") AS "t4"
INNER JOIN (SELECT CASE WHEN "t13"."EXPR$0" THEN NULL WHEN "t13"."EXPR$1" THEN "t13"."$f1" ELSE "t17"."$f0" END AS "$f0"
FROM (SELECT MIN("t11"."EXPR$0") AS "$f1", COUNT("t11"."EXPR$0") = 0 AS "EXPR$0", COUNT("t11"."EXPR$0") = 1 AS "EXPR$1"
FROM (SELECT SUM("t7"."$f0") * 0.00001 AS "EXPR$0"
FROM (SELECT "t6"."s_nationkey", "t5"."$f0"
FROM (SELECT "ps_suppkey", "ps_supplycost" * "ps_availqty" AS "$f0"
FROM "public"."partsupp") AS "t5"
INNER JOIN (SELECT "s_suppkey", "s_nationkey"
FROM "public"."supplier") AS "t6" ON "t5"."ps_suppkey" = "t6"."s_suppkey") AS "t7"
INNER JOIN (SELECT "n_nationkey"
FROM "public"."nation"
WHERE "n_name" = 'INDIA                    ') AS "t9" ON "t7"."s_nationkey" = "t9"."n_nationkey") AS "t11") AS "t13"
LEFT JOIN (SELECT CASE COUNT("EXPR$0") WHEN 0 THEN NULL WHEN 1 THEN MIN("EXPR$0") ELSE (SELECT CAST(NULL AS DECIMAL(19, 7))
UNION ALL
SELECT CAST(NULL AS DECIMAL(19, 7))) END AS "$f0"
FROM (SELECT *
FROM (VALUES (NULL)) AS "t" ("EXPR$0")
UNION ALL
SELECT *
FROM (VALUES (NULL)) AS "t" ("EXPR$0")) AS "t16") AS "t17" ON TRUE) AS "t18" ON "t4"."total_value" > "t18"."$f0"
ORDER BY "t4"."total_value" DESC
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Project[$x*]->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort->Project[$x*]->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort->Project[$x*]->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort->Filter(>($x,$x))->Aggregate(groups=[n_name, ps_partkey, threshold_value], calls=[SUM($f3)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort->Join(INNER,>($x,$x)){Aggregate(groups=[n_name, ps_partkey], calls=[SUM($f2)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Project[CASE($x,null:DECIMAL(19, 7),$x,$x,$x)]->Join(LEFT,true){Project[$x,=($x,0:BIGINT),=($x,1:BIGINT)]->Aggregate(groups=[], calls=[COUNT(expr), MIN(expr)])->Project[TIMES($x,0.00001:DECIMAL(6, 5))]->Aggregate(groups=[], calls=[SUM($f0)])->Join(INNER,=($x,$x)&=($x,'INDIA')){Project[$x,TIMES($x,$x)]->Scan(public.partsupp)|Scan(public.nation)|Scan(public.supplier)}|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Union(ALL)[LogicalValues[], LogicalValues[]]}}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..1], exprs=[[$3]])
    LogicalFilter(condition=[>($3, $2)])
      LogicalAggregate(group=[{0, 4, 5}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$4, $2]])
            LogicalJoin(condition=[=($1, $3)], joinType=[inner])
              LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalJoin(condition=[true], joinType=[inner])
            LogicalProject(inputs=[0..1])
              LogicalFilter(condition=[=($1, 'INDIA                    ')])
                JdbcTableScan(table=[[public, nation]])
            LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
              LogicalAggregate(group=[{}], agg#0=[SUM($1)])
                LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                  LogicalProject(exprs=[[$3, $1]])
                    LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                      LogicalProject(exprs=[[$1, *($3, $2)]])
                        JdbcTableScan(table=[[public, partsupp]])
                      LogicalProject(inputs=[0], exprs=[[$3]])
                        JdbcTableScan(table=[[public, supplier]])
                  LogicalProject(inputs=[0])
                    LogicalFilter(condition=[=($1, 'INDIA                    ')])
                      JdbcTableScan(table=[[public, nation]])


Rel2: 
LogicalSort(sort0=[$2], dir0=[DESC])
  LogicalProject(inputs=[0..2])
    LogicalJoin(condition=[>($2, $3)], joinType=[inner])
      LogicalAggregate(group=[{0, 4}], total_value=[SUM($2)])
        LogicalJoin(condition=[=($1, $3)], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[$4, $2]])
            LogicalJoin(condition=[=($1, $3)], joinType=[inner])
              LogicalProject(inputs=[0..1], exprs=[[*($3, $2)]])
                JdbcTableScan(table=[[public, partsupp]])
              LogicalProject(inputs=[0], exprs=[[$3]])
                JdbcTableScan(table=[[public, supplier]])
          LogicalProject(inputs=[0..1])
            LogicalFilter(condition=[=($1, 'INDIA                    ')])
              JdbcTableScan(table=[[public, nation]])
      LogicalProject(exprs=[[CASE($1, null:DECIMAL(19, 7), $2, $0, $3)]])
        LogicalJoin(condition=[true], joinType=[left])
          LogicalProject(exprs=[[$1, =($0, 0), =($0, 1)]])
            LogicalAggregate(group=[{}], agg#0=[COUNT($0)], agg#1=[MIN($0)])
              LogicalProject(exprs=[[*($0, 0.00001:DECIMAL(6, 5))]])
                LogicalAggregate(group=[{}], agg#0=[SUM($1)])
                  LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                    LogicalProject(exprs=[[$3, $1]])
                      LogicalJoin(condition=[=($0, $2)], joinType=[inner])
                        LogicalProject(exprs=[[$1, *($3, $2)]])
                          JdbcTableScan(table=[[public, partsupp]])
                        LogicalProject(inputs=[0], exprs=[[$3]])
                          JdbcTableScan(table=[[public, supplier]])
                    LogicalProject(inputs=[0])
                      LogicalFilter(condition=[=($1, 'INDIA                    ')])
                        JdbcTableScan(table=[[public, nation]])
          LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
            LogicalUnion(all=[true])
              LogicalValues(type=[RecordType(DECIMAL(19, 7) EXPR$0)], tuples=[[{ null }]])
              LogicalValues(type=[RecordType(DECIMAL(19, 7) EXPR$0)], tuples=[[{ null }]])


Equivalence: false
-----------------------------------------------------
Query ID: TPCHN119
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN120
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN121
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN122
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN123
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [JoinToCorrelateRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($2)])
    LogicalJoin(condition=[AND(=($0, $3), =($1, $4))], joinType=[inner])
      LogicalProject(inputs=[0..2])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(exprs=[[$1, $4, $5]])
            JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
              JdbcTableScan(table=[[public, part]])
      LogicalProject(exprs=[[$2, $3]])
        LogicalJoin(condition=[AND(=($0, $2), <($3, $1))], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[*(0.7:DECIMAL(2, 1), $1)]])
            LogicalAggregate(group=[{1}], agg#0=[AVG($4)])
              JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{0, 1}])
            LogicalJoin(condition=[=($0, $2)], joinType=[inner])
              LogicalProject(exprs=[[$1, $4]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
                  JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalFilter(condition=[<($4, $16)])
          LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{16}])
            JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
              LogicalProject(exprs=[[*(0.7:DECIMAL(2, 1), $0)]])
                LogicalAggregate(group=[{}], agg#0=[AVG($4)])
                  LogicalFilter(condition=[=($1, $cor0.p_partkey)])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [JoinToCorrelateRule, FilterCorrelateRule]
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
[Calcite.compareQueries] canonicalDigest Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){Aggregate(groups=[l_partkey], calls=[AVG(l_quantity)])->Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.lineitem)|Scan(public.part)|Scan(public.part)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Project[DIVIDE($x,7.0:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[SUM(l_extendedprice)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,Brand#53,Brand#53)&RANGE($x,MED BAG,MED BAG)){LogicalCorrelate[Scan(public.lineitem)|Aggregate(groups=[], calls=[SINGLE_VALUE(expr)])->Project[TIMES($x,0.7:DECIMAL(2, 1))]->Aggregate(groups=[], calls=[AVG(l_quantity)])->Filter(=($x,$x))->Scan(public.lineitem)]|Scan(public.part)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($2)])
    LogicalJoin(condition=[AND(=($0, $3), =($1, $4))], joinType=[inner])
      LogicalProject(inputs=[0..2])
        LogicalJoin(condition=[=($0, $3)], joinType=[inner])
          LogicalProject(exprs=[[$1, $4, $5]])
            JdbcTableScan(table=[[public, lineitem]])
          LogicalProject(inputs=[0])
            LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
              JdbcTableScan(table=[[public, part]])
      LogicalProject(exprs=[[$2, $3]])
        LogicalJoin(condition=[AND(=($0, $2), <($3, $1))], joinType=[inner])
          LogicalProject(inputs=[0], exprs=[[*(0.7:DECIMAL(2, 1), $1)]])
            LogicalAggregate(group=[{1}], agg#0=[AVG($4)])
              JdbcTableScan(table=[[public, lineitem]])
          LogicalAggregate(group=[{0, 1}])
            LogicalJoin(condition=[=($0, $2)], joinType=[inner])
              LogicalProject(exprs=[[$1, $4]])
                JdbcTableScan(table=[[public, lineitem]])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
                  JdbcTableScan(table=[[public, part]])


Rel2: 
LogicalProject(exprs=[[/($0, 7.0:DECIMAL(2, 1))]])
  LogicalAggregate(group=[{}], agg#0=[SUM($1)])
    LogicalJoin(condition=[=($2, $0)], joinType=[inner])
      LogicalProject(exprs=[[$1, $5]])
        LogicalFilter(condition=[<($4, $16)])
          LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{16}])
            JdbcTableScan(table=[[public, lineitem]])
            LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
              LogicalProject(exprs=[[*(0.7:DECIMAL(2, 1), $0)]])
                LogicalAggregate(group=[{}], agg#0=[AVG($4)])
                  LogicalFilter(condition=[=($1, $cor0.p_partkey)])
                    JdbcTableScan(table=[[public, lineitem]])
      LogicalProject(inputs=[0])
        LogicalFilter(condition=[AND(=($3, 'Brand#53  '), =($6, 'MED BAG   '))])
          JdbcTableScan(table=[[public, part]])


Equivalence with transformations: false
LLM Equivalence A->X: false
-----------------------------------------------------
Query ID: TPCHN124
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN125
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCHN126
[Calcite.relNodeToSql] Cannot convert correlated plan (LogicalCorrelate present).
Equivalence without transformations: false
LLM Equivalence A->B 1: false
LLM Equivalence B->A 1: false
LLM Equivalence A->X: false
