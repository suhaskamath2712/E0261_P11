-----------------------------------------------------
Query ID: TPCDS_Q1
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q2
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q3
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q4
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q5
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q6
Equivalence without transformations: false
LLM Equivalence A->B 1: true
LLM Transformations A->B 1: [ProjectCorrelateTransposeRule, AggregateJoinTransposeRule, JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[ASC], dir1=[ASC], fetch=[100])
  LogicalFilter(condition=[>=($1, 10)])
    LogicalAggregate(group=[{0}], cnt=[COUNT()])
      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, $2]])
          LogicalJoin(condition=[=($0, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$8]])
              JdbcTableScan(table=[[public, customer_address]])
            LogicalProject(inputs=[0], exprs=[[$4]])
              JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$2]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$2, $3]])
              JdbcTableScan(table=[[public, store_sales]])
            LogicalJoin(condition=[true], joinType=[inner])
              LogicalProject(inputs=[0])
                LogicalJoin(condition=[=($3, $28)], joinType=[inner])
                  JdbcTableScan(table=[[public, date_dim]])
                  LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
                    LogicalAggregate(group=[{3}])
                      LogicalFilter(condition=[AND(=($6, 2002), =($8, 3))])
                        JdbcTableScan(table=[[public, date_dim]])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[>($5, *(1.2:DECIMAL(2, 1), $22))])
                  LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{94}])
                    JdbcTableScan(table=[[public, item]])
                    LogicalAggregate(group=[{}], EXPR$0=[AVG($5)])
                      LogicalFilter(condition=[=($12, $cor0.i_category)])
                        JdbcTableScan(table=[[public, item]])


Rel2: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[ASC], dir1=[ASC], fetch=[100])
  LogicalFilter(condition=[>=($1, 10)])
    LogicalAggregate(group=[{0}], cnt=[COUNT()])
      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, $2]])
          LogicalJoin(condition=[=($0, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$8]])
              JdbcTableScan(table=[[public, customer_address]])
            LogicalProject(inputs=[0], exprs=[[$4]])
              JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$2]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$2, $3]])
              JdbcTableScan(table=[[public, store_sales]])
            LogicalProject(inputs=[0], exprs=[[$2]])
              LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, date_dim]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  LogicalJoin(condition=[AND(=($2, $4), >($1, $5))], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$5, $12]])
                      JdbcTableScan(table=[[public, item]])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalAggregate(group=[{3}])
                        LogicalFilter(condition=[AND(=($6, 2002), =($8, 3))])
                          JdbcTableScan(table=[[public, date_dim]])
                      LogicalProject(inputs=[0], exprs=[[*(1.2:DECIMAL(2, 1), $1)]])
                        LogicalAggregate(group=[{12}], avg_price=[AVG($5)])
                          JdbcTableScan(table=[[public, item]])


Equivalence with transformations: false
LLM Equivalence A->B 2: true
LLM Transformations A->B 2: [FilterCorrelateRule, SemiJoinRule, JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[ASC], dir1=[ASC], fetch=[100])
  LogicalFilter(condition=[>=($1, 10)])
    LogicalAggregate(group=[{0}], cnt=[COUNT()])
      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, $2]])
          LogicalJoin(condition=[=($0, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$8]])
              JdbcTableScan(table=[[public, customer_address]])
            LogicalProject(inputs=[0], exprs=[[$4]])
              JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$2]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$2, $3]])
              JdbcTableScan(table=[[public, store_sales]])
            LogicalJoin(condition=[true], joinType=[inner])
              LogicalProject(inputs=[0])
                LogicalJoin(condition=[=($3, $28)], joinType=[inner])
                  JdbcTableScan(table=[[public, date_dim]])
                  LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
                    LogicalAggregate(group=[{3}])
                      LogicalFilter(condition=[AND(=($6, 2002), =($8, 3))])
                        JdbcTableScan(table=[[public, date_dim]])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[>($5, *(1.2:DECIMAL(2, 1), $22))])
                  LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{94}])
                    JdbcTableScan(table=[[public, item]])
                    LogicalAggregate(group=[{}], EXPR$0=[AVG($5)])
                      LogicalFilter(condition=[=($12, $cor0.i_category)])
                        JdbcTableScan(table=[[public, item]])


Rel2: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[ASC], dir1=[ASC], fetch=[100])
  LogicalFilter(condition=[>=($1, 10)])
    LogicalAggregate(group=[{0}], cnt=[COUNT()])
      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, $2]])
          LogicalJoin(condition=[=($0, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$8]])
              JdbcTableScan(table=[[public, customer_address]])
            LogicalProject(inputs=[0], exprs=[[$4]])
              JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$2]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$2, $3]])
              JdbcTableScan(table=[[public, store_sales]])
            LogicalProject(inputs=[0], exprs=[[$2]])
              LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, date_dim]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  LogicalJoin(condition=[AND(=($2, $4), >($1, $5))], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$5, $12]])
                      JdbcTableScan(table=[[public, item]])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalAggregate(group=[{3}])
                        LogicalFilter(condition=[AND(=($6, 2002), =($8, 3))])
                          JdbcTableScan(table=[[public, date_dim]])
                      LogicalProject(inputs=[0], exprs=[[*(1.2:DECIMAL(2, 1), $1)]])
                        LogicalAggregate(group=[{12}], avg_price=[AVG($5)])
                          JdbcTableScan(table=[[public, item]])


Equivalence with transformations: false
LLM Equivalence B->A 1: true
LLM Transformations B->A 1: [SemiJoinRule.JoinToSemiJoinRule, JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[ASC], dir1=[ASC], fetch=[100])
  LogicalFilter(condition=[>=($1, 10)])
    LogicalAggregate(group=[{0}], cnt=[COUNT()])
      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, $2]])
          LogicalJoin(condition=[=($0, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$8]])
              JdbcTableScan(table=[[public, customer_address]])
            LogicalProject(inputs=[0], exprs=[[$4]])
              JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$2]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$2, $3]])
              JdbcTableScan(table=[[public, store_sales]])
            LogicalProject(inputs=[0], exprs=[[$2]])
              LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, date_dim]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  LogicalJoin(condition=[AND(=($2, $4), >($1, $5))], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$5, $12]])
                      JdbcTableScan(table=[[public, item]])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalAggregate(group=[{3}])
                        LogicalFilter(condition=[AND(=($6, 2002), =($8, 3))])
                          JdbcTableScan(table=[[public, date_dim]])
                      LogicalProject(inputs=[0], exprs=[[*(1.2:DECIMAL(2, 1), $1)]])
                        LogicalAggregate(group=[{12}], avg_price=[AVG($5)])
                          JdbcTableScan(table=[[public, item]])


Rel2: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[ASC], dir1=[ASC], fetch=[100])
  LogicalFilter(condition=[>=($1, 10)])
    LogicalAggregate(group=[{0}], cnt=[COUNT()])
      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, $2]])
          LogicalJoin(condition=[=($0, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$8]])
              JdbcTableScan(table=[[public, customer_address]])
            LogicalProject(inputs=[0], exprs=[[$4]])
              JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$2]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$2, $3]])
              JdbcTableScan(table=[[public, store_sales]])
            LogicalJoin(condition=[true], joinType=[inner])
              LogicalProject(inputs=[0])
                LogicalJoin(condition=[=($3, $28)], joinType=[inner])
                  JdbcTableScan(table=[[public, date_dim]])
                  LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
                    LogicalAggregate(group=[{3}])
                      LogicalFilter(condition=[AND(=($6, 2002), =($8, 3))])
                        JdbcTableScan(table=[[public, date_dim]])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[>($5, *(1.2:DECIMAL(2, 1), $22))])
                  LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{94}])
                    JdbcTableScan(table=[[public, item]])
                    LogicalAggregate(group=[{}], EXPR$0=[AVG($5)])
                      LogicalFilter(condition=[=($12, $cor0.i_category)])
                        JdbcTableScan(table=[[public, item]])


Equivalence with transformations: false
LLM Equivalence B->A 2: true
LLM Transformations B->A 2: [JoinToCorrelateRule, JoinAssociateRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&IS_NOT_NULL($x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&IS_NOT_NULL($x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (ref-only Project removed) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&IS_NOT_NULL($x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 Project predicates inlined) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&IS_NOT_NULL($x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 LEFT+COUNT>0 -> INNER) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&IS_NOT_NULL($x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR-order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&IS_NOT_NULL($x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 web RANGE placement normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&IS_NOT_NULL($x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5 INNER-factor order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&IS_NOT_NULL($x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION-order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&IS_NOT_NULL($x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (AND-order normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&IS_NOT_NULL($x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Project+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&IS_NOT_NULL($x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&IS_NOT_NULL($x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q5+UNION+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel1: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,<($x,$x)&=($x,$x)&IS_NOT_NULL($x)&RANGE($x,2002,2002)&RANGE($x,3,3)){Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.date_dim)|Scan(public.item)|Scan(public.item)|Scan(public.store_sales)}
[Calcite.compareQueries] canonicalDigest (Q41 OR+AND normalized) Rel2: Sort(fetch=100,order=[1:ASCENDING:LAST, 0:ASCENDING:LAST])->Filter(>=($x,10))->Aggregate(groups=[state], calls=[COUNT(*)])->Join(INNER,=($x,$x)&>($x,TIMES($x,1.2:DECIMAL(2, 1)))){Aggregate(groups=[d_month_seq], calls=[])->Filter(AND(RANGE($x,2002,2002)&RANGE($x,3,3)))->Scan(public.date_dim)|Aggregate(groups=[i_category], calls=[AVG(i_current_price)])->Scan(public.item)|Scan(public.customer)|Scan(public.customer_address)|Scan(public.date_dim)|Scan(public.item)|Scan(public.store_sales)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[ASC], dir1=[ASC], fetch=[100])
  LogicalFilter(condition=[>=($1, 10)])
    LogicalAggregate(group=[{0}], cnt=[COUNT()])
      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, $2]])
          LogicalJoin(condition=[=($0, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$8]])
              JdbcTableScan(table=[[public, customer_address]])
            LogicalProject(inputs=[0], exprs=[[$4]])
              LogicalFilter(condition=[IS NOT NULL($4)])
                JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$2]])
          LogicalJoin(condition=[AND(=($0, $3), =($1, $4))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$2, $3]])
              LogicalFilter(condition=[IS NOT NULL($3)])
                JdbcTableScan(table=[[public, store_sales]])
            LogicalProject(inputs=[0], exprs=[[$2]])
              LogicalJoin(condition=[=($1, $3)], joinType=[inner])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  JdbcTableScan(table=[[public, date_dim]])
                LogicalProject(inputs=[0], exprs=[[$3]])
                  LogicalJoin(condition=[AND(=($1, $4), =($2, $5))], joinType=[inner])
                    LogicalProject(inputs=[0], exprs=[[$5, $12]])
                      JdbcTableScan(table=[[public, item]])
                    LogicalJoin(condition=[true], joinType=[inner])
                      LogicalFilter(condition=[IS NOT NULL($0)])
                        LogicalAggregate(group=[{3}])
                          LogicalFilter(condition=[AND(=($6, 2002), =($8, 3))])
                            JdbcTableScan(table=[[public, date_dim]])
                      LogicalProject(exprs=[[$3, $4]])
                        LogicalJoin(condition=[AND(=($4, $0), >($3, $2))], joinType=[inner])
                          LogicalProject(inputs=[0..1], exprs=[[*(1.2:DECIMAL(2, 1), $1)]])
                            LogicalAggregate(group=[{12}], avg_price=[AVG($5)])
                              JdbcTableScan(table=[[public, item]])
                          LogicalAggregate(group=[{5, 12}])
                            JdbcTableScan(table=[[public, item]])


Rel2: 
LogicalSort(sort0=[$1], sort1=[$0], dir0=[ASC], dir1=[ASC], fetch=[100])
  LogicalFilter(condition=[>=($1, 10)])
    LogicalAggregate(group=[{0}], cnt=[COUNT()])
      LogicalJoin(condition=[=($1, $2)], joinType=[inner])
        LogicalProject(exprs=[[$1, $2]])
          LogicalJoin(condition=[=($0, $3)], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$8]])
              JdbcTableScan(table=[[public, customer_address]])
            LogicalProject(inputs=[0], exprs=[[$4]])
              JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$2]])
          LogicalJoin(condition=[AND(=($1, $4), =($0, $3))], joinType=[inner])
            LogicalProject(inputs=[0], exprs=[[$2, $3]])
              JdbcTableScan(table=[[public, store_sales]])
            LogicalJoin(condition=[true], joinType=[inner])
              LogicalProject(inputs=[0])
                LogicalJoin(condition=[=($3, $28)], joinType=[inner])
                  JdbcTableScan(table=[[public, date_dim]])
                  LogicalAggregate(group=[{}], agg#0=[SINGLE_VALUE($0)])
                    LogicalAggregate(group=[{3}])
                      LogicalFilter(condition=[AND(=($6, 2002), =($8, 3))])
                        JdbcTableScan(table=[[public, date_dim]])
              LogicalProject(inputs=[0])
                LogicalFilter(condition=[>($5, *(1.2:DECIMAL(2, 1), $22))])
                  LogicalCorrelate(correlation=[$cor0], joinType=[left], requiredColumns=[{94}])
                    JdbcTableScan(table=[[public, item]])
                    LogicalAggregate(group=[{}], EXPR$0=[AVG($5)])
                      LogicalFilter(condition=[=($12, $cor0.i_category)])
                        JdbcTableScan(table=[[public, item]])


Equivalence with transformations: false
LLM Equivalence A->X: true
LLM Transformations (A to X): [SemiJoinRule.ProjectToSemiJoinRule, AggregateJoinTransposeRule, JoinAssociateRule]

-----------------------------------------------------
Query ID: TPCDS_Q7
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q8
Equivalence without transformations: true
-----------------------------------------------------
Query ID: TPCDS_Q9
Equivalence without transformations: false
