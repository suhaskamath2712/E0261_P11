-----------------------------------------------------
Query ID: LITHE_5
Equivalence without transformations: false
LLM Equivalence 1: true
LLM Transformations 1: [JoinToMultiJoinRule, MultiJoinOptimizeBushyRule, SemiJoinRule.JoinToSemiJoinRule, AggregateMergeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[SUM@1])->Project[$x,TIMES($x,MINUS(1,$x))]->Scan(public.lineitem)|Filter(=($x,'ASIA'))->Scan(public.region)|Filter(AND(RANGE($x,1995-01-01,1996-01-01)))->Scan(public.orders)|Scan(public.customer)|Scan(public.nation)|Scan(public.supplier)}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[SUM@1])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(AND(RANGE($x,1995-01-01,1996-01-01)))->Project[$x,$x,$x,$x,$x,$x,$x,$x,$x,$x]->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.lineitem)|Scan(public.orders)}|Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{0}], revenue=[SUM($1)])
    LogicalProject(exprs=[[$45, *($24, -(1, $25))]])
      LogicalJoin(condition=[AND(=($3, $39), =($19, $9))], joinType=[inner])
        LogicalProject(exprs=[[$10, $11, $12, $13, $14, $15, $16, $17, $18, $0, $1, $2, $3, $4, $5, $6, $7, $8, $9]])
          LogicalJoin(condition=[=($10, $1)], joinType=[inner])
            LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
              JdbcTableScan(table=[[public, orders]])
            JdbcTableScan(table=[[public, customer]])
        LogicalProject(exprs=[[$17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $0, $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16]])
          LogicalJoin(condition=[=($19, $0)], joinType=[inner])
            LogicalProject(exprs=[[$9, $10, $11, $12, $13, $14, $15, $16, $0, $1, $2, $3, $4, $5, $6, $7, $8]])
              LogicalJoin(condition=[=($12, $0)], joinType=[inner])
                LogicalProject(exprs=[[$4, $5, $6, $7, $8, $0, $1, $2, $3]])
                  LogicalJoin(condition=[=($6, $0)], joinType=[inner])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])
                    JdbcTableScan(table=[[public, nation]])
                JdbcTableScan(table=[[public, supplier]])
            JdbcTableScan(table=[[public, lineitem]])


Rel2: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{0}], revenue=[SUM($1)])
    LogicalProject(exprs=[[$45, *($24, -(1, $25))]])
      LogicalJoin(condition=[AND(=($3, $39), =($19, $9))], joinType=[inner])
        LogicalJoin(condition=[=($0, $10)], joinType=[inner])
          JdbcTableScan(table=[[public, customer]])
          LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
            LogicalProject(inputs=[0..9])
              LogicalJoin(condition=[=($0, $10)], joinType=[inner])
                JdbcTableScan(table=[[public, orders]])
                LogicalAggregate(group=[{0}])
                  LogicalProject(inputs=[0])
                    JdbcTableScan(table=[[public, lineitem]])
        LogicalJoin(condition=[=($2, $17)], joinType=[inner])
          JdbcTableScan(table=[[public, lineitem]])
          LogicalJoin(condition=[=($3, $8)], joinType=[inner])
            JdbcTableScan(table=[[public, supplier]])
            LogicalJoin(condition=[=($2, $5)], joinType=[inner])
              JdbcTableScan(table=[[public, nation]])
              LogicalFilter(condition=[=($1, 'ASIA                     ')])
                JdbcTableScan(table=[[public, region]])


Equivalence with transformations: false
LLM Equivalence 2: true
LLM Transformations 2: [JoinAddRedundantSemiJoinRule, AggregateMergeRule]
[Calcite.compareQueries] canonicalDigest Rel1: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[SUM@1])->Project[$x,TIMES($x,MINUS(1,$x))]->Join(INNER,=($x,$x)){Join(INNER,=($x,$x)){Filter(AND(RANGE($x,1995-01-01,1996-01-01)))->Scan(public.orders)|Join(INNER,=($x,$x)){Scan(public.customer)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(AND(RANGE($x,1995-01-01,1996-01-01)))->Scan(public.orders)}}|Aggregate(groups=[0, 1], calls=[])->Project[$x,$x]->Join(INNER,=($x,$x)){Filter(=($x,'ASIA'))->Scan(public.region)|Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)){Filter(=($x,'ASIA'))->Scan(public.region)|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)){Filter(=($x,'ASIA'))->Scan(public.region)|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}}}}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)){Filter(=($x,'ASIA'))->Scan(public.region)|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}}}}}|Filter(=($x,'ASIA'))->Scan(public.region)|Join(INNER,=($x,$x)){Scan(public.lineitem)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)){Filter(=($x,'ASIA'))->Scan(public.region)|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)){Filter(=($x,'ASIA'))->Scan(public.region)|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}}}}}|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}|Join(INNER,=($x,$x)){Scan(public.supplier)|Aggregate(groups=[0], calls=[])->Project[$x]->Join(INNER,=($x,$x)){Filter(=($x,'ASIA'))->Scan(public.region)|Join(INNER,=($x,$x)){Scan(public.nation)|Aggregate(groups=[0], calls=[])->Project[$x]->Filter(=($x,'ASIA'))->Scan(public.region)}}}}
[Calcite.compareQueries] canonicalDigest Rel2: Sort->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[SUM@1])->Project[$x,TIMES($x,MINUS(1,$x))]->Filter(AND(RANGE($x,1995-01-01,1996-01-01)))->Project[$x,$x,$x,$x,$x,$x,$x,$x,$x,$x]->Join(INNER,=($x,$x)){Aggregate(groups=[0], calls=[])->Project[$x]->Scan(public.lineitem)|Scan(public.orders)}|Filter(=($x,'ASIA'))->Scan(public.region)|Scan(public.customer)|Scan(public.lineitem)|Scan(public.nation)|Scan(public.supplier)}

[Calcite.compareQueries] NOT EQUIVALENT


Transformed Rel1: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{0}], revenue=[SUM($1)])
    LogicalProject(exprs=[[$45, *($24, -(1, $25))]])
      LogicalJoin(condition=[AND(=($3, $39), =($19, $9))], joinType=[inner], semiJoinDone=[true])
        LogicalJoin(condition=[AND(=($3, $39), =($19, $9))], joinType=[semi])
          LogicalJoin(condition=[=($0, $10)], joinType=[inner], semiJoinDone=[true])
            LogicalJoin(condition=[=($0, $10)], joinType=[semi])
              JdbcTableScan(table=[[public, customer]])
              LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
                JdbcTableScan(table=[[public, orders]])
            LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
              JdbcTableScan(table=[[public, orders]])
          LogicalJoin(condition=[=($2, $17)], joinType=[inner], semiJoinDone=[true])
            LogicalJoin(condition=[=($2, $17)], joinType=[semi])
              JdbcTableScan(table=[[public, lineitem]])
              LogicalJoin(condition=[=($3, $8)], joinType=[inner], semiJoinDone=[true])
                LogicalJoin(condition=[=($3, $8)], joinType=[semi])
                  JdbcTableScan(table=[[public, supplier]])
                  LogicalJoin(condition=[=($2, $5)], joinType=[inner], semiJoinDone=[true])
                    LogicalJoin(condition=[=($2, $5)], joinType=[semi])
                      JdbcTableScan(table=[[public, nation]])
                      LogicalFilter(condition=[=($1, 'ASIA                     ')])
                        JdbcTableScan(table=[[public, region]])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])
                LogicalJoin(condition=[=($2, $5)], joinType=[inner], semiJoinDone=[true])
                  LogicalJoin(condition=[=($2, $5)], joinType=[semi])
                    JdbcTableScan(table=[[public, nation]])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])
                  LogicalFilter(condition=[=($1, 'ASIA                     ')])
                    JdbcTableScan(table=[[public, region]])
            LogicalJoin(condition=[=($3, $8)], joinType=[inner], semiJoinDone=[true])
              LogicalJoin(condition=[=($3, $8)], joinType=[semi])
                JdbcTableScan(table=[[public, supplier]])
                LogicalJoin(condition=[=($2, $5)], joinType=[inner], semiJoinDone=[true])
                  LogicalJoin(condition=[=($2, $5)], joinType=[semi])
                    JdbcTableScan(table=[[public, nation]])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])
                  LogicalFilter(condition=[=($1, 'ASIA                     ')])
                    JdbcTableScan(table=[[public, region]])
              LogicalJoin(condition=[=($2, $5)], joinType=[inner], semiJoinDone=[true])
                LogicalJoin(condition=[=($2, $5)], joinType=[semi])
                  JdbcTableScan(table=[[public, nation]])
                  LogicalFilter(condition=[=($1, 'ASIA                     ')])
                    JdbcTableScan(table=[[public, region]])
                LogicalFilter(condition=[=($1, 'ASIA                     ')])
                  JdbcTableScan(table=[[public, region]])
        LogicalJoin(condition=[=($2, $17)], joinType=[inner], semiJoinDone=[true])
          LogicalJoin(condition=[=($2, $17)], joinType=[semi])
            JdbcTableScan(table=[[public, lineitem]])
            LogicalJoin(condition=[=($3, $8)], joinType=[inner], semiJoinDone=[true])
              LogicalJoin(condition=[=($3, $8)], joinType=[semi])
                JdbcTableScan(table=[[public, supplier]])
                LogicalJoin(condition=[=($2, $5)], joinType=[inner], semiJoinDone=[true])
                  LogicalJoin(condition=[=($2, $5)], joinType=[semi])
                    JdbcTableScan(table=[[public, nation]])
                    LogicalFilter(condition=[=($1, 'ASIA                     ')])
                      JdbcTableScan(table=[[public, region]])
                  LogicalFilter(condition=[=($1, 'ASIA                     ')])
                    JdbcTableScan(table=[[public, region]])
              LogicalJoin(condition=[=($2, $5)], joinType=[inner], semiJoinDone=[true])
                LogicalJoin(condition=[=($2, $5)], joinType=[semi])
                  JdbcTableScan(table=[[public, nation]])
                  LogicalFilter(condition=[=($1, 'ASIA                     ')])
                    JdbcTableScan(table=[[public, region]])
                LogicalFilter(condition=[=($1, 'ASIA                     ')])
                  JdbcTableScan(table=[[public, region]])
          LogicalJoin(condition=[=($3, $8)], joinType=[inner], semiJoinDone=[true])
            LogicalJoin(condition=[=($3, $8)], joinType=[semi])
              JdbcTableScan(table=[[public, supplier]])
              LogicalJoin(condition=[=($2, $5)], joinType=[inner], semiJoinDone=[true])
                LogicalJoin(condition=[=($2, $5)], joinType=[semi])
                  JdbcTableScan(table=[[public, nation]])
                  LogicalFilter(condition=[=($1, 'ASIA                     ')])
                    JdbcTableScan(table=[[public, region]])
                LogicalFilter(condition=[=($1, 'ASIA                     ')])
                  JdbcTableScan(table=[[public, region]])
            LogicalJoin(condition=[=($2, $5)], joinType=[inner], semiJoinDone=[true])
              LogicalJoin(condition=[=($2, $5)], joinType=[semi])
                JdbcTableScan(table=[[public, nation]])
                LogicalFilter(condition=[=($1, 'ASIA                     ')])
                  JdbcTableScan(table=[[public, region]])
              LogicalFilter(condition=[=($1, 'ASIA                     ')])
                JdbcTableScan(table=[[public, region]])


Rel2: 
LogicalSort(sort0=[$1], dir0=[DESC])
  LogicalAggregate(group=[{0}], revenue=[SUM($1)])
    LogicalProject(exprs=[[$45, *($24, -(1, $25))]])
      LogicalJoin(condition=[AND(=($3, $39), =($19, $9))], joinType=[inner])
        LogicalJoin(condition=[=($0, $10)], joinType=[inner])
          JdbcTableScan(table=[[public, customer]])
          LogicalFilter(condition=[AND(>=($4, 1995-01-01), <($4, +(1995-01-01, 12:INTERVAL YEAR)))])
            LogicalProject(inputs=[0..9])
              LogicalJoin(condition=[=($0, $10)], joinType=[inner])
                JdbcTableScan(table=[[public, orders]])
                LogicalAggregate(group=[{0}])
                  LogicalProject(inputs=[0])
                    JdbcTableScan(table=[[public, lineitem]])
        LogicalJoin(condition=[=($2, $17)], joinType=[inner])
          JdbcTableScan(table=[[public, lineitem]])
          LogicalJoin(condition=[=($3, $8)], joinType=[inner])
            JdbcTableScan(table=[[public, supplier]])
            LogicalJoin(condition=[=($2, $5)], joinType=[inner])
              JdbcTableScan(table=[[public, nation]])
              LogicalFilter(condition=[=($1, 'ASIA                     ')])
                JdbcTableScan(table=[[public, region]])


Equivalence with transformations: false
