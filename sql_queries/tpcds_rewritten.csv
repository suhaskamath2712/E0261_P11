Query id,Provable_status,Regression_status,Source,Speedup,Total_semantic_time,Total_generation_time,Total_Tokens_used,Mutant_database_creation_time,Final_check_time,Best_Query
1,Statistical,No Regression,prompt3,28.14962487860827,48.16211412847042,178.43371086311527,12895,19.247537851333618,9.338119745254517," WITH customer_total_return AS ( SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, SUM(sr_fee) AS ctr_total_return FROM store_returns JOIN date_dim ON sr_returned_date_sk = d_date_sk WHERE d_year = 2000 GROUP BY sr_customer_sk, sr_store_sk ), average_return AS ( SELECT ctr_store_sk, AVG(ctr_total_return) * 1.2 AS threshold FROM customer_total_return GROUP BY ctr_store_sk ) SELECT c_customer_id FROM customer_total_return ctr1 JOIN store ON s_store_sk = ctr1.ctr_store_sk JOIN customer ON ctr1.ctr_customer_sk = c_customer_sk JOIN average_return ar ON ctr1.ctr_store_sk = ar.ctr_store_sk WHERE ctr1.ctr_total_return > ar.threshold AND s_state = 'TN' ORDER BY c_customer_id LIMIT 100 "
2,Statistical,No Regression,prompt3,1.0000569593008313,3.352957742055878,290.68704562005587,21603,73.50771760940552,1.7201404571533203," WITH wscs AS ( SELECT ws_sold_date_sk AS sold_date_sk, ws_ext_sales_price AS sales_price FROM web_sales UNION ALL SELECT cs_sold_date_sk AS sold_date_sk, cs_ext_sales_price AS sales_price FROM catalog_sales ), wswscs AS ( SELECT d_week_seq, SUM(CASE WHEN d_day_name = 'Sunday' THEN sales_price ELSE 0 END) AS sun_sales, SUM(CASE WHEN d_day_name = 'Monday' THEN sales_price ELSE 0 END) AS mon_sales, SUM(CASE WHEN d_day_name = 'Tuesday' THEN sales_price ELSE 0 END) AS tue_sales, SUM(CASE WHEN d_day_name = 'Wednesday' THEN sales_price ELSE 0 END) AS wed_sales, SUM(CASE WHEN d_day_name = 'Thursday' THEN sales_price ELSE 0 END) AS thu_sales, SUM(CASE WHEN d_day_name = 'Friday' THEN sales_price ELSE 0 END) AS fri_sales, SUM(CASE WHEN d_day_name = 'Saturday' THEN sales_price ELSE 0 END) AS sat_sales FROM wscs JOIN date_dim ON d_date_sk = sold_date_sk GROUP BY d_week_seq ), year_sales AS ( SELECT wswscs.d_week_seq, sun_sales, mon_sales, tue_sales, wed_sales, thu_sales, fri_sales, sat_sales, d_year FROM wswscs JOIN date_dim ON date_dim.d_week_seq = wswscs.d_week_seq WHERE d_year IN (1998, 1999) ) SELECT y.d_week_seq AS d_week_seq1, ROUND(y.sun_sales::NUMERIC / NULLIF(z.sun_sales, 0), 2) AS sun_sales_ratio, ROUND(y.mon_sales::NUMERIC / NULLIF(z.mon_sales, 0), 2) AS mon_sales_ratio, ROUND(y.tue_sales::NUMERIC / NULLIF(z.tue_sales, 0), 2) AS tue_sales_ratio, ROUND(y.wed_sales::NUMERIC / NULLIF(z.wed_sales, 0), 2) AS wed_sales_ratio, ROUND(y.thu_sales::NUMERIC / NULLIF(z.thu_sales, 0), 2) AS thu_sales_ratio, ROUND(y.fri_sales::NUMERIC / NULLIF(z.fri_sales, 0), 2) AS fri_sales_ratio, ROUND(y.sat_sales::NUMERIC / NULLIF(z.sat_sales, 0), 2) AS sat_sales_ratio FROM year_sales y JOIN year_sales z ON y.d_week_seq = z.d_week_seq - 53 WHERE y.d_year = 1998 AND z.d_year = 1999 ORDER BY y.d_week_seq "
3,Statistical,No Regression,Original,1,0.42006676900200546,88.39352953038178,8111,21.51820683479309,0.10643696784973145,"select dt.d_year,item.i_brand_id brand_id,item.i_brand brand,sum(ss_sales_price) sum_agg from date_dim dt,store_sales,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manufact_id = 816 and dt.d_moy=11 group by dt.d_year,item.i_brand,item.i_brand_id order by dt.d_year,sum_agg desc,brand_id limit 100 "
4,Statistical,No Regression,MCTS,23.0272667477211,289.20993872662075,507.1922127197031,41751,40.08087968826294,86.66173195838928," WITH year_total AS ( SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1999 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year HAVING SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) > 0 UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2) AS year_total, 'c' AS sale_type FROM customer, catalog_sales, date_dim WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1999 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year HAVING SUM(((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2) > 0 UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2) AS year_total, 'w' AS sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1999 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year HAVING SUM(((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2) > 0 ) SELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_birth_country FROM year_total t_s_firstyear, year_total t_s_secyear, year_total t_c_firstyear, year_total t_c_secyear, year_total t_w_firstyear, year_total t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_c_secyear.customer_id AND t_s_firstyear.customer_id = t_c_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_c_firstyear.sale_type = 'c' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_c_secyear.sale_type = 'c' AND t_w_secyear.sale_type = 'w' AND t_s_secyear.dyear = 1999 AND t_c_secyear.dyear = 1999 AND t_w_secyear.dyear = 1999 AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END >= CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total ELSE NULL END AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END >= CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total ELSE NULL END ORDER BY t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_birth_country LIMIT 100 "
5,Statistical,No Regression,Original,1,1.4619776359759271,597.7953987161163,41237,35.57408356666565,0.7274270057678223,"with ssr as (select s_store_id,sum(sales_price) as sales,sum(profit) as profit,sum(return_amt) as returns,sum(net_loss) as profit_loss from ( select ss_store_sk as store_sk,ss_sold_date_sk as date_sk,ss_ext_sales_price as sales_price,ss_net_profit as profit,cast(0 as decimal(7,2)) as return_amt,cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk,sr_returned_date_sk as date_sk,cast(0 as decimal(7,2)) as sales_price,cast(0 as decimal(7,2)) as profit,sr_return_amt as return_amt,sr_net_loss as net_loss from store_returns ) salesreturns,date_dim,store where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) + interval '14' day) and store_sk = s_store_sk group by s_store_id),csr as (select cp_catalog_page_id,sum(sales_price) as sales,sum(profit) as profit,sum(return_amt) as returns,sum(net_loss) as profit_loss from ( select cs_catalog_page_sk as page_sk,cs_sold_date_sk as date_sk,cs_ext_sales_price as sales_price,cs_net_profit as profit,cast(0 as decimal(7,2)) as return_amt,cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk,cr_returned_date_sk as date_sk,cast(0 as decimal(7,2)) as sales_price,cast(0 as decimal(7,2)) as profit,cr_return_amount as return_amt,cr_net_loss as net_loss from catalog_returns ) salesreturns,date_dim,catalog_page where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) + interval '14' day) and page_sk = cp_catalog_page_sk group by cp_catalog_page_id),wsr as (select web_site_id,sum(sales_price) as sales,sum(profit) as profit,sum(return_amt) as returns,sum(net_loss) as profit_loss from ( select ws_web_site_sk as wsr_web_site_sk,ws_sold_date_sk as date_sk,ws_ext_sales_price as sales_price,ws_net_profit as profit,cast(0 as decimal(7,2)) as return_amt,cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk,wr_returned_date_sk as date_sk,cast(0 as decimal(7,2)) as sales_price,cast(0 as decimal(7,2)) as profit,wr_return_amt as return_amt,wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns,date_dim,web_site where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) + interval '14' day) and wsr_web_site_sk = web_site_sk group by web_site_id) select channel,id,sum(sales) as sales,sum(returns) as returns,sum(profit) as profit from (select 'store channel' as channel,'store' || s_store_id as id,sales,returns,(profit - profit_loss) as profit from ssr union all select 'catalog channel' as channel,'catalog_page' || cp_catalog_page_id as id,sales,returns,(profit - profit_loss) as profit from csr union all select 'web channel' as channel,'web_site' || web_site_id as id,sales,returns,(profit - profit_loss) as profit from wsr ) x group by rollup (channel,id) order by channel,id limit 100 "
6,Statistical,No Regression,prompt1,222.03336903343774,43.06026296969503,142.27840382349677,8388,19.33950448036194,6.864352226257324," WITH date_seq AS ( SELECT DISTINCT d_month_seq FROM date_dim WHERE d_year = 2002 AND d_moy = 3 ), avg_price AS ( SELECT i_category, AVG(i_current_price) AS avg_price FROM item GROUP BY i_category ) SELECT a.ca_state AS state, COUNT(*) AS cnt FROM customer_address a JOIN customer c ON a.ca_address_sk = c.c_current_addr_sk JOIN store_sales s ON c.c_customer_sk = s.ss_customer_sk JOIN date_dim d ON s.ss_sold_date_sk = d.d_date_sk JOIN item i ON s.ss_item_sk = i.i_item_sk JOIN date_seq ds ON d.d_month_seq = ds.d_month_seq JOIN avg_price ap ON i.i_category = ap.i_category WHERE i.i_current_price > 1.2 * ap.avg_price GROUP BY a.ca_state HAVING COUNT(*) >= 10 ORDER BY cnt, a.ca_state LIMIT 100 "
7,Statistical,No Regression,Original,1,0.4424163813237101,83.6967260313686,5223,25.73979949951172,0.5358102321624756,"select i_item_id,avg(ss_quantity) agg1,avg(ss_list_price) agg2,avg(ss_coupon_amt) agg3,avg(ss_sales_price) agg4 from store_sales,customer_demographics,date_dim,item,promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'W' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id limit 100 "
8,Statistical,No Regression,Original,1,0.9781695874407887,700.9641227484681,40495,48.15063238143921,1.0513222217559814,"select s_store_name,sum(ss_net_profit) from store_sales,date_dim,store,(select ca_zip from ( SELECT substr(ca_zip,1,5) ca_zip FROM customer_address WHERE substr(ca_zip,1,5) IN ( '47602','16704','35863','28577','83910','36201','58412','48162','28055','41419','80332','38607','77817','24891','16226','18410','21231','59345','13918','51089','20317','17167','54585','67881','78366','47770','18360','51717','73108','14440','21800','89338','45859','65501','34948','25973','73219','25333','17291','10374','18829','60736','82620','41351','52094','19326','25214','54207','40936','21814','79077','25178','75742','77454','30621','89193','27369','41232','48567','83041','71948','37119','68341','14073','16891','62878','49130','19833','24286','27700','40979','50412','81504','94835','84844','71954','39503','57649','18434','24987','12350','86379','27413','44529','98569','16515','27287','24255','21094','16005','56436','91110','68293','56455','54558','10298','83647','32754','27052','51766','19444','13869','45645','94791','57631','20712','37788','41807','46507','21727','71836','81070','50632','88086','63991','20244','31655','51782','29818','63792','68605','94898','36430','57025','20601','82080','33869','22728','35834','29086','92645','98584','98072','11652','78093','57553','43830','71144','53565','18700','90209','71256','38353','54364','28571','96560','57839','56355','50679','45266','84680','34306','34972','48530','30106','15371','92380','84247','92292','68852','13338','34594','82602','70073','98069','85066','47289','11686','98862','26217','47529','63294','51793','35926','24227','14196','24594','32489','99060','49472','43432','49211','14312','88137','47369','56877','20534','81755','15794','12318','21060','73134','41255','63073','81003','73873','66057','51184','51195','45676','92696','70450','90669','98338','25264','38919','59226','58581','60298','17895','19489','52301','80846','95464','68770','51634','19988','18367','18421','11618','67975','25494','41352','95430','15734','62585','97173','33773','10425','75675','53535','17879','41967','12197','67998','79658','59130','72592','14851','43933','68101','50636','25717','71286','24660','58058','72991','95042','15543','33122','69280','11912','59386','27642','65177','17672','33467','64592','36335','54010','18767','63193','42361','49254','33113','33159','36479','59080','11855','81963','31016','49140','29392','41836','32958','53163','13844','73146','23952','65148','93498','14530','46131','58454','13376','13378','83986','12320','17193','59852','46081','98533','52389','13086','68843','31013','13261','60560','13443','45533','83583','11489','58218','19753','22911','25115','86709','27156','32669','13123','51933','39214','41331','66943','14155','69998','49101','70070','35076','14242','73021','59494','15782','29752','37914','74686','83086','34473','15751','81084','49230','91894','60624','17819','28810','63180','56224','39459','55233','75752','43639','55349','86057','62361','50788','31830','58062','18218','85761','60083','45484','21204','90229','70041','41162','35390','16364','39500','68908','26689','52868','81335','40146','11340','61527','61794','71997','30415','59004','29450','58117','69952','33562','83833','27385','61860','96435','48333','23065','32961','84919','61997','99132','22815','56600','68730','48017','95694','32919','88217','27116','28239','58032','18884','16791','21343','97462','18569','75660','15475') intersect select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM customer_address,customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1998 and (substr(s_zip,0,1) = substr(V1.ca_zip,0,1)) group by s_store_name order by s_store_name limit 100 "
9,Statistical,No Regression,rule_5,2.968855559799271,56.86423497390933,251.7751534464769,21016,43.18769669532776,27.055924654006958," select case when ss1.count > 1071 then ss1.avg_ext_tax else ss1.avg_net_paid_inc_tax end as bucket1, case when ss2.count > 39161 then ss2.avg_ext_tax else ss2.avg_net_paid_inc_tax end as bucket2, case when ss3.count > 29434 then ss3.avg_ext_tax else ss3.avg_net_paid_inc_tax end as bucket3, case when ss4.count > 6568 then ss4.avg_ext_tax else ss4.avg_net_paid_inc_tax end as bucket4, case when ss5.count > 21216 then ss5.avg_ext_tax else ss5.avg_net_paid_inc_tax end as bucket5 from reason cross join (select count(*) as count, avg(ss_ext_tax) as avg_ext_tax, avg(ss_net_paid_inc_tax) as avg_net_paid_inc_tax from store_sales where ss_quantity between 1 and 20) as ss1, (select count(*) as count, avg(ss_ext_tax) as avg_ext_tax, avg(ss_net_paid_inc_tax) as avg_net_paid_inc_tax from store_sales where ss_quantity between 21 and 40) as ss2, (select count(*) as count, avg(ss_ext_tax) as avg_ext_tax, avg(ss_net_paid_inc_tax) as avg_net_paid_inc_tax from store_sales where ss_quantity between 41 and 60) as ss3, (select count(*) as count, avg(ss_ext_tax) as avg_ext_tax, avg(ss_net_paid_inc_tax) as avg_net_paid_inc_tax from store_sales where ss_quantity between 61 and 80) as ss4, (select count(*) as count, avg(ss_ext_tax) as avg_ext_tax, avg(ss_net_paid_inc_tax) as avg_net_paid_inc_tax from store_sales where ss_quantity between 81 and 100) as ss5 where r_reason_sk = 1 "
10,Statistical,No Regression,Original,1,3.463888719677925,252.74934863951057,16237,53.4706130027771,0.372272253036499,"select cd_gender,cd_marital_status,cd_education_status,count(*) cnt1,cd_purchase_estimate,count(*) cnt2,cd_credit_rating,count(*) cnt3,cd_dep_count,count(*) cnt4,cd_dep_employed_count,count(*) cnt5,cd_dep_college_count,count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Fairfield County','Campbell County','Washtenaw County','Escambia County','Cleburne County','United States','1') and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 and 12) and (exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 ANd 12) or exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 and 12)) group by cd_gender,cd_marital_status,cd_education_status,cd_purchase_estimate,cd_credit_rating,cd_dep_count,cd_dep_employed_count,cd_dep_college_count order by cd_gender,cd_marital_status,cd_education_status,cd_purchase_estimate,cd_credit_rating,cd_dep_count,cd_dep_employed_count,cd_dep_college_count limit 100 "
11,Statistical,No Regression,prompt4,14.817281873451025,69.91120716044679,506.2565623756964,24858,27.745510578155518,44.58907604217529," WITH year_total AS ( SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, c.c_birth_country AS customer_birth_country, c.c_login AS customer_login, c.c_email_address AS customer_email_address, d.d_year AS dyear, SUM(ss.ss_ext_list_price - ss.ss_ext_discount_amt) AS year_total, 's' AS sale_type FROM customer c JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 1999 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag, c.c_birth_country, c.c_login, c.c_email_address, d.d_year UNION ALL SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, c.c_birth_country AS customer_birth_country, c.c_login AS customer_login, c.c_email_address AS customer_email_address, d.d_year AS dyear, SUM(ws.ws_ext_list_price - ws.ws_ext_discount_amt) AS year_total, 'w' AS sale_type FROM customer c JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE d.d_year = 1999 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag, c.c_birth_country, c.c_login, c.c_email_address, d.d_year ) SELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_email_address FROM year_total t_s_firstyear JOIN year_total t_s_secyear ON t_s_secyear.customer_id = t_s_firstyear.customer_id JOIN year_total t_w_firstyear ON t_s_firstyear.customer_id = t_w_firstyear.customer_id JOIN year_total t_w_secyear ON t_s_firstyear.customer_id = t_w_secyear.customer_id WHERE t_s_firstyear.sale_type = 's' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND COALESCE(t_w_secyear.year_total / NULLIF(t_w_firstyear.year_total, 0), 0) >= COALESCE(t_s_secyear.year_total / NULLIF(t_s_firstyear.year_total, 0), 0) ORDER BY t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_email_address LIMIT 100 "
12,Statistical,No Regression,Original,1,0.24902785965241492,152.42890663724393,10321,27.5212619304657,0.0757436752319336,"select i_item_id,i_item_desc,i_category,i_class,i_current_price,sum(ws_ext_sales_price) as itemrevenue,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales,item,date_dim where ws_item_sk = i_item_sk and i_category in ('Men','Books','Electronics') and ws_sold_date_sk = d_date_sk and d_date between cast('2001-06-15' as date) and (cast('2001-06-15' as date) + interval '30' day) group by i_item_id,i_item_desc,i_category,i_class,i_current_price order by i_category,i_class,i_item_id,i_item_desc,revenueratio limit 100 "
13,Statistical,No Regression,prompt3,2.099171194633211,1.7293120850808918,321.7184021610301,17873,39.106425046920776,0.3886134624481201," WITH filtered_sales AS ( SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost, ss_sales_price, ss_net_profit, ss_store_sk, ss_sold_date_sk, ss_hdemo_sk, ss_cdemo_sk, ss_addr_sk FROM store_sales WHERE (ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 100 AND 200) OR (ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 150 AND 300) OR (ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 50 AND 250) ), filtered_customers AS ( SELECT cd_demo_sk, cd_marital_status, cd_education_status FROM customer_demographics WHERE (cd_marital_status = 'M' AND cd_education_status = 'College') OR (cd_marital_status = 'D' AND cd_education_status = 'Primary') OR (cd_marital_status = 'W' AND cd_education_status = '2 yr Degree') ), filtered_households AS ( SELECT hd_demo_sk, hd_dep_count FROM household_demographics WHERE (hd_dep_count = 3) OR (hd_dep_count = 1) ), filtered_addresses AS ( SELECT ca_address_sk, ca_country, ca_state FROM customer_address WHERE ca_country = 'United States' AND (ca_state IN ('IL', 'TN', 'TX') OR ca_state IN ('WY', 'OH', 'ID') OR ca_state IN ('MS', 'SC', 'IA')) ), filtered_dates AS ( SELECT d_date_sk FROM date_dim WHERE d_year = 2001 ) SELECT AVG(ss_quantity), AVG(ss_ext_sales_price), AVG(ss_ext_wholesale_cost), SUM(ss_ext_wholesale_cost) FROM filtered_sales JOIN store ON s_store_sk = ss_store_sk JOIN filtered_customers ON cd_demo_sk = ss_cdemo_sk JOIN filtered_households ON ss_hdemo_sk = hd_demo_sk JOIN filtered_addresses ON ss_addr_sk = ca_address_sk JOIN filtered_dates ON ss_sold_date_sk = d_date_sk WHERE (cd_marital_status = 'M' AND cd_education_status = 'College' AND hd_dep_count = 3) OR (cd_marital_status = 'D' AND cd_education_status = 'Primary' AND hd_dep_count = 1) OR (cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' AND hd_dep_count = 1) "
14,Statistical,Potential Regression,Original,1,0.34761596051976085,79.64135938230902,3473,25.460898876190186,2.127584934234619,select * from customer
15,Statistical,No Regression,rule_3,1.001565343630673,0.63999247783795,151.62478416156955,12580,25.48930859565735,0.13271689414978027," select ca_zip, sum(cs_sales_price) from catalog_sales, customer, customer_address, date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and (ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 2001 group by ca_zip order by ca_zip limit 100 "
16,Statistical,No Regression,rule_2,1.000754866830934,3.0050628629978746,130.02868164889514,16978,37.75696611404419,1.1240687370300293," SELECT COUNT(DISTINCT cs_order_number) AS ""order count"", SUM(cs_ext_ship_cost) AS ""total shipping cost"", SUM(cs_net_profit) AS ""total net profit"" FROM catalog_sales cs1 JOIN date_dim ON cs1.cs_ship_date_sk = d_date_sk JOIN customer_address ON cs1.cs_ship_addr_sk = ca_address_sk JOIN call_center ON cs1.cs_call_center_sk = cc_call_center_sk WHERE d_date BETWEEN '2002-4-01' AND (CAST('2002-4-01' AS date) + INTERVAL '60' day) AND ca_state = 'PA' AND cc_county IN ('Williamson County') AND EXISTS ( SELECT 1 FROM catalog_sales cs2 WHERE cs1.cs_order_number = cs2.cs_order_number AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk ) AND NOT EXISTS ( SELECT 1 FROM catalog_returns cr1 WHERE cs1.cs_order_number = cr1.cr_order_number ) ORDER BY COUNT(DISTINCT cs_order_number) LIMIT 100 "
17,Statistical,No Regression,rule_6,1.3713082479200442,0.8026887713931501,153.93714319658466,9489,30.731749057769775,0.42357921600341797,"with filtered_date_dim as (select * from date_dim where d_quarter_name IN ('2001Q1','2001Q2','2001Q3')) select i_item_id,i_item_desc,s_state,count(ss_quantity) as store_sales_quantitycount,avg(ss_quantity) as store_sales_quantityave,stddev_samp(ss_quantity) as store_sales_quantitystdev,stddev_samp(ss_quantity) / avg(ss_quantity) as store_sales_quantitycov,count(sr_return_quantity) as store_returns_quantitycount,avg(sr_return_quantity) as store_returns_quantityave,stddev_samp(sr_return_quantity) as store_returns_quantitystdev,stddev_samp(sr_return_quantity) / avg(sr_return_quantity) as store_returns_quantitycov,count(cs_quantity) as catalog_sales_quantitycount,avg(cs_quantity) as catalog_sales_quantityave,stddev_samp(cs_quantity) as catalog_sales_quantitystdev,stddev_samp(cs_quantity) / avg(cs_quantity) as catalog_sales_quantitycov from store_sales,store_returns,catalog_sales,filtered_date_dim d1,filtered_date_dim d2,filtered_date_dim d3,store,item where d1.d_quarter_name = '2001Q1' and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk group by i_item_id,i_item_desc,s_state order by i_item_id,i_item_desc,s_state limit 100"
18,Statistical,Potential Regression,rule_1,3.6852533855164613,2.230410068295896,522.3304135468788,27947,31.987760066986084,1.702017068862915," with customer_demographics_cte as ( select cd_demo_sk, cd_dep_count, cd_gender, cd_education_status from customer_demographics ), customer_address_cte as ( select ca_address_sk, ca_country, ca_state, ca_county from customer_address where ca_state in ('AL','MO','TN','GA','MT','IN','CA') ), date_dim_cte as ( select d_date_sk from date_dim where d_year = 2001 ), customer_cte as ( select c_customer_sk, c_current_cdemo_sk, c_current_addr_sk, c_birth_year, c_birth_month from customer where c_birth_month in (1,3,7,11,10,4) ), item_cte as ( select i_item_sk, i_item_id from item ) select i_item_id, ca_country, ca_state, ca_county, avg(cast(cs_quantity as decimal(12,2))) agg1, avg(cast(cs_list_price as decimal(12,2))) agg2, avg(cast(cs_coupon_amt as decimal(12,2))) agg3, avg(cast(cs_sales_price as decimal(12,2))) agg4, avg(cast(cs_net_profit as decimal(12,2))) agg5, avg(cast(c_birth_year as decimal(12,2))) agg6, avg(cast(cd1.cd_dep_count as decimal(12,2))) agg7 from catalog_sales join customer_demographics_cte cd1 on cs_bill_cdemo_sk = cd1.cd_demo_sk join customer_cte on cs_bill_customer_sk = c_customer_sk join customer_demographics_cte cd2 on c_current_cdemo_sk = cd2.cd_demo_sk join customer_address_cte on c_current_addr_sk = ca_address_sk join date_dim_cte on cs_sold_date_sk = d_date_sk join item_cte on cs_item_sk = i_item_sk where cd1.cd_gender = 'F' and cd1.cd_education_status = 'Primary' group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country, ca_state, ca_county, i_item_id limit 100 "
19,Statistical,No Regression,Original,1,0.8065717893186957,120.72602374339476,10493,21.739330291748047,0.19887948036193848,"select i_brand_id brand_id,i_brand brand,i_manufact_id,i_manufact,sum(ss_ext_sales_price) ext_price from date_dim,store_sales,item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=14 and d_moy=11 and d_year=2002 and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and substr(ca_zip,1,5) <> substr(s_zip,1,5) and ss_store_sk = s_store_sk group by i_brand,i_brand_id,i_manufact_id,i_manufact order by ext_price desc,i_brand,i_brand_id,i_manufact_id,i_manufact limit 100  "
20,Statistical,No Regression,Original,1,0.326324247289449,172.77107266522944,10830,21.151937007904053,0.09513998031616211,"select i_item_id,i_item_desc,i_category,i_class,i_current_price,sum(cs_ext_sales_price) as itemrevenue,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from catalog_sales,item,date_dim where cs_item_sk = i_item_sk and i_category in ('Books','Music','Sports') and cs_sold_date_sk = d_date_sk and d_date between cast('2002-06-18' as date) and (cast('2002-06-18' as date) + interval '30' day) group by i_item_id,i_item_desc,i_category,i_class,i_current_price order by i_category,i_class,i_item_id,i_item_desc,revenueratio limit 100 "
21,Statistical,No Regression,Original,1,0.5120092981960624,172.89090366382152,12452,24.425201654434204,0.08992338180541992,"select * from(select w_warehouse_name,i_item_id,sum(case when (cast(d_date as date) < cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_before,sum(case when (cast(d_date as date) >= cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory,warehouse,item,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' as date) - interval '30' day) and (cast ('1999-06-22' as date) + interval '30' day) group by w_warehouse_name,i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name,i_item_id limit 100 "
22,Statistical,No Regression,Original,1,1.2725782301276922,82.93576561030932,7754,20.984156370162964,0.46389126777648926,"select i_product_name,i_brand,i_class,i_category,avg(inv_quantity_on_hand) qoh from inventory,date_dim,item where inv_date_sk = d_date_sk and inv_item_sk = i_item_sk and d_month_seq between 1200 and 1200 + 11 group by rollup( i_product_name,i_brand,i_class,i_category ) order by qoh,i_product_name,i_brand,i_class,i_category limit 100"
23,Statistical,No Regression,Original,1,2.6033130236901343,36.62848052405752,2997,15.14614748954773,2.0729551315307617,select * from customer
24,None,None,None,1,0,0,0,0,0,None
25,Statistical,No Regression,Original,1,4.313961882609874,243.75805145758204,11449,30.824588537216187,0.7349674701690674,"select i_item_id,i_item_desc,s_store_id,s_store_name,max(ss_net_profit) as store_sales_profit,max(sr_net_loss) as store_returns_loss,max(cs_net_profit) as catalog_sales_profit from store_sales,store_returns,catalog_sales,date_dim d1,date_dim d2,date_dim d3,store,item where d1.d_moy = 4 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy between 4 and 10 and d2.d_year = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy between 4 and 10 and d3.d_year = 1999 group by i_item_id,i_item_desc,s_store_id,s_store_name order by i_item_id,i_item_desc,s_store_id,s_store_name limit 100 "
26,Statistical,Potential Regression,Original,1,0.2613608343526721,75.94789078296162,5237,28.028216123580933,0.2957463264465332,"select i_item_id,avg(cs_quantity) agg1,avg(cs_list_price) agg2,avg(cs_coupon_amt) agg3,avg(cs_sales_price) agg4 from catalog_sales,customer_demographics,date_dim,item,promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'M' and cd_marital_status = 'W' and cd_education_status = 'Unknown' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2002 group by i_item_id order by i_item_id limit 100 "
27,Statistical,No Regression,MCTS,1.0397774846270633,4.592184861889109,119.61734600784257,19015,18.492943286895752,1.0262715816497803,"select i_item_id,s_state,grouping(s_state) g_state,avg(ss_quantity) agg1,avg(ss_list_price) agg2,avg(ss_coupon_amt) agg3,avg(ss_sales_price) agg4 from store_sales,customer_demographics,date_dim,store,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'W' and cd_education_status = 'Secondary' and d_year = 1999 and exists (select 1 from store where s_state = store.s_state and s_state in ('TN','TN','TN','TN','TN','TN')) group by rollup (i_item_id,s_state) order by i_item_id,s_state limit 100"
28,Statistical,No Regression,rule_2,1.8730746664841815,7.2256168513558805,206.61699909949675,12282,29.74621558189392,9.595898151397705," SELECT AVG(CASE WHEN ss_quantity BETWEEN 0 AND 5 AND (ss_list_price BETWEEN 107 AND 117 OR ss_coupon_amt BETWEEN 1319 AND 2319 OR ss_wholesale_cost BETWEEN 60 AND 80) THEN ss_list_price END) AS B1_LP, COUNT(CASE WHEN ss_quantity BETWEEN 0 AND 5 AND (ss_list_price BETWEEN 107 AND 117 OR ss_coupon_amt BETWEEN 1319 AND 2319 OR ss_wholesale_cost BETWEEN 60 AND 80) THEN ss_list_price END) AS B1_CNT, COUNT(DISTINCT CASE WHEN ss_quantity BETWEEN 0 AND 5 AND (ss_list_price BETWEEN 107 AND 117 OR ss_coupon_amt BETWEEN 1319 AND 2319 OR ss_wholesale_cost BETWEEN 60 AND 80) THEN ss_list_price END) AS B1_CNTD, AVG(CASE WHEN ss_quantity BETWEEN 6 AND 10 AND (ss_list_price BETWEEN 23 AND 33 OR ss_coupon_amt BETWEEN 825 AND 1825 OR ss_wholesale_cost BETWEEN 43 AND 63) THEN ss_list_price END) AS B2_LP, COUNT(CASE WHEN ss_quantity BETWEEN 6 AND 10 AND (ss_list_price BETWEEN 23 AND 33 OR ss_coupon_amt BETWEEN 825 AND 1825 OR ss_wholesale_cost BETWEEN 43 AND 63) THEN ss_list_price END) AS B2_CNT, COUNT(DISTINCT CASE WHEN ss_quantity BETWEEN 6 AND 10 AND (ss_list_price BETWEEN 23 AND 33 OR ss_coupon_amt BETWEEN 825 AND 1825 OR ss_wholesale_cost BETWEEN 43 AND 63) THEN ss_list_price END) AS B2_CNTD, AVG(CASE WHEN ss_quantity BETWEEN 11 AND 15 AND (ss_list_price BETWEEN 74 AND 84 OR ss_coupon_amt BETWEEN 4381 AND 5381 OR ss_wholesale_cost BETWEEN 57 AND 77) THEN ss_list_price END) AS B3_LP, COUNT(CASE WHEN ss_quantity BETWEEN 11 AND 15 AND (ss_list_price BETWEEN 74 AND 84 OR ss_coupon_amt BETWEEN 4381 AND 5381 OR ss_wholesale_cost BETWEEN 57 AND 77) THEN ss_list_price END) AS B3_CNT, COUNT(DISTINCT CASE WHEN ss_quantity BETWEEN 11 AND 15 AND (ss_list_price BETWEEN 74 AND 84 OR ss_coupon_amt BETWEEN 4381 AND 5381 OR ss_wholesale_cost BETWEEN 57 AND 77) THEN ss_list_price END) AS B3_CNTD, AVG(CASE WHEN ss_quantity BETWEEN 16 AND 20 AND (ss_list_price BETWEEN 89 AND 99 OR ss_coupon_amt BETWEEN 3117 AND 4117 OR ss_wholesale_cost BETWEEN 68 AND 88) THEN ss_list_price END) AS B4_LP, COUNT(CASE WHEN ss_quantity BETWEEN 16 AND 20 AND (ss_list_price BETWEEN 89 AND 99 OR ss_coupon_amt BETWEEN 3117 AND 4117 OR ss_wholesale_cost BETWEEN 68 AND 88) THEN ss_list_price END) AS B4_CNT, COUNT(DISTINCT CASE WHEN ss_quantity BETWEEN 16 AND 20 AND (ss_list_price BETWEEN 89 AND 99 OR ss_coupon_amt BETWEEN 3117 AND 4117 OR ss_wholesale_cost BETWEEN 68 AND 88) THEN ss_list_price END) AS B4_CNTD, AVG(CASE WHEN ss_quantity BETWEEN 21 AND 25 AND (ss_list_price BETWEEN 58 AND 68 OR ss_coupon_amt BETWEEN 9402 AND 10402 OR ss_wholesale_cost BETWEEN 38 AND 58) THEN ss_list_price END) AS B5_LP, COUNT(CASE WHEN ss_quantity BETWEEN 21 AND 25 AND (ss_list_price BETWEEN 58 AND 68 OR ss_coupon_amt BETWEEN 9402 AND 10402 OR ss_wholesale_cost BETWEEN 38 AND 58) THEN ss_list_price END) AS B5_CNT, COUNT(DISTINCT CASE WHEN ss_quantity BETWEEN 21 AND 25 AND (ss_list_price BETWEEN 58 AND 68 OR ss_coupon_amt BETWEEN 9402 AND 10402 OR ss_wholesale_cost BETWEEN 38 AND 58) THEN ss_list_price END) AS B5_CNTD, AVG(CASE WHEN ss_quantity BETWEEN 26 AND 30 AND (ss_list_price BETWEEN 64 AND 74 OR ss_coupon_amt BETWEEN 5792 AND 6792 OR ss_wholesale_cost BETWEEN 73 AND 93) THEN ss_list_price END) AS B6_LP, COUNT(CASE WHEN ss_quantity BETWEEN 26 AND 30 AND (ss_list_price BETWEEN 64 AND 74 OR ss_coupon_amt BETWEEN 5792 AND 6792 OR ss_wholesale_cost BETWEEN 73 AND 93) THEN ss_list_price END) AS B6_CNT, COUNT(DISTINCT CASE WHEN ss_quantity BETWEEN 26 AND 30 AND (ss_list_price BETWEEN 64 AND 74 OR ss_coupon_amt BETWEEN 5792 AND 6792 OR ss_wholesale_cost BETWEEN 73 AND 93) THEN ss_list_price END) AS B6_CNTD FROM store_sales WHERE (ss_quantity BETWEEN 0 AND 5 AND (ss_list_price BETWEEN 107 AND 117 OR ss_coupon_amt BETWEEN 1319 AND 2319 OR ss_wholesale_cost BETWEEN 60 AND 80)) OR (ss_quantity BETWEEN 6 AND 10 AND (ss_list_price BETWEEN 23 AND 33 OR ss_coupon_amt BETWEEN 825 AND 1825 OR ss_wholesale_cost BETWEEN 43 AND 63)) OR (ss_quantity BETWEEN 11 AND 15 AND (ss_list_price BETWEEN 74 AND 84 OR ss_coupon_amt BETWEEN 4381 AND 5381 OR ss_wholesale_cost BETWEEN 57 AND 77)) OR (ss_quantity BETWEEN 16 AND 20 AND (ss_list_price BETWEEN 89 AND 99 OR ss_coupon_amt BETWEEN 3117 AND 4117 OR ss_wholesale_cost BETWEEN 68 AND 88)) OR (ss_quantity BETWEEN 21 AND 25 AND (ss_list_price BETWEEN 58 AND 68 OR ss_coupon_amt BETWEEN 9402 AND 10402 OR ss_wholesale_cost BETWEEN 38 AND 58)) OR (ss_quantity BETWEEN 26 AND 30 AND (ss_list_price BETWEEN 64 AND 74 OR ss_coupon_amt BETWEEN 5792 AND 6792 OR ss_wholesale_cost BETWEEN 73 AND 93)) LIMIT 100 "
29,Statistical,No Regression,rule_6,6.524827973027342,1.1651067102793604,103.68959862668999,8191,22.40999674797058,0.40841031074523926,"with filtered_date_dim as (select * from date_dim where d_year = 1998) select i_item_id,i_item_desc,s_store_id,s_store_name,max(ss_quantity) as store_sales_quantity,max(sr_return_quantity) as store_returns_quantity,max(cs_quantity) as catalog_sales_quantity from store_sales,store_returns,catalog_sales,filtered_date_dim d1,filtered_date_dim d2,date_dim d3,store,item where d1.d_moy = 4 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy between 4 and 4 + 3 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_year in (1998,1998+1,1998+2) group by i_item_id,i_item_desc,s_store_id,s_store_name order by i_item_id,i_item_desc,s_store_id,s_store_name limit 100 "
