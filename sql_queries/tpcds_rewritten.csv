Query id,Provable_status,Regression_status,Source,Speedup,Total_semantic_time,Total_generation_time,Total_Tokens_used,Mutant_database_creation_time,Final_check_time,Best_Query
1,Statistical,No Regression,prompt1,27.98073909,98.52689279,48.81730816,5247,50.68248224,34.03752327," WITH customer_total_return AS ( SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, SUM(sr_fee) AS ctr_total_return FROM store_returns JOIN date_dim ON sr_returned_date_sk = d_date_sk WHERE d_year = 2000 GROUP BY sr_customer_sk, sr_store_sk ), average_total_return AS ( SELECT ctr_store_sk, AVG(ctr_total_return) * 1.2 AS avg_total_return FROM customer_total_return GROUP BY ctr_store_sk ) SELECT c_customer_id FROM customer_total_return ctr1 JOIN store ON ctr1.ctr_store_sk = s_store_sk JOIN customer ON ctr1.ctr_customer_sk = c_customer_sk JOIN average_total_return atr ON ctr1.ctr_store_sk = atr.ctr_store_sk WHERE ctr1.ctr_total_return > atr.avg_total_return AND s_state = 'TN' ORDER BY c_customer_id LIMIT 100 "
2,Statistical,No Regression,Original,1,10.91482243,90.48999551,13851,71.09593344,122.2189219,"with wscs as (select sold_date_sk,sales_price from (select ws_sold_date_sk sold_date_sk,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk,cs_ext_sales_price sales_price from catalog_sales) as tmp),wswscs as (select d_week_seq,sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales,sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1,round(sun_sales1/sun_sales2,2),round(mon_sales1/mon_sales2,2),round(tue_sales1/tue_sales2,2),round(wed_sales1/wed_sales2,2),round(thu_sales1/thu_sales2,2),round(fri_sales1/fri_sales2,2),round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1,sun_sales sun_sales1,mon_sales mon_sales1,tue_sales tue_sales1,wed_sales wed_sales1,thu_sales thu_sales1,fri_sales fri_sales1,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y,(select wswscs.d_week_seq d_week_seq2,sun_sales sun_sales2,mon_sales mon_sales2,tue_sales tue_sales2,wed_sales wed_sales2,thu_sales thu_sales2,fri_sales fri_sales2,sat_sales sat_sales2 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1"
3,Provable,Potential Regression,Original,1,2.258922836,29.76592342,4338,35.75623465,2.27342248,"select dt.d_year,item.i_brand_id brand_id,item.i_brand brand,sum(ss_sales_price) sum_agg from date_dim dt,store_sales,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manufact_id = 816 and dt.d_moy=11 group by dt.d_year,item.i_brand,item.i_brand_id order by dt.d_year,sum_agg desc,brand_id limit 100 "
4,Statistical,No Regression,Original,1,347.5900102,164.4416612,25424,107.5191586,269.0227499,"with year_total as ( select c_customer_id customer_id,c_first_name customer_first_name,c_last_name customer_last_name,c_preferred_cust_flag customer_preferred_cust_flag,c_birth_country customer_birth_country,c_login customer_login,c_email_address customer_email_address,d_year dyear,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total,'s' sale_type from customer,store_sales,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id,c_first_name,c_last_name,c_preferred_cust_flag,c_birth_country,c_login,c_email_address,d_year union all select c_customer_id customer_id,c_first_name customer_first_name,c_last_name customer_last_name,c_preferred_cust_flag customer_preferred_cust_flag,c_birth_country customer_birth_country,c_login customer_login,c_email_address customer_email_address,d_year dyear,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total,'c' sale_type from customer,catalog_sales,date_dim where c_customer_sk = cs_bill_customer_sk and cs_sold_date_sk = d_date_sk group by c_customer_id,c_first_name,c_last_name,c_preferred_cust_flag,c_birth_country,c_login,c_email_address,d_year union all select c_customer_id customer_id,c_first_name customer_first_name,c_last_name customer_last_name,c_preferred_cust_flag customer_preferred_cust_flag,c_birth_country customer_birth_country,c_login customer_login,c_email_address customer_email_address,d_year dyear,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total,'w' sale_type from customer,web_sales,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id,c_first_name,c_last_name,c_preferred_cust_flag,c_birth_country,c_login,c_email_address,d_year ) select t_s_secyear.customer_id,t_s_secyear.customer_first_name,t_s_secyear.customer_last_name,t_s_secyear.customer_birth_country from year_total t_s_firstyear,year_total t_s_secyear,year_total t_c_firstyear,year_total t_c_secyear,year_total t_w_firstyear,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_c_secyear.customer_id and t_s_firstyear.customer_id = t_c_firstyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.sale_type = 's' and t_c_firstyear.sale_type = 'c' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_c_secyear.sale_type = 'c' and t_w_secyear.sale_type = 'w' and t_s_firstyear.dyear = 1999 and t_s_secyear.dyear = 1999 and t_c_firstyear.dyear = 1999 and t_c_secyear.dyear = 1999 and t_w_firstyear.dyear = 1999 and t_w_secyear.dyear = 1999 and t_s_firstyear.year_total > 0 and t_c_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end >= case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end >= case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end order by t_s_secyear.customer_id,t_s_secyear.customer_first_name,t_s_secyear.customer_last_name,t_s_secyear.customer_birth_country limit 100 "
5,Statistical,No Regression,prompt1,1.9015224,35.0320921,362.6845081,17013,109.3128545,12.68599844," WITH date_filtered AS ( SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-08-19' AND '2000-09-02' ), ssr AS ( SELECT s_store_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns, SUM(net_loss) AS profit_loss FROM ( SELECT ss_store_sk AS store_sk, ss_ext_sales_price AS sales_price, ss_net_profit AS profit, 0::decimal(7,2) AS return_amt, 0::decimal(7,2) AS net_loss FROM store_sales WHERE ss_sold_date_sk IN (SELECT d_date_sk FROM date_filtered) UNION ALL SELECT sr_store_sk AS store_sk, 0::decimal(7,2) AS sales_price, 0::decimal(7,2) AS profit, sr_return_amt AS return_amt, sr_net_loss AS net_loss FROM store_returns WHERE sr_returned_date_sk IN (SELECT d_date_sk FROM date_filtered) ) salesreturns JOIN store ON store_sk = s_store_sk GROUP BY s_store_id ), csr AS ( SELECT cp_catalog_page_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns, SUM(net_loss) AS profit_loss FROM ( SELECT cs_catalog_page_sk AS page_sk, cs_ext_sales_price AS sales_price, cs_net_profit AS profit, 0::decimal(7,2) AS return_amt, 0::decimal(7,2) AS net_loss FROM catalog_sales WHERE cs_sold_date_sk IN (SELECT d_date_sk FROM date_filtered) UNION ALL SELECT cr_catalog_page_sk AS page_sk, 0::decimal(7,2) AS sales_price, 0::decimal(7,2) AS profit, cr_return_amount AS return_amt, cr_net_loss AS net_loss FROM catalog_returns WHERE cr_returned_date_sk IN (SELECT d_date_sk FROM date_filtered) ) salesreturns JOIN catalog_page ON page_sk = cp_catalog_page_sk GROUP BY cp_catalog_page_id ), wsr AS ( SELECT web_site_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns, SUM(net_loss) AS profit_loss FROM ( SELECT ws_web_site_sk AS wsr_web_site_sk, ws_ext_sales_price AS sales_price, ws_net_profit AS profit, 0::decimal(7,2) AS return_amt, 0::decimal(7,2) AS net_loss FROM web_sales WHERE ws_sold_date_sk IN (SELECT d_date_sk FROM date_filtered) UNION ALL SELECT ws_web_site_sk AS wsr_web_site_sk, 0::decimal(7,2) AS sales_price, 0::decimal(7,2) AS profit, wr_return_amt AS return_amt, wr_net_loss AS net_loss FROM web_returns LEFT JOIN web_sales ON (wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number) WHERE wr_returned_date_sk IN (SELECT d_date_sk FROM date_filtered) ) salesreturns JOIN web_site ON wsr_web_site_sk = web_site_sk GROUP BY web_site_id ) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM ( SELECT 'store channel' AS channel, 'store' || s_store_id AS id, sales, returns, (profit - profit_loss) AS profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || cp_catalog_page_id AS id, sales, returns, (profit - profit_loss) AS profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, (profit - profit_loss) AS profit FROM wsr ) x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100 "
6,Statistical,No Regression,prompt1,222.033369,15.05979875,42.21236739,5112,42.23822141,27.09632778," WITH date_seq AS ( SELECT DISTINCT d_month_seq FROM date_dim WHERE d_year = 2002 AND d_moy = 3 ), avg_price AS ( SELECT i_category, AVG(i_current_price) AS avg_price FROM item GROUP BY i_category ) SELECT a.ca_state AS state, COUNT(*) AS cnt FROM customer_address a JOIN customer c ON a.ca_address_sk = c.c_current_addr_sk JOIN store_sales s ON c.c_customer_sk = s.ss_customer_sk JOIN date_dim d ON s.ss_sold_date_sk = d.d_date_sk JOIN item i ON s.ss_item_sk = i.i_item_sk JOIN date_seq ds ON d.d_month_seq = ds.d_month_seq JOIN avg_price ap ON i.i_category = ap.i_category WHERE i.i_current_price > 1.2 * ap.avg_price GROUP BY a.ca_state HAVING COUNT(*) >= 10 ORDER BY cnt, a.ca_state LIMIT 100 "
7,Provable,No Regression,Original,1,5.575904134,7.145847649,768,59.54447055,5.311270952,"select i_item_id,avg(ss_quantity) agg1,avg(ss_list_price) agg2,avg(ss_coupon_amt) agg3,avg(ss_sales_price) agg4 from store_sales,customer_demographics,date_dim,item,promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'W' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id limit 100 "
8,Provable,No Regression,Original,1,0.815814883,1019.236786,24705,128.4173794,3.020742655,"select s_store_name,sum(ss_net_profit) from store_sales,date_dim,store,(select ca_zip from ( SELECT substr(ca_zip,1,5) ca_zip FROM customer_address WHERE substr(ca_zip,1,5) IN ( '47602','16704','35863','28577','83910','36201','58412','48162','28055','41419','80332','38607','77817','24891','16226','18410','21231','59345','13918','51089','20317','17167','54585','67881','78366','47770','18360','51717','73108','14440','21800','89338','45859','65501','34948','25973','73219','25333','17291','10374','18829','60736','82620','41351','52094','19326','25214','54207','40936','21814','79077','25178','75742','77454','30621','89193','27369','41232','48567','83041','71948','37119','68341','14073','16891','62878','49130','19833','24286','27700','40979','50412','81504','94835','84844','71954','39503','57649','18434','24987','12350','86379','27413','44529','98569','16515','27287','24255','21094','16005','56436','91110','68293','56455','54558','10298','83647','32754','27052','51766','19444','13869','45645','94791','57631','20712','37788','41807','46507','21727','71836','81070','50632','88086','63991','20244','31655','51782','29818','63792','68605','94898','36430','57025','20601','82080','33869','22728','35834','29086','92645','98584','98072','11652','78093','57553','43830','71144','53565','18700','90209','71256','38353','54364','28571','96560','57839','56355','50679','45266','84680','34306','34972','48530','30106','15371','92380','84247','92292','68852','13338','34594','82602','70073','98069','85066','47289','11686','98862','26217','47529','63294','51793','35926','24227','14196','24594','32489','99060','49472','43432','49211','14312','88137','47369','56877','20534','81755','15794','12318','21060','73134','41255','63073','81003','73873','66057','51184','51195','45676','92696','70450','90669','98338','25264','38919','59226','58581','60298','17895','19489','52301','80846','95464','68770','51634','19988','18367','18421','11618','67975','25494','41352','95430','15734','62585','97173','33773','10425','75675','53535','17879','41967','12197','67998','79658','59130','72592','14851','43933','68101','50636','25717','71286','24660','58058','72991','95042','15543','33122','69280','11912','59386','27642','65177','17672','33467','64592','36335','54010','18767','63193','42361','49254','33113','33159','36479','59080','11855','81963','31016','49140','29392','41836','32958','53163','13844','73146','23952','65148','93498','14530','46131','58454','13376','13378','83986','12320','17193','59852','46081','98533','52389','13086','68843','31013','13261','60560','13443','45533','83583','11489','58218','19753','22911','25115','86709','27156','32669','13123','51933','39214','41331','66943','14155','69998','49101','70070','35076','14242','73021','59494','15782','29752','37914','74686','83086','34473','15751','81084','49230','91894','60624','17819','28810','63180','56224','39459','55233','75752','43639','55349','86057','62361','50788','31830','58062','18218','85761','60083','45484','21204','90229','70041','41162','35390','16364','39500','68908','26689','52868','81335','40146','11340','61527','61794','71997','30415','59004','29450','58117','69952','33562','83833','27385','61860','96435','48333','23065','32961','84919','61997','99132','22815','56600','68730','48017','95694','32919','88217','27116','28239','58032','18884','16791','21343','97462','18569','75660','15475') intersect select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM customer_address,customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1998 and (substr(s_zip,0,1) = substr(V1.ca_zip,0,1)) group by s_store_name order by s_store_name limit 100 "
9,Statistical,No Regression,prompt1,1.881285142,42.12595136,743.4596781,7922,66.03327179,154.3916595," WITH sales_data AS ( SELECT ss_quantity, ss_ext_tax, ss_net_paid_inc_tax FROM store_sales ), bucket_counts AS ( SELECT SUM(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN 1 ELSE 0 END) AS count1, SUM(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN 1 ELSE 0 END) AS count2, SUM(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN 1 ELSE 0 END) AS count3, SUM(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN 1 ELSE 0 END) AS count4, SUM(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN 1 ELSE 0 END) AS count5 FROM sales_data ), bucket_averages AS ( SELECT AVG(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN ss_ext_tax ELSE NULL END) AS avg_ext_tax1, AVG(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN ss_net_paid_inc_tax ELSE NULL END) AS avg_net_paid1, AVG(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN ss_ext_tax ELSE NULL END) AS avg_ext_tax2, AVG(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN ss_net_paid_inc_tax ELSE NULL END) AS avg_net_paid2, AVG(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN ss_ext_tax ELSE NULL END) AS avg_ext_tax3, AVG(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN ss_net_paid_inc_tax ELSE NULL END) AS avg_net_paid3, AVG(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN ss_ext_tax ELSE NULL END) AS avg_ext_tax4, AVG(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN ss_net_paid_inc_tax ELSE NULL END) AS avg_net_paid4, AVG(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN ss_ext_tax ELSE NULL END) AS avg_ext_tax5, AVG(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN ss_net_paid_inc_tax ELSE NULL END) AS avg_net_paid5 FROM sales_data ) SELECT CASE WHEN count1 > 1071 THEN avg_ext_tax1 ELSE avg_net_paid1 END AS bucket1, CASE WHEN count2 > 39161 THEN avg_ext_tax2 ELSE avg_net_paid2 END AS bucket2, CASE WHEN count3 > 29434 THEN avg_ext_tax3 ELSE avg_net_paid3 END AS bucket3, CASE WHEN count4 > 6568 THEN avg_ext_tax4 ELSE avg_net_paid4 END AS bucket4, CASE WHEN count5 > 21216 THEN avg_ext_tax5 ELSE avg_net_paid5 END AS bucket5 FROM bucket_counts, bucket_averages WHERE EXISTS (SELECT 1 FROM reason WHERE r_reason_sk = 1) "
10,Provable,No Regression,Original,1,3.765049984,1001.336676,13341,111.2854881,8.061022997,"select cd_gender,cd_marital_status,cd_education_status,count(*) cnt1,cd_purchase_estimate,count(*) cnt2,cd_credit_rating,count(*) cnt3,cd_dep_count,count(*) cnt4,cd_dep_employed_count,count(*) cnt5,cd_dep_college_count,count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Fairfield County','Campbell County','Washtenaw County','Escambia County','Cleburne County','United States','1') and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 and 12) and (exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 ANd 12) or exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_moy between 1 and 12)) group by cd_gender,cd_marital_status,cd_education_status,cd_purchase_estimate,cd_credit_rating,cd_dep_count,cd_dep_employed_count,cd_dep_college_count order by cd_gender,cd_marital_status,cd_education_status,cd_purchase_estimate,cd_credit_rating,cd_dep_count,cd_dep_employed_count,cd_dep_college_count limit 100 "
11,Statistical,No Regression,Original,1,79.43688854,474.8231259,21166,76.73559475,155.4826849,"with year_total as ( select c_customer_id customer_id,c_first_name customer_first_name,c_last_name customer_last_name,c_preferred_cust_flag customer_preferred_cust_flag,c_birth_country customer_birth_country,c_login customer_login,c_email_address customer_email_address,d_year dyear,sum(ss_ext_list_price-ss_ext_discount_amt) year_total,'s' sale_type from customer,store_sales,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id,c_first_name,c_last_name,c_preferred_cust_flag,c_birth_country,c_login,c_email_address,d_year union all select c_customer_id customer_id,c_first_name customer_first_name,c_last_name customer_last_name,c_preferred_cust_flag customer_preferred_cust_flag,c_birth_country customer_birth_country,c_login customer_login,c_email_address customer_email_address,d_year dyear,sum(ws_ext_list_price-ws_ext_discount_amt) year_total,'w' sale_type from customer,web_sales,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id,c_first_name,c_last_name,c_preferred_cust_flag,c_birth_country,c_login,c_email_address,d_year ) select t_s_secyear.customer_id,t_s_secyear.customer_first_name,t_s_secyear.customer_last_name,t_s_secyear.customer_email_address from year_total t_s_firstyear,year_total t_s_secyear,year_total t_w_firstyear,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.sale_type = 's' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_w_secyear.sale_type = 'w' and t_s_firstyear.dyear = 1999 and t_s_secyear.dyear = 1999 and t_w_firstyear.dyear = 1999 and t_w_secyear.dyear = 1999 and t_s_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end >= case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end order by t_s_secyear.customer_id,t_s_secyear.customer_first_name,t_s_secyear.customer_last_name,t_s_secyear.customer_email_address limit 100 "
12,Statistical,Potential Regression,Original,1,0.347966216,99.22460966,5090,51.58995175,2.140149593,"select i_item_id,i_item_desc,i_category,i_class,i_current_price,sum(ws_ext_sales_price) as itemrevenue,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales,item,date_dim where ws_item_sk = i_item_sk and i_category in ('Men','Books','Electronics') and ws_sold_date_sk = d_date_sk and d_date between cast('2001-06-15' as date) and (cast('2001-06-15' as date) + interval '30' day) group by i_item_id,i_item_desc,i_category,i_class,i_current_price order by i_category,i_class,i_item_id,i_item_desc,revenueratio limit 100 "
13,Statistical,No Regression,Original,1,2.014208137,650.5989039,10951,140.750459,120.9748998,"select avg(ss_quantity),avg(ss_ext_sales_price),avg(ss_ext_wholesale_cost),sum(ss_ext_wholesale_cost) from store_sales,store,customer_demographics,household_demographics,customer_address,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'College' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Primary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL','TN','TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('WY','OH','ID') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MS','SC','IA') and ss_net_profit between 50 and 250 ))  "
14,Provable,No Regression,Original,1,6.938701877,26.52305246,1824,19.74895215,3.830038309,select * from customer
15,Provable,No Regression,Original,1,0.102597486,6.623226852,702,48.80425596,1.807226658,"select ca_zip,sum(cs_sales_price) from catalog_sales,customer,customer_address,date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in ('85669','86197','88274','83405','86475','85392','85460','80348','81792') or ca_state in ('CA','WA','GA') or cs_sales_price > 500) and cs_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 2001 group by ca_zip order by ca_zip limit 100 "
16,Provable,No Regression,Original,1,1.27811911,52.92120415,6136,81.25168324,2.998189211,"select count(distinct cs_order_number) as ""order count"",sum(cs_ext_ship_cost) as ""total shipping cost"",sum(cs_net_profit) as ""total net profit"" from catalog_sales cs1,date_dim,customer_address,call_center where d_date between '2002-4-01' and (cast('2002-4-01' as date) + interval '60' day) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'PA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County','Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100 "
17,Provable,No Regression,Original,1,10.63315529,96.46606144,8597,75.2379632,3.112978697,"select i_item_id,i_item_desc,s_state,count(ss_quantity) as store_sales_quantitycount,avg(ss_quantity) as store_sales_quantityave,stddev_samp(ss_quantity) as store_sales_quantitystdev,stddev_samp(ss_quantity) / avg(ss_quantity) as store_sales_quantitycov,count(sr_return_quantity) as store_returns_quantitycount,avg(sr_return_quantity) as store_returns_quantityave,stddev_samp(sr_return_quantity) as store_returns_quantitystdev,stddev_samp(sr_return_quantity) / avg(sr_return_quantity) as store_returns_quantitycov,count(cs_quantity) as catalog_sales_quantitycount,avg(cs_quantity) as catalog_sales_quantityave,stddev_samp(cs_quantity) as catalog_sales_quantitystdev,stddev_samp(cs_quantity) / avg(cs_quantity) as catalog_sales_quantitycov from store_sales,store_returns,catalog_sales,date_dim d1,date_dim d2,date_dim d3,store,item where d1.d_quarter_name = '2001Q1' and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3') and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3') group by i_item_id,i_item_desc,s_state order by i_item_id,i_item_desc,s_state limit 100"
18,Provable,No Regression,Original,1,2.599300295,47.38576264,9512,52.22783542,3.50618124,"select i_item_id,ca_country,ca_state,ca_county,avg( cast(cs_quantity as decimal(12,2))) agg1,avg( cast(cs_list_price as decimal(12,2))) agg2,avg( cast(cs_coupon_amt as decimal(12,2))) agg3,avg( cast(cs_sales_price as decimal(12,2))) agg4,avg( cast(cs_net_profit as decimal(12,2))) agg5,avg( cast(c_birth_year as decimal(12,2))) agg6,avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7 from catalog_sales,customer_demographics cd1,customer_demographics cd2,customer,customer_address,date_dim,item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd1.cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd1.cd_gender = 'F' and cd1.cd_education_status = 'Primary' and c_current_cdemo_sk = cd2.cd_demo_sk and c_current_addr_sk = ca_address_sk and c_birth_month in (1,3,7,11,10,4) and d_year = 2001 and ca_state in ('AL','MO','TN','GA','MT','IN','CA') group by rollup (i_item_id,ca_country,ca_state,ca_county) order by ca_country,ca_state,ca_county,i_item_id limit 100 "
19,Provable,No Regression,Original,1,0.821635936,34.04628584,5520,56.18047595,1.865815639,"select i_brand_id brand_id,i_brand brand,i_manufact_id,i_manufact,sum(ss_ext_sales_price) ext_price from date_dim,store_sales,item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=14 and d_moy=11 and d_year=2002 and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and substr(ca_zip,1,5) <> substr(s_zip,1,5) and ss_store_sk = s_store_sk group by i_brand,i_brand_id,i_manufact_id,i_manufact order by ext_price desc,i_brand,i_brand_id,i_manufact_id,i_manufact limit 100  "
20,Statistical,Potential Regression,Original,1,0.323486351,50.85563572,5288,47.44563365,2.057428837,"select i_item_id,i_item_desc,i_category,i_class,i_current_price,sum(cs_ext_sales_price) as itemrevenue,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from catalog_sales,item,date_dim where cs_item_sk = i_item_sk and i_category in ('Books','Music','Sports') and cs_sold_date_sk = d_date_sk and d_date between cast('2002-06-18' as date) and (cast('2002-06-18' as date) + interval '30' day) group by i_item_id,i_item_desc,i_category,i_class,i_current_price order by i_category,i_class,i_item_id,i_item_desc,revenueratio limit 100 "
21,Statistical,No Regression,Original,1,1.280180507,74.37687342,7393,63.00951242,2.581133366,"select * from(select w_warehouse_name,i_item_id,sum(case when (cast(d_date as date) < cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_before,sum(case when (cast(d_date as date) >= cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory,warehouse,item,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' as date) - interval '30' day) and (cast ('1999-06-22' as date) + interval '30' day) group by w_warehouse_name,i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name,i_item_id limit 100 "
22,Provable,No Regression,Original,1,2.550548521,4.588837069,519,58.41216707,35.91247535,"select i_product_name,i_brand,i_class,i_category,avg(inv_quantity_on_hand) qoh from inventory,date_dim,item where inv_date_sk = d_date_sk and inv_item_sk = i_item_sk and d_month_seq between 1200 and 1200 + 11 group by rollup( i_product_name,i_brand,i_class,i_category ) order by qoh,i_product_name,i_brand,i_class,i_category limit 100"
23,Provable,No Regression,Original,1,2.488286854,2.68132887,177,17.53957653,3.811541796,select * from customer
24,None,None,None,1,0,0,0,0,0,None
25,Statistical,No Regression,Original,1,5.543589604,70.82351037,7588,69.41058421,121.3059475,"select i_item_id,i_item_desc,s_store_id,s_store_name,max(ss_net_profit) as store_sales_profit,max(sr_net_loss) as store_returns_loss,max(cs_net_profit) as catalog_sales_profit from store_sales,store_returns,catalog_sales,date_dim d1,date_dim d2,date_dim d3,store,item where d1.d_moy = 4 and d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy between 4 and 10 and d2.d_year = 1999 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy between 4 and 10 and d3.d_year = 1999 group by i_item_id,i_item_desc,s_store_id,s_store_name order by i_item_id,i_item_desc,s_store_id,s_store_name limit 100 "
26,Provable,No Regression,Original,1,0.980473564,23.48520594,2530,78.10607243,2.384990931,"select i_item_id,avg(cs_quantity) agg1,avg(cs_list_price) agg2,avg(cs_coupon_amt) agg3,avg(cs_sales_price) agg4 from catalog_sales,customer_demographics,date_dim,item,promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = 'M' and cd_marital_status = 'W' and cd_education_status = 'Unknown' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2002 group by i_item_id order by i_item_id limit 100 "
27,Provable,Potential Regression,Original,1,0.723900054,12.79681497,849,50.87506008,3.494737148,"select i_item_id,s_state,grouping(s_state) g_state,avg(ss_quantity) agg1,avg(ss_list_price) agg2,avg(ss_coupon_amt) agg3,avg(ss_sales_price) agg4 from store_sales,customer_demographics,date_dim,store,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'M' and cd_marital_status = 'W' and cd_education_status = 'Secondary' and d_year = 1999 and s_state in ('TN','TN','TN','TN','TN','TN') group by rollup (i_item_id,s_state) order by i_item_id,s_state limit 100"
28,Statistical,No Regression,Original,1,38.76599548,114.996132,11138,70.7358408,137.3827276,"select * from ( select avg(ss_list_price) B1_LP,count(ss_list_price) B1_CNT,count(distinct ss_list_price) B1_CNTD from store_sales where ss_quantity between 0 and 5 and ( ss_list_price between 107 and 107 + 10 or ss_coupon_amt between 1319 and 1319 + 1000 or ss_wholesale_cost between 60 and 60 + 20 ) ) B1,( select avg(ss_list_price) B2_LP,count(ss_list_price) B2_CNT,count(distinct ss_list_price) B2_CNTD from store_sales where ss_quantity between 6 and 10 and ( ss_list_price between 23 and 23 + 10 or ss_coupon_amt between 825 and 825 + 1000 or ss_wholesale_cost between 43 and 43 + 20 ) ) B2,( select avg(ss_list_price) B3_LP,count(ss_list_price) B3_CNT,count(distinct ss_list_price) B3_CNTD from store_sales where ss_quantity between 11 and 15 and ( ss_list_price between 74 and 74 + 10 or ss_coupon_amt between 4381 and 4381 + 1000 or ss_wholesale_cost between 57 and 57 + 20 ) ) B3,( select avg(ss_list_price) B4_LP,count(ss_list_price) B4_CNT,count(distinct ss_list_price) B4_CNTD from store_sales where ss_quantity between 16 and 20 and ( ss_list_price between 89 and 89 + 10 or ss_coupon_amt between 3117 and 3117 + 1000 or ss_wholesale_cost between 68 and 68 + 20 ) ) B4,( select avg(ss_list_price) B5_LP,count(ss_list_price) B5_CNT,count(distinct ss_list_price) B5_CNTD from store_sales where ss_quantity between 21 and 25 and ( ss_list_price between 58 and 58 + 10 or ss_coupon_amt between 9402 and 9402 + 1000 or ss_wholesale_cost between 38 and 38 + 20 ) ) B5,( select avg(ss_list_price) B6_LP,count(ss_list_price) B6_CNT,count(distinct ss_list_price) B6_CNTD from store_sales where ss_quantity between 26 and 30 and ( ss_list_price between 64 and 64 + 10 or ss_coupon_amt between 5792 and 5792 + 1000 or ss_wholesale_cost between 73 and 73 + 20 ) ) B6 limit 100"
29,Statistical,No Regression,Original,1,2.697328986,76.22479925,7057,59.52758718,120.7767181,"select i_item_id,i_item_desc,s_store_id,s_store_name,max(ss_quantity) as store_sales_quantity,max(sr_return_quantity) as store_returns_quantity,max(cs_quantity) as catalog_sales_quantity from store_sales,store_returns,catalog_sales,date_dim d1,date_dim d2,date_dim d3,store,item where d1.d_moy = 4 and d1.d_year = 1998 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy between 4 and 4 + 3 and d2.d_year = 1998 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_year in (1998,1998+1,1998+2) group by i_item_id,i_item_desc,s_store_id,s_store_name order by i_item_id,i_item_desc,s_store_id,s_store_name limit 100 "
30,Statistical,No Regression,prompt1,91.81566282,1.856284228,85.50103547,9931,87.61233282,11.28327417," WITH customer_total_return AS ( SELECT wr_returning_customer_sk AS ctr_customer_sk, ca_state AS ctr_state, SUM(wr_return_amt) AS ctr_total_return FROM web_returns JOIN date_dim ON wr_returned_date_sk = d_date_sk JOIN customer_address ON wr_returning_addr_sk = ca_address_sk WHERE d_year = 2000 GROUP BY wr_returning_customer_sk, ca_state ), state_avg_return AS ( SELECT ctr_state, AVG(ctr_total_return) * 1.2 AS avg_return_threshold FROM customer_total_return GROUP BY ctr_state ) SELECT c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date, ctr1.ctr_total_return FROM customer_total_return ctr1 JOIN state_avg_return sar ON ctr1.ctr_state = sar.ctr_state JOIN customer ON ctr1.ctr_customer_sk = c_customer_sk JOIN customer_address ON ca_address_sk = c_current_addr_sk WHERE ctr1.ctr_total_return > sar.avg_return_threshold AND ca_state = 'IN' ORDER BY c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date, ctr_total_return LIMIT 100 "
31,Statistical,No Regression,Original,1,71.64875948,67.56400185,16732,90.57539892,140.3737338,"with ss as ( select ca_county,d_qoy,d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address where ss_sold_date_sk = d_date_sk and ss_addr_sk = ca_address_sk group by ca_county,d_qoy,d_year ),ws as ( select ca_county,d_qoy,d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk = ca_address_sk group by ca_county,d_qoy,d_year ) select ss1.ca_county,ss1.d_year,ws2.web_sales / ws1.web_sales web_q1_q2_increase,ss2.store_sales / ss1.store_sales store_q1_q2_increase,ws3.web_sales / ws2.web_sales web_q2_q3_increase,ss3.store_sales / ss2.store_sales store_q2_q3_increase from ss ss1,ss ss2,ss ss3,ws ws1,ws ws2,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year = 1999 and case when ws1.web_sales > 0 then ws2.web_sales / ws1.web_sales else null end > case when ss1.store_sales > 0 then ss2.store_sales / ss1.store_sales else null end and case when ws2.web_sales > 0 then ws3.web_sales / ws2.web_sales else null end > case when ss2.store_sales > 0 then ss3.store_sales / ss2.store_sales else null end order by store_q2_q3_increase"
32,Provable,No Regression,Original,1,0.269429832,50.77778389,3960,44.91100669,1.61658287,"select sum(cs_ext_discount_amt) as ""excess discount amount"" from catalog_sales,item,date_dim where i_manufact_id = 722 and i_item_sk = cs_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + interval '90' day) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales,date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + interval '90' day) and d_date_sk = cs_sold_date_sk ) limit 100 "
33,Statistical,Potential Regression,Original,1,0.297594297,226.4424949,13021,58.54508162,120.6307135,"with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from store_sales,date_dim,customer_address,item where i_manufact_id in (select i_manufact_id from item where i_category in ('Books')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 3 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id),cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from catalog_sales,date_dim,customer_address,item where i_manufact_id in (select i_manufact_id from item where i_category in ('Books')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 3 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id),ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from web_sales,date_dim,customer_address,item where i_manufact_id in (select i_manufact_id from item where i_category in ('Books')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy = 3 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_manufact_id) select i_manufact_id,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100 "
34,Provable,No Regression,prompt1,1.003168898,1.20732966,71.47786247,6488,86.60694194,72.98561406," SELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM ( SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk JOIN store ON store_sales.ss_store_sk = store.s_store_sk JOIN household_demographics ON store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk WHERE (date_dim.d_dom BETWEEN 1 AND 3 OR date_dim.d_dom BETWEEN 25 AND 28) AND household_demographics.hd_buy_potential IN ('1001-5000', '0-500') AND household_demographics.hd_vehicle_count > 0 AND (household_demographics.hd_dep_count / NULLIF(household_demographics.hd_vehicle_count, 0)) > 1.2 AND date_dim.d_year BETWEEN 2000 AND 2002 AND store.s_county = 'Williamson County' GROUP BY ss_ticket_number, ss_customer_sk ) AS dn JOIN customer ON dn.ss_customer_sk = customer.c_customer_sk WHERE cnt BETWEEN 15 AND 20 ORDER BY c_last_name, c_first_name, c_salutation, c_preferred_cust_flag DESC, ss_ticket_number "
35,Provable,No Regression,Original,1,1466.523305,201.5840088,12626,64.71956611,15.48539519,"select ca_state,cd_gender,cd_marital_status,cd_dep_count,count(*) cnt1,avg(cd_dep_count),stddev_samp(cd_dep_count),sum(cd_dep_count),cd_dep_employed_count,count(*) cnt2,avg(cd_dep_employed_count),stddev_samp(cd_dep_employed_count),sum(cd_dep_employed_count),cd_dep_college_count,count(*) cnt3,avg(cd_dep_college_count),stddev_samp(cd_dep_college_count),sum(cd_dep_college_count) from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and d_qoy < 4) and (exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 1999 and d_qoy < 4) or exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 1999 and d_qoy < 4)) group by ca_state,cd_gender,cd_marital_status,cd_dep_count,cd_dep_employed_count,cd_dep_college_count order by ca_state,cd_gender,cd_marital_status,cd_dep_count,cd_dep_employed_count,cd_dep_college_count limit 100 "
36,Provable,No Regression,Original,1,3.290557335,27.55564673,1860,22.80044127,3.930982351,select * from customer
37,Provable,No Regression,Original,1,0.628926381,37.09879944,4953,64.08397675,2.522563219,"select i_item_id,i_item_desc,i_current_price from item,inventory,date_dim,catalog_sales where i_current_price between 29 and 29 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-03-29' as date) and (cast('2002-03-29' as date) + interval '60' day) and i_manufact_id in (393,174,251,445) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id limit 100 "
38,Provable,No Regression,MCTS,1.015557078,6.318272177,56.31149206,5347,68.1710763,24.13589096," WITH store_customers AS ( SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk WHERE d_month_seq BETWEEN 1189 AND 1200 ), catalog_customers AS ( SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk JOIN customer ON catalog_sales.cs_bill_customer_sk = customer.c_customer_sk WHERE d_month_seq BETWEEN 1189 AND 1200 ), web_customers AS ( SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales JOIN date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk JOIN customer ON web_sales.ws_bill_customer_sk = customer.c_customer_sk WHERE d_month_seq BETWEEN 1189 AND 1200 ) SELECT COUNT(*) FROM ( SELECT c_last_name, c_first_name, d_date FROM store_customers INTERSECT SELECT c_last_name, c_first_name, d_date FROM catalog_customers INTERSECT SELECT c_last_name, c_first_name, d_date FROM web_customers ) AS hot_cust LIMIT 100 "
39,None,None,None,1,0,0,0,0,0,None
40,Statistical,Potential Regression,Original,1,0.452319991,8.429347078,1094,55.73576927,120.9390426,"select w_state,i_item_id,sum( case when ( cast(d_date as date) < cast ('2001-05-02' as date) ) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end ) as sales_before,sum( case when ( cast(d_date as date) >= cast ('2001-05-02' as date) ) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end ) as sales_after from catalog_sales left outer join catalog_returns on ( cs_order_number = cr_order_number and cs_item_sk = cr_item_sk ),warehouse,item,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-02' as date) - interval '30' day) and (cast ('2001-05-02' as date) + interval '30' day) group by w_state,i_item_id order by w_state,i_item_id limit 100"
41,Statistical,No Regression,prompt1,353414.3378,3.003972645,16.81112572,2248,76.12479138,7.738852262," SELECT DISTINCT i_product_name FROM item i1 WHERE i_manufact_id BETWEEN 704 AND 744 AND EXISTS ( SELECT 1 FROM item WHERE i_manufact = i1.i_manufact AND ( (i_category = 'Women' AND i_color IN ('forest', 'lime') AND i_units IN ('Pallet', 'Pound') AND i_size IN ('economy', 'small')) OR (i_category = 'Women' AND i_color IN ('navy', 'slate') AND i_units IN ('Gross', 'Bunch') AND i_size IN ('extra large', 'petite')) OR (i_category = 'Men' AND i_color IN ('powder', 'sky') AND i_units IN ('Dozen', 'Lb') AND i_size IN ('N/A', 'large')) OR (i_category = 'Men' AND i_color IN ('maroon', 'smoke') AND i_units IN ('Ounce', 'Case') AND i_size IN ('economy', 'small')) OR (i_category = 'Women' AND i_color IN ('dark', 'aquamarine') AND i_units IN ('Ton', 'Tbl') AND i_size IN ('economy', 'small')) OR (i_category = 'Women' AND i_color IN ('frosted', 'plum') AND i_units IN ('Dram', 'Box') AND i_size IN ('extra large', 'petite')) OR (i_category = 'Men' AND i_color IN ('papaya', 'peach') AND i_units IN ('Bundle', 'Carton') AND i_size IN ('N/A', 'large')) OR (i_category = 'Men' AND i_color IN ('firebrick', 'sienna') AND i_units IN ('Cup', 'Each') AND i_size IN ('economy', 'small')) ) ) ORDER BY i_product_name LIMIT 100 "
42,Provable,No Regression,Original,1,0.692912318,41.89322322,3993,57.72917008,2.218802691,"select dt.d_year,item.i_category_id,item.i_category,sum(ss_ext_sales_price) from date_dim dt,store_sales,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manager_id = 1 and dt.d_moy=11 and dt.d_year=1998 group by dt.d_year,item.i_category_id,item.i_category order by sum(ss_ext_sales_price) desc,dt.d_year,item.i_category_id,item.i_category limit 100  "
43,Provable,No Regression,Original,1,0.188385198,11.27558636,1135,98.53627682,2.924759865,"select s_store_name,s_store_id,sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,sum(case when (d_day_name='Tuesday') then ss_sales_price else null end) tue_sales,sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales from date_dim,store_sales,store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -5 and d_year = 2000 group by s_store_name,s_store_id order by s_store_name,s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales limit 100 "
44,Statistical,No Regression,prompt1,2.019753931,14.66446894,111.4171635,8333,89.86773372,9.82281065," WITH ranked_items AS ( SELECT ss_item_sk AS item_sk, avg(ss_net_profit) AS rank_col FROM store_sales WHERE ss_store_sk = 4 GROUP BY ss_item_sk HAVING avg(ss_net_profit) > 0.9 * ( SELECT avg(ss_net_profit) FROM store_sales WHERE ss_store_sk = 4 AND ss_hdemo_sk IS NOT NULL GROUP BY ss_store_sk ) ), ranked_asc AS ( SELECT item_sk, RANK() OVER (ORDER BY rank_col ASC) AS rnk FROM ranked_items ), ranked_desc AS ( SELECT item_sk, RANK() OVER (ORDER BY rank_col DESC) AS rnk FROM ranked_items ) SELECT asc_items.rnk, i1.i_product_name AS best_performing, i2.i_product_name AS worst_performing FROM ranked_asc AS asc_items JOIN ranked_desc AS desc_items ON asc_items.rnk = desc_items.rnk JOIN item i1 ON i1.i_item_sk = asc_items.item_sk JOIN item i2 ON i2.i_item_sk = desc_items.item_sk WHERE asc_items.rnk < 11 ORDER BY asc_items.rnk LIMIT 100 "
45,Provable,No Regression,Original,1,0.626880972,20.89343253,3003,83.89488673,2.066563845,"select ca_zip,ca_city,sum(ws_sales_price) from web_sales,customer,customer_address,date_dim,item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in ('85669','86197','88274','83405','86475','85392','85460','80348','81792')  or i_item_id in (select i_item_id from item where i_item_sk in (2,3,5,7,11,13,17,19,23,29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 2000 group by ca_zip,ca_city order by ca_zip,ca_city limit 100 "
46,Statistical,No Regression,prompt1,1.018733027,7.172686601,73.84041331,6466,89.3141253,122.9994569," SELECT c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, amt, profit FROM ( SELECT ss_ticket_number, ss_customer_sk, ca_city AS bought_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk JOIN store ON store_sales.ss_store_sk = store.s_store_sk JOIN household_demographics ON store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk WHERE (household_demographics.hd_dep_count = 8 OR household_demographics.hd_vehicle_count = 0) AND date_dim.d_dow IN (4, 0) AND date_dim.d_year BETWEEN 2000 AND 2002 AND store.s_city IN ('Midway', 'Fairview') GROUP BY ss_ticket_number, ss_customer_sk, ca_city ) AS dn JOIN customer ON dn.ss_customer_sk = customer.c_customer_sk JOIN customer_address AS current_addr ON customer.c_current_addr_sk = current_addr.ca_address_sk WHERE current_addr.ca_city <> bought_city ORDER BY c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number LIMIT 100 "
47,Statistical,No Regression,MCTS,1.117788881,17.01433314,72.13534848,11458,46.70619726,10.200212," WITH v1 AS ( SELECT i_category, i_brand, s_store_name, s_company_name, d_year, d_moy, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_category, i_brand, s_store_name, s_company_name, d_year) AS avg_monthly_sales, ROW_NUMBER() OVER (PARTITION BY i_category, i_brand, s_store_name, s_company_name ORDER BY d_year, d_moy) AS rn FROM item JOIN store_sales ON ss_item_sk = i_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk WHERE d_year IN (1999, 2000, 2001) AND (d_year = 2000 OR (d_year = 1999 AND d_moy = 12) OR (d_year = 2001 AND d_moy = 1)) GROUP BY i_category, i_brand, s_store_name, s_company_name, d_year, d_moy ), v2 AS ( SELECT v1.s_store_name, v1.s_company_name, v1.d_year, v1.avg_monthly_sales, v1.sum_sales, LAG(v1.sum_sales) OVER (PARTITION BY v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name ORDER BY v1.rn) AS psum, LEAD(v1.sum_sales) OVER (PARTITION BY v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name ORDER BY v1.rn) AS nsum FROM v1 ) SELECT * FROM v2 WHERE d_year = 2000 AND avg_monthly_sales > 0 AND ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales > 0.1 ORDER BY sum_sales - avg_monthly_sales, nsum LIMIT 100 "
48,Provable,No Regression,Original,1,1.920076611,40.07974472,9234,133.8398314,18.19383526,"select sum (ss_quantity) from store_sales,store,customer_demographics,customer_address,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and ( ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Secondary' and ss_sales_price between 100.00 and 150.00 ) or ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = '2 yr Degree' and ss_sales_price between 50.00 and 100.00 ) or ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 ) ) and ( ( ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('ND','NY','SD') and ss_net_profit between 0 and 2000 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MD','GA','KS') and ss_net_profit between 150 and 3000 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('CO','MN','NC') and ss_net_profit between 50 and 25000 ) )  "
49,Provable,No Regression,Original,1,1.587576445,158.8526489,16479,77.12876821,3.012310982,"select channel,item,return_ratio,return_rank,currency_rank from (select 'web' as channel,web.item,web.return_ratio,web.return_rank,web.currency_rank from ( select item,return_ratio,currency_ratio,rank() over (order by return_ratio) as return_rank,rank() over (order by currency_ratio) as currency_rank from ( select ws.ws_item_sk as item,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio from web_sales ws left outer join web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk),date_dim where wr.wr_return_amt > 10000 and ws.ws_net_profit > 1 and ws.ws_net_paid > 0 and ws.ws_quantity > 0 and ws_sold_date_sk = d_date_sk and d_year = 1998 and d_moy = 11 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank <= 10 or web.currency_rank <= 10 ) union select 'catalog' as channel,catalog.item,catalog.return_ratio,catalog.return_rank,catalog.currency_rank from ( select item,return_ratio,currency_ratio,rank() over (order by return_ratio) as return_rank,rank() over (order by currency_ratio) as currency_rank from ( select cs.cs_item_sk as item,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio from catalog_sales cs left outer join catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk),date_dim where cr.cr_return_amount > 10000 and cs.cs_net_profit > 1 and cs.cs_net_paid > 0 and cs.cs_quantity > 0 and cs_sold_date_sk = d_date_sk and d_year = 1998 and d_moy = 11 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank <= 10 or catalog.currency_rank <=10 ) union select 'store' as channel,store.item,store.return_ratio,store.return_rank,store.currency_rank from ( select item,return_ratio,currency_ratio,rank() over (order by return_ratio) as return_rank,rank() over (order by currency_ratio) as currency_rank from ( select sts.ss_item_sk as item,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio from store_sales sts left outer join store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk),date_dim where sr.sr_return_amt > 10000 and sts.ss_net_profit > 1 and sts.ss_net_paid > 0 and sts.ss_quantity > 0 and ss_sold_date_sk = d_date_sk and d_year = 1998 and d_moy = 11 group by sts.ss_item_sk ) in_store ) store where ( store.return_rank <= 10 or store.currency_rank <= 10 ) ) as tmp order by 1,4,5,2 limit 100"
50,Provable,No Regression,Original,1,0.612363739,107.9185783,8166,50.16215301,1.789770603,"select s_store_name,s_company_id,s_street_number,s_street_name,s_street_type,s_suite_number,s_city,s_county,s_state,s_zip,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"",sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"",sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"",sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"",sum(case when (sr_returned_date_sk - ss_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from store_sales,store_returns,store,date_dim d1,date_dim d2 where d2.d_year = 2001 and d2.d_moy = 8 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk = d1.d_date_sk and sr_returned_date_sk = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by s_store_name,s_company_id,s_street_number,s_street_name,s_street_type,s_suite_number,s_city,s_county,s_state,s_zip order by s_store_name,s_company_id,s_street_number,s_street_name,s_street_type,s_suite_number,s_city,s_county,s_state,s_zip limit 100 "
51,Statistical,No Regression,Original,1,1.092727272,170.4260925,13122,60.48356819,4.184605837,"WITH web_v1 as ( select ws_item_sk item_sk,d_date,sum(sum(ws_sales_price)) over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales,date_dim where ws_sold_date_sk=d_date_sk and d_month_seq between 1212 and 1212+11 and ws_item_sk is not NULL group by ws_item_sk,d_date),store_v1 as ( select ss_item_sk item_sk,d_date,sum(sum(ss_sales_price)) over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales,date_dim where ss_sold_date_sk=d_date_sk and d_month_seq between 1212 and 1212+11 and ss_item_sk is not NULL group by ss_item_sk,d_date) select * from (select item_sk,d_date,web_sales,store_sales,max(web_sales) over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative,max(store_sales) over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk,case when web.d_date is not null then web.d_date else store.d_date end d_date,web.cume_sales web_sales,store.cume_sales store_sales from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk and web.d_date = store.d_date) )x )y where web_cumulative > store_cumulative order by item_sk,d_date limit 100 "
52,Provable,No Regression,Original,1,0.610441471,29.6553561,3854,48.24721885,2.174297094,"select dt.d_year,item.i_brand_id brand_id,item.i_brand brand,sum(ss_ext_sales_price) ext_price from date_dim dt,store_sales,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=2000 group by dt.d_year,item.i_brand,item.i_brand_id order by dt.d_year,ext_price desc,brand_id limit 100  "
53,Statistical,No Regression,MCTS,1.00008203,2.413381057,99.28699378,8364,84.66787243,3.936857939," WITH filtered AS ( SELECT i_manufact_id, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id) AS avg_quarterly_sales FROM item JOIN store_sales ON ss_item_sk = i_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk WHERE d_month_seq BETWEEN 1186 AND 1197 AND ( (i_category IN ('Books', 'Children', 'Electronics') AND i_class IN ('personal', 'portable', 'reference', 'self-help') AND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9')) OR (i_category IN ('Women', 'Music', 'Men') AND i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1')) ) GROUP BY i_manufact_id, d_qoy ) SELECT * FROM filtered WHERE CASE WHEN avg_quarterly_sales > 0 THEN ABS(sum_sales - avg_quarterly_sales) / avg_quarterly_sales ELSE NULL END > 0.1 ORDER BY avg_quarterly_sales, sum_sales, i_manufact_id LIMIT 100 "
54,Statistical,Potential Regression,Original,1,0.66011416,72.95763194,7952,48.53419161,120.2186985,"with my_customers as ( select distinct c_customer_sk,c_current_addr_sk from ( select cs_sold_date_sk sold_date_sk,cs_bill_customer_sk customer_sk,cs_item_sk item_sk from catalog_sales union all select ws_sold_date_sk sold_date_sk,ws_bill_customer_sk customer_sk,ws_item_sk item_sk from web_sales ) cs_or_ws_sales,item,date_dim,customer where sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = 'Music' and i_class = 'country' and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 1 and d_year = 1999 ),my_revenue as ( select c_customer_sk,sum(ss_ext_sales_price) as revenue from my_customers,store_sales,customer_address,store,date_dim where c_current_addr_sk = ca_address_sk and ca_county = s_county and ca_state = s_state and ss_sold_date_sk = d_date_sk and c_customer_sk = ss_customer_sk and d_month_seq between (select distinct d_month_seq+1 from date_dim where d_year = 1999 and d_moy = 1) and (select distinct d_month_seq+3 from date_dim where d_year = 1999 and d_moy = 1) group by c_customer_sk ),segments as (select cast((revenue/50) as int) as segment from my_revenue ) select segment,count(*) as num_customers,segment*50 as segment_base from segments group by segment order by segment,num_customers limit 100 "
55,Provable,Potential Regression,Original,1,0.198272914,5.77600436,495,41.42552328,1.950547457,"select i_brand_id brand_id,i_brand brand,sum(ss_ext_sales_price) ext_price from date_dim,store_sales,item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=52 and d_moy=11 and d_year=2000 group by i_brand,i_brand_id order by ext_price desc,i_brand_id limit 100  "
56,Statistical,No Regression,Original,1,0.326831399,189.9081479,15991,55.60333395,120.6000676,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from store_sales,date_dim,customer_address,item where i_item_id in (select i_item_id from item where i_color in ('powder','orchid','pink')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and d_moy = 3 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id),cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from catalog_sales,date_dim,customer_address,item where i_item_id in (select i_item_id from item where i_color in ('powder','orchid','pink')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2000 and d_moy = 3 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id),ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from web_sales,date_dim,customer_address,item where i_item_id in (select i_item_id from item where i_color in ('powder','orchid','pink')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2000 and d_moy = 3 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -6 group by i_item_id) select i_item_id,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales,i_item_id limit 100 "
57,Statistical,No Regression,Original,1,3.186478736,71.17495479,11500,126.0182798,4.233770132,"with v1 as( select i_category,i_brand,cc_name,d_year,d_moy,sum(cs_sales_price) sum_sales,avg(sum(cs_sales_price)) over (partition by i_category,i_brand,cc_name,d_year) avg_monthly_sales,rank() over (partition by i_category,i_brand,cc_name order by d_year,d_moy) rn from item,catalog_sales,date_dim,call_center where cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and cc_call_center_sk= cs_call_center_sk and ( d_year = 2001 or ( d_year = 2001-1 and d_moy =12) or ( d_year = 2001+1 and d_moy =1) ) group by i_category,i_brand,cc_name,d_year,d_moy),v2 as( select v1.i_category,v1.i_brand,v1.cc_name,v1.d_year,v1.avg_monthly_sales,v1.sum_sales,v1_lag.sum_sales psum,v1_lead.sum_sales nsum from v1,v1 v1_lag,v1 v1_lead where v1.i_category = v1_lag.i_category and v1.i_category = v1_lead.i_category and v1.i_brand = v1_lag.i_brand and v1.i_brand = v1_lead.i_brand and v1. cc_name = v1_lag. cc_name and v1. cc_name = v1_lead. cc_name and v1.rn = v1_lag.rn + 1 and v1.rn = v1_lead.rn - 1) select * from v2 where d_year = 2001 and avg_monthly_sales > 0 and case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1 order by sum_sales - avg_monthly_sales,avg_monthly_sales limit 100 "
58,Statistical,Potential Regression,Original,1,0.955797319,105.7419217,11554,58.08023238,120.4316638,"with ss_items as (select i_item_id item_id,sum(ss_ext_sales_price) ss_item_rev from store_sales,item,date_dim where ss_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq = (select d_week_seq from date_dim where d_date = '1998-11-19')) and ss_sold_date_sk = d_date_sk group by i_item_id),cs_items as (select i_item_id item_id,sum(cs_ext_sales_price) cs_item_rev from catalog_sales,item,date_dim where cs_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq = (select d_week_seq from date_dim where d_date = '1998-11-19')) and cs_sold_date_sk = d_date_sk group by i_item_id),ws_items as (select i_item_id item_id,sum(ws_ext_sales_price) ws_item_rev from web_sales,item,date_dim where ws_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq =(select d_week_seq from date_dim where d_date = '1998-11-19')) and ws_sold_date_sk = d_date_sk group by i_item_id) select ss_items.item_id,ss_item_rev,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev,cs_item_rev,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev,ws_item_rev,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_item_rev between 0.1 * cs_item_rev and 2 * cs_item_rev and ss_item_rev between 0.1 * ws_item_rev and 2 * ws_item_rev and cs_item_rev between 0.1 * ss_item_rev and 2 * ss_item_rev and cs_item_rev between 0.1 * ws_item_rev and 2 * ws_item_rev and ws_item_rev between 0.1 * ss_item_rev and 2 * ss_item_rev and ws_item_rev between 0.1 * cs_item_rev and 2 * cs_item_rev order by item_id,ss_item_rev limit 100 "
59,Statistical,No Regression,Original,1,4.305745963,107.1098067,13740,59.14354634,122.3754218,"with wss as ( select d_week_seq,ss_store_sk,sum( case when (d_day_name = 'Sunday') then ss_sales_price else null end ) sun_sales,sum( case when (d_day_name = 'Monday') then ss_sales_price else null end ) mon_sales,sum( case when (d_day_name = 'Tuesday') then ss_sales_price else null end ) tue_sales,sum( case when (d_day_name = 'Wednesday') then ss_sales_price else null end ) wed_sales,sum( case when (d_day_name = 'Thursday') then ss_sales_price else null end ) thu_sales,sum( case when (d_day_name = 'Friday') then ss_sales_price else null end ) fri_sales,sum( case when (d_day_name = 'Saturday') then ss_sales_price else null end ) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select s_store_name1,s_store_id1,d_week_seq1,sun_sales1 / sun_sales2,mon_sales1 / mon_sales2,tue_sales1 / tue_sales2,wed_sales1 / wed_sales2,thu_sales1 / thu_sales2,fri_sales1 / fri_sales2,sat_sales1 / sat_sales2 from ( select s_store_name s_store_name1,wss.d_week_seq d_week_seq1,s_store_id s_store_id1,sun_sales sun_sales1,mon_sales mon_sales1,tue_sales tue_sales1,wed_sales wed_sales1,thu_sales thu_sales1,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1195 and 1195 + 11 ) y,( select s_store_name s_store_name2,wss.d_week_seq d_week_seq2,s_store_id s_store_id2,sun_sales sun_sales2,mon_sales mon_sales2,tue_sales tue_sales2,wed_sales wed_sales2,thu_sales thu_sales2,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1195 + 12 and 1195 + 23 ) x where s_store_id1 = s_store_id2 and d_week_seq1 = d_week_seq2 -52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100"
60,Statistical,No Regression,Original,1,0.258423125,178.0902163,14664,42.43002391,120.6399992,"with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from store_sales,date_dim,customer_address,item where i_item_id in (select i_item_id from item where i_category in ('Jewelry')) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and d_moy = 10 and ss_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_item_id),cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from catalog_sales,date_dim,customer_address,item where i_item_id in (select i_item_id from item where i_category in ('Jewelry')) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2000 and d_moy = 10 and cs_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_item_id),ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from web_sales,date_dim,customer_address,item where i_item_id in (select i_item_id from item where i_category in ('Jewelry')) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2000 and d_moy = 10 and ws_bill_addr_sk = ca_address_sk and ca_gmt_offset = -5 group by i_item_id) select i_item_id,sum(total_sales) total_sales from (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by i_item_id,total_sales limit 100 "
61,Statistical,No Regression,MCTS,1.996996292,1.056318371,72.57721961,8301,49.02232146,120.4682055," WITH filtered AS ( SELECT ss_ext_sales_price, ss_promo_sk, ss_sold_date_sk, ss_store_sk, ss_customer_sk, ss_item_sk FROM store_sales JOIN store ON ss_store_sk = s_store_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_address ON ca_address_sk = c_current_addr_sk JOIN item ON ss_item_sk = i_item_sk WHERE ca_gmt_offset = -5 AND i_category = 'Home' AND s_gmt_offset = -5 AND d_year = 2000 AND d_moy = 12 ), promotional_sales AS ( SELECT SUM(ss_ext_sales_price) AS promotions FROM filtered JOIN promotion ON ss_promo_sk = p_promo_sk WHERE p_channel_dmail = 'Y' OR p_channel_email = 'Y' OR p_channel_tv = 'Y' ), all_sales AS ( SELECT SUM(ss_ext_sales_price) AS total FROM filtered ) SELECT ps.promotions, als.total, CAST(ps.promotions AS DECIMAL(15,4)) / CAST(als.total AS DECIMAL(15,4)) * 100 AS percentage FROM promotional_sales ps, all_sales als ORDER BY ps.promotions, als.total LIMIT 100 "
62,Provable,No Regression,Original,1,1.765907466,198.7866407,18257,91.97809839,2.338271141,"select substr(w_warehouse_name,1,20),sm_type,web_name,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"",sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"",sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"",sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"",sum(case when (ws_ship_date_sk - ws_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from web_sales,warehouse,ship_mode,web_site,date_dim where d_month_seq between 1223 and 1223 + 11 and ws_ship_date_sk = d_date_sk and ws_warehouse_sk = w_warehouse_sk and ws_ship_mode_sk = sm_ship_mode_sk and ws_web_site_sk = web_site_sk group by substr(w_warehouse_name,1,20),sm_type,web_name order by substr(w_warehouse_name,1,20),sm_type,web_name limit 100 "
63,Statistical,No Regression,prompt1,1.000220017,2.639449481,82.73282418,8503,68.83080292,4.077198505," WITH filtered_items AS ( SELECT i_item_sk, i_manager_id FROM item WHERE (i_category IN ('Books', 'Children', 'Electronics') AND i_class IN ('personal', 'portable', 'reference', 'self-help') AND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9')) OR (i_category IN ('Women', 'Music', 'Men') AND i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1')) ), sales_data AS ( SELECT i_manager_id, ss_sales_price, d_month_seq FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk JOIN filtered_items ON ss_item_sk = i_item_sk WHERE d_month_seq BETWEEN 1222 AND 1233 ), aggregated_sales AS ( SELECT i_manager_id, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manager_id) AS avg_monthly_sales FROM sales_data GROUP BY i_manager_id, d_month_seq ) SELECT i_manager_id, sum_sales, avg_monthly_sales FROM aggregated_sales WHERE CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY i_manager_id, avg_monthly_sales, sum_sales LIMIT 100 "
64,Statistical,No Regression,Original,1,22.91240188,111.5072519,21336,128.1095531,124.7884269,"with cs_ui as (select cs_item_sk,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number group by cs_item_sk having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),cross_sales as (select i_product_name product_name,i_item_sk item_sk,s_store_name store_name,s_zip store_zip,ad1.ca_street_number b_street_number,ad1.ca_street_name b_street_name,ad1.ca_city b_city,ad1.ca_zip b_zip,ad2.ca_street_number c_street_number,ad2.ca_street_name c_street_name,ad2.ca_city c_city,ad2.ca_zip c_zip,d1.d_year as syear,d2.d_year as fsyear,d3.d_year s2year,count(*) cnt,sum(ss_wholesale_cost) s1,sum(ss_list_price) s2,sum(ss_coupon_amt) s3 FROM store_sales,store_returns,cs_ui,date_dim d1,date_dim d2,date_dim d3,store,customer,customer_demographics cd1,customer_demographics cd2,promotion,household_demographics hd1,household_demographics hd2,customer_address ad1,customer_address ad2,income_band ib1,income_band ib2,item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status <> cd2.cd_marital_status and i_color in ('orange','lace','lawn','misty','blush','pink') and i_current_price between 48 and 48 + 10 and i_current_price between 48 + 1 and 48 + 15 group by i_product_name,i_item_sk,s_store_name,s_zip,ad1.ca_street_number,ad1.ca_street_name,ad1.ca_city,ad1.ca_zip,ad2.ca_street_number,ad2.ca_street_name,ad2.ca_city,ad2.ca_zip,d1.d_year,d2.d_year,d3.d_year ) select cs1.product_name,cs1.store_name,cs1.store_zip,cs1.b_street_number,cs1.b_street_name,cs1.b_city,cs1.b_zip,cs1.c_street_number,cs1.c_street_name,cs1.c_city,cs1.c_zip,cs1.syear,cs1.cnt,cs1.s1 as s11,cs1.s2 as s21,cs1.s3 as s31,cs2.s1 as s12,cs2.s2 as s22,cs2.s3 as s32,cs2.syear,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1999 and cs2.syear = 1999 + 1 and cs2.cnt <= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name,cs1.store_name,cs2.cnt,cs1.s1,cs2.s1 "
65,Statistical,No Regression,prompt1,1.980648675,3.527182736,59.11905946,5175,72.02637959,121.8499501," WITH sales_data AS ( SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_month_seq BETWEEN 1176 AND 1187 GROUP BY ss_store_sk, ss_item_sk ), average_revenue AS ( SELECT ss_store_sk, AVG(revenue) AS ave FROM sales_data GROUP BY ss_store_sk ) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM sales_data sc JOIN average_revenue sb ON sb.ss_store_sk = sc.ss_store_sk JOIN store ON s_store_sk = sc.ss_store_sk JOIN item ON i_item_sk = sc.ss_item_sk WHERE sc.revenue <= 0.1 * sb.ave ORDER BY s_store_name, i_item_desc LIMIT 100 "
66,Statistical,No Regression,Original,1,2.299319795,422.7785553,40415,121.0821772,121.0340118,"select w_warehouse_name,w_warehouse_sq_ft,w_city,w_county,w_state,w_country,ship_carriers,year,sum(jan_sales) as jan_sales,sum(feb_sales) as feb_sales,sum(mar_sales) as mar_sales,sum(apr_sales) as apr_sales,sum(may_sales) as may_sales,sum(jun_sales) as jun_sales,sum(jul_sales) as jul_sales,sum(aug_sales) as aug_sales,sum(sep_sales) as sep_sales,sum(oct_sales) as oct_sales,sum(nov_sales) as nov_sales,sum(dec_sales) as dec_sales,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot,sum(jan_net) as jan_net,sum(feb_net) as feb_net,sum(mar_net) as mar_net,sum(apr_net) as apr_net,sum(may_net) as may_net,sum(jun_net) as jun_net,sum(jul_net) as jul_net,sum(aug_net) as aug_net,sum(sep_net) as sep_net,sum(oct_net) as oct_net,sum(nov_net) as nov_net,sum(dec_net) as dec_net from ( select w_warehouse_name,w_warehouse_sq_ft,w_city,w_county,w_state,w_country,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers,d_year as year,sum(case when d_moy = 1 then ws_ext_sales_price* ws_quantity else 0 end) as jan_sales,sum(case when d_moy = 2 then ws_ext_sales_price* ws_quantity else 0 end) as feb_sales,sum(case when d_moy = 3 then ws_ext_sales_price* ws_quantity else 0 end) as mar_sales,sum(case when d_moy = 4 then ws_ext_sales_price* ws_quantity else 0 end) as apr_sales,sum(case when d_moy = 5 then ws_ext_sales_price* ws_quantity else 0 end) as may_sales,sum(case when d_moy = 6 then ws_ext_sales_price* ws_quantity else 0 end) as jun_sales,sum(case when d_moy = 7 then ws_ext_sales_price* ws_quantity else 0 end) as jul_sales,sum(case when d_moy = 8 then ws_ext_sales_price* ws_quantity else 0 end) as aug_sales,sum(case when d_moy = 9 then ws_ext_sales_price* ws_quantity else 0 end) as sep_sales,sum(case when d_moy = 10 then ws_ext_sales_price* ws_quantity else 0 end) as oct_sales,sum(case when d_moy = 11 then ws_ext_sales_price* ws_quantity else 0 end) as nov_sales,sum(case when d_moy = 12 then ws_ext_sales_price* ws_quantity else 0 end) as dec_sales,sum(case when d_moy = 1 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jan_net,sum(case when d_moy = 2 then ws_net_paid_inc_ship * ws_quantity else 0 end) as feb_net,sum(case when d_moy = 3 then ws_net_paid_inc_ship * ws_quantity else 0 end) as mar_net,sum(case when d_moy = 4 then ws_net_paid_inc_ship * ws_quantity else 0 end) as apr_net,sum(case when d_moy = 5 then ws_net_paid_inc_ship * ws_quantity else 0 end) as may_net,sum(case when d_moy = 6 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jun_net,sum(case when d_moy = 7 then ws_net_paid_inc_ship * ws_quantity else 0 end) as jul_net,sum(case when d_moy = 8 then ws_net_paid_inc_ship * ws_quantity else 0 end) as aug_net,sum(case when d_moy = 9 then ws_net_paid_inc_ship * ws_quantity else 0 end) as sep_net,sum(case when d_moy = 10 then ws_net_paid_inc_ship * ws_quantity else 0 end) as oct_net,sum(case when d_moy = 11 then ws_net_paid_inc_ship * ws_quantity else 0 end) as nov_net,sum(case when d_moy = 12 then ws_net_paid_inc_ship * ws_quantity else 0 end) as dec_net from web_sales,warehouse,date_dim,time_dim,ship_mode where ws_warehouse_sk = w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 42970 and 42970+28800 and sm_carrier in ('ORIENTAL','BOXBUNDLES') group by w_warehouse_name,w_warehouse_sq_ft,w_city,w_county,w_state,w_country,d_year union all select w_warehouse_name,w_warehouse_sq_ft,w_city,w_county,w_state,w_country,'ORIENTAL' || ',' || 'BOXBUNDLES' as ship_carriers,d_year as year,sum(case when d_moy = 1 then cs_ext_list_price* cs_quantity else 0 end) as jan_sales,sum(case when d_moy = 2 then cs_ext_list_price* cs_quantity else 0 end) as feb_sales,sum(case when d_moy = 3 then cs_ext_list_price* cs_quantity else 0 end) as mar_sales,sum(case when d_moy = 4 then cs_ext_list_price* cs_quantity else 0 end) as apr_sales,sum(case when d_moy = 5 then cs_ext_list_price* cs_quantity else 0 end) as may_sales,sum(case when d_moy = 6 then cs_ext_list_price* cs_quantity else 0 end) as jun_sales,sum(case when d_moy = 7 then cs_ext_list_price* cs_quantity else 0 end) as jul_sales,sum(case when d_moy = 8 then cs_ext_list_price* cs_quantity else 0 end) as aug_sales,sum(case when d_moy = 9 then cs_ext_list_price* cs_quantity else 0 end) as sep_sales,sum(case when d_moy = 10 then cs_ext_list_price* cs_quantity else 0 end) as oct_sales,sum(case when d_moy = 11 then cs_ext_list_price* cs_quantity else 0 end) as nov_sales,sum(case when d_moy = 12 then cs_ext_list_price* cs_quantity else 0 end) as dec_sales,sum(case when d_moy = 1 then cs_net_paid * cs_quantity else 0 end) as jan_net,sum(case when d_moy = 2 then cs_net_paid * cs_quantity else 0 end) as feb_net,sum(case when d_moy = 3 then cs_net_paid * cs_quantity else 0 end) as mar_net,sum(case when d_moy = 4 then cs_net_paid * cs_quantity else 0 end) as apr_net,sum(case when d_moy = 5 then cs_net_paid * cs_quantity else 0 end) as may_net,sum(case when d_moy = 6 then cs_net_paid * cs_quantity else 0 end) as jun_net,sum(case when d_moy = 7 then cs_net_paid * cs_quantity else 0 end) as jul_net,sum(case when d_moy = 8 then cs_net_paid * cs_quantity else 0 end) as aug_net,sum(case when d_moy = 9 then cs_net_paid * cs_quantity else 0 end) as sep_net,sum(case when d_moy = 10 then cs_net_paid * cs_quantity else 0 end) as oct_net,sum(case when d_moy = 11 then cs_net_paid * cs_quantity else 0 end) as nov_net,sum(case when d_moy = 12 then cs_net_paid * cs_quantity else 0 end) as dec_net from catalog_sales,warehouse,date_dim,time_dim,ship_mode where cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 42970 AND 42970+28800 and sm_carrier in ('ORIENTAL','BOXBUNDLES') group by w_warehouse_name,w_warehouse_sq_ft,w_city,w_county,w_state,w_country,d_year ) x group by w_warehouse_name,w_warehouse_sq_ft,w_city,w_county,w_state,w_country,ship_carriers,year order by w_warehouse_name limit 100 "
67,Statistical,No Regression,Original,1,12.91677079,73.29457834,6071,62.84167862,7.997735262,"select * from ( select i_category,i_class,i_brand,i_product_name,d_year,d_qoy,d_moy,s_store_id,sumsales,rank() over ( partition by i_category order by sumsales desc ) rk from ( select i_category,i_class,i_brand,i_product_name,d_year,d_qoy,d_moy,s_store_id,sum(coalesce(ss_sales_price * ss_quantity,0)) sumsales from store_sales,date_dim,store,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1217 and 1217 + 11 group by rollup( i_category,i_class,i_brand,i_product_name,d_year,d_qoy,d_moy,s_store_id ) ) dw1 ) dw2 where rk <= 100 order by i_category,i_class,i_brand,i_product_name,d_year,d_qoy,d_moy,s_store_id,sumsales,rk limit 100"
68,Statistical,No Regression,Original,1,0.626739778,72.03433832,6286,110.6071823,120.5984175,"select c_last_name,c_first_name,ca_city,bought_city,ss_ticket_number,extended_price,extended_tax,list_price from (select ss_ticket_number,ss_customer_sk,ca_city bought_city,sum(ss_ext_sales_price) extended_price,sum(ss_ext_list_price) list_price,sum(ss_ext_tax) extended_tax from store_sales,date_dim,store,household_demographics,customer_address where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and store_sales.ss_addr_sk = customer_address.ca_address_sk and date_dim.d_dom between 1 and 2 and (household_demographics.hd_dep_count = 3 or household_demographics.hd_vehicle_count= 4) and date_dim.d_year in (1998,1998+1,1998+2) and store.s_city in ('Fairview','Midway') group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr where ss_customer_sk = c_customer_sk and customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city <> bought_city order by c_last_name,ss_ticket_number limit 100 "
69,Provable,Potential Regression,prompt1,1.281790608,2.839359892,91.36830164,6837,86.79572487,12.12937522," WITH store_sales_customers AS ( SELECT ss_customer_sk FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 1 AND 3 ), web_sales_customers AS ( SELECT ws_bill_customer_sk FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 1 AND 3 ), catalog_sales_customers AS ( SELECT cs_ship_customer_sk FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 1 AND 3 ) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON cd_demo_sk = c.c_current_cdemo_sk WHERE ca_state IN ('IL', 'TX', 'ME') AND c.c_customer_sk IN (SELECT ss_customer_sk FROM store_sales_customers) AND c.c_customer_sk NOT IN (SELECT ws_bill_customer_sk FROM web_sales_customers) AND c.c_customer_sk NOT IN (SELECT cs_ship_customer_sk FROM catalog_sales_customers) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100 "
70,Provable,No Regression,Original,1,1.540288135,58.480023,2747,19.14976692,3.682365417,select * from customer
71,Provable,No Regression,Original,1,2.211356245,66.47089162,10705,75.1324501,2.757282734,"select i_brand_id brand_id,i_brand brand,t_hour,t_minute,sum(ext_price) ext_price from item,(select ws_ext_sales_price as ext_price,ws_sold_date_sk as sold_date_sk,ws_item_sk as sold_item_sk,ws_sold_time_sk as time_sk from web_sales,date_dim where d_date_sk = ws_sold_date_sk and d_moy=12 and d_year=2002 union all select cs_ext_sales_price as ext_price,cs_sold_date_sk as sold_date_sk,cs_item_sk as sold_item_sk,cs_sold_time_sk as time_sk from catalog_sales,date_dim where d_date_sk = cs_sold_date_sk and d_moy=12 and d_year=2002 union all select ss_ext_sales_price as ext_price,ss_sold_date_sk as sold_date_sk,ss_item_sk as sold_item_sk,ss_sold_time_sk as time_sk from store_sales,date_dim where d_date_sk = ss_sold_date_sk and d_moy=12 and d_year=2002 ) tmp,time_dim where sold_item_sk = i_item_sk and i_manager_id=1 and time_sk = t_time_sk and (t_meal_time = 'breakfast' or t_meal_time = 'dinner') group by i_brand,i_brand_id,t_hour,t_minute order by ext_price desc,i_brand_id  "
72,Provable,No Regression,Original,1,1.456376006,12.96567493,1465,54.74812961,2.998049259,"select i_item_desc,w_warehouse_name,d1.d_week_seq,sum(case when p_promo_sk is null then 1 else 0 end) no_promo,sum(case when p_promo_sk is not null then 1 else 0 end) promo,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq and inv_quantity_on_hand < cs_quantity and d3.d_date > d1.d_date and hd_buy_potential = '1001-5000' and d1.d_year=2002 and cd_marital_status='W' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc,i_item_desc,w_warehouse_name,d_week_seq limit 100 "
73,Provable,Potential Regression,Original,1,0.306623495,76.60646236,8177,69.09119153,60.17829967,"select c_last_name,c_first_name,c_salutation,c_preferred_cust_flag,ss_ticket_number,cnt from (select ss_ticket_number,ss_customer_sk,count(*) cnt from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and date_dim.d_dom between 1 and 2 and (household_demographics.hd_buy_potential = '1001-5000' or household_demographics.hd_buy_potential = '5001-10000') and household_demographics.hd_vehicle_count > 0 and case when household_demographics.hd_vehicle_count > 0 then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1 and date_dim.d_year in (2000,2000+1,2000+2) and store.s_county in ('Williamson County','Williamson County','Williamson County','Williamson County') group by ss_ticket_number,ss_customer_sk) dj,customer where ss_customer_sk = c_customer_sk and cnt between 1 and 5 order by cnt desc,c_last_name asc "
74,Statistical,No Regression,Original,1,5.206798989,79.54949079,15621,77.96469879,130.9851313,"with year_total as ( select c_customer_id customer_id,c_first_name customer_first_name,c_last_name customer_last_name,d_year as year,max(ss_net_paid) year_total,'s' sale_type from customer,store_sales,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (1999,1999+1) group by c_customer_id,c_first_name,c_last_name,d_year union all select c_customer_id customer_id,c_first_name customer_first_name,c_last_name customer_last_name,d_year as year,max(ws_net_paid) year_total,'w' sale_type from customer,web_sales,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year in (1999,1999+1) group by c_customer_id,c_first_name,c_last_name,d_year ) select t_s_secyear.customer_id,t_s_secyear.customer_first_name,t_s_secyear.customer_last_name from year_total t_s_firstyear,year_total t_s_secyear,year_total t_w_firstyear,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.sale_type = 's' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_w_secyear.sale_type = 'w' and t_s_firstyear.year = 1999 and t_s_secyear.year = 1999 and t_w_firstyear.year = 1999 and t_w_secyear.year = 1999 and t_s_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end >= case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end order by 1,3,2 limit 100 "
75,Statistical,No Regression,Original,1,2.940726723,130.9165604,13698,66.79547548,124.7099106,"WITH all_sales AS ( SELECT d_year,i_brand_id,i_class_id,i_category_id,i_manufact_id,SUM(sales_cnt) AS sales_cnt,SUM(sales_amt) AS sales_amt FROM (SELECT d_year,i_brand_id,i_class_id,i_category_id,i_manufact_id,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk JOIN date_dim ON d_date_sk=cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number AND cs_item_sk=cr_item_sk) WHERE i_category='Sports' UNION SELECT d_year,i_brand_id,i_class_id,i_category_id,i_manufact_id,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk=ss_item_sk JOIN date_dim ON d_date_sk=ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number AND ss_item_sk=sr_item_sk) WHERE i_category='Sports' UNION SELECT d_year,i_brand_id,i_class_id,i_category_id,i_manufact_id,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk=ws_item_sk JOIN date_dim ON d_date_sk=ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number=wr_order_number AND ws_item_sk=wr_item_sk) WHERE i_category='Sports') sales_detail GROUP BY d_year,i_brand_id,i_class_id,i_category_id,i_manufact_id) SELECT prev_yr.d_year AS prev_year,curr_yr.d_year AS year,curr_yr.i_brand_id,curr_yr.i_class_id,curr_yr.i_category_id,curr_yr.i_manufact_id,prev_yr.sales_cnt AS prev_yr_cnt,curr_yr.sales_cnt AS curr_yr_cnt,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff FROM all_sales curr_yr,all_sales prev_yr WHERE curr_yr.i_brand_id=prev_yr.i_brand_id AND curr_yr.i_class_id=prev_yr.i_class_id AND curr_yr.i_category_id=prev_yr.i_category_id AND curr_yr.i_manufact_id=prev_yr.i_manufact_id AND curr_yr.d_year=2002 AND prev_yr.d_year=2002-1 AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9 ORDER BY sales_cnt_diff,sales_amt_diff limit 100 "
76,Provable,No Regression,Original,1,12.48959971,66.09295623,8208,134.1109197,7.420104265,"select channel,col_name,d_year,d_qoy,i_category,COUNT(*) sales_cnt,SUM(ext_sales_price) sales_amt FROM ( SELECT 'store' as channel,'ss_customer_sk' col_name,d_year,d_qoy,i_category,ss_ext_sales_price ext_sales_price FROM store_sales,item,date_dim WHERE ss_customer_sk IS not NULL AND ss_sold_date_sk=d_date_sk AND ss_item_sk=i_item_sk UNION ALL SELECT 'web' as channel,'ws_promo_sk' col_name,d_year,d_qoy,i_category,ws_ext_sales_price ext_sales_price FROM web_sales,item,date_dim WHERE ws_promo_sk IS not NULL AND ws_sold_date_sk=d_date_sk AND ws_item_sk=i_item_sk UNION ALL SELECT 'catalog' as channel,'cs_bill_customer_sk' col_name,d_year,d_qoy,i_category,cs_ext_sales_price ext_sales_price FROM catalog_sales,item,date_dim WHERE cs_bill_customer_sk IS not NULL AND cs_sold_date_sk=d_date_sk AND cs_item_sk=i_item_sk) foo GROUP BY channel,col_name,d_year,d_qoy,i_category ORDER BY channel,col_name,d_year,d_qoy,i_category limit 100 "
77,Statistical,No Regression,Original,1,0.273144079,210.7645619,26541,109.4448164,120.6234801,"with ss as (select s_store_sk,sum(ss_ext_sales_price) as sales,sum(ss_net_profit) as profit from store_sales,date_dim,store where ss_sold_date_sk = d_date_sk and d_date between cast('2000-08-10' as date) and (cast('2000-08-10' as date) + interval '30' day) and ss_store_sk = s_store_sk group by s_store_sk),sr as (select s_store_sk,sum(sr_return_amt) as returns,sum(sr_net_loss) as profit_loss from store_returns,date_dim,store where sr_returned_date_sk = d_date_sk and d_date between cast('2000-08-10' as date) and (cast('2000-08-10' as date) + interval '30' day) and sr_store_sk = s_store_sk group by s_store_sk),cs as (select cs_call_center_sk,sum(cs_ext_sales_price) as sales,sum(cs_net_profit) as profit from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk and d_date between cast('2000-08-10' as date) and (cast('2000-08-10' as date) + interval '30' day) group by cs_call_center_sk ),cr as (select cr_call_center_sk,sum(cr_return_amount) as returns,sum(cr_net_loss) as profit_loss from catalog_returns,date_dim where cr_returned_date_sk = d_date_sk and d_date between cast('2000-08-10' as date) and (cast('2000-08-10' as date) + interval '30' day) group by cr_call_center_sk ),ws as ( select wp_web_page_sk,sum(ws_ext_sales_price) as sales,sum(ws_net_profit) as profit from web_sales,date_dim,web_page where ws_sold_date_sk = d_date_sk and d_date between cast('2000-08-10' as date) and (cast('2000-08-10' as date) + interval '30' day) and ws_web_page_sk = wp_web_page_sk group by wp_web_page_sk),wr as (select wp_web_page_sk,sum(wr_return_amt) as returns,sum(wr_net_loss) as profit_loss from web_returns,date_dim,web_page where wr_returned_date_sk = d_date_sk and d_date between cast('2000-08-10' as date) and (cast('2000-08-10' as date) + interval '30' day) and wr_web_page_sk = wp_web_page_sk group by wp_web_page_sk) select channel,id,sum(sales) as sales,sum(returns) as returns,sum(profit) as profit from (select 'store channel' as channel,ss.s_store_sk as id,sales,coalesce(returns,0) as returns,(profit - coalesce(profit_loss,0)) as profit from ss left join sr on ss.s_store_sk = sr.s_store_sk union all select 'catalog channel' as channel,cs_call_center_sk as id,sales,returns,(profit - profit_loss) as profit from cs,cr union all select 'web channel' as channel,ws.wp_web_page_sk as id,sales,coalesce(returns,0) returns,(profit - coalesce(profit_loss,0)) as profit from ws left join wr on ws.wp_web_page_sk = wr.wp_web_page_sk ) x group by rollup (channel,id) order by channel,id limit 100 "
78,Statistical,No Regression,Original,1,9.721453636,94.21974944,14300,80.48629951,130.3987041,"with ws as ( select d_year AS ws_sold_year,ws_item_sk,ws_bill_customer_sk ws_customer_sk,sum(ws_quantity) ws_qty,sum(ws_wholesale_cost) ws_wc,sum(ws_sales_price) ws_sp from web_sales left join web_returns on wr_order_number = ws_order_number and ws_item_sk = wr_item_sk join date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year,ws_item_sk,ws_bill_customer_sk ),cs as ( select d_year AS cs_sold_year,cs_item_sk,cs_bill_customer_sk cs_customer_sk,sum(cs_quantity) cs_qty,sum(cs_wholesale_cost) cs_wc,sum(cs_sales_price) cs_sp from catalog_sales left join catalog_returns on cr_order_number = cs_order_number and cs_item_sk = cr_item_sk join date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year,cs_item_sk,cs_bill_customer_sk ),ss as ( select d_year AS ss_sold_year,ss_item_sk,ss_customer_sk,sum(ss_quantity) ss_qty,sum(ss_wholesale_cost) ss_wc,sum(ss_sales_price) ss_sp from store_sales left join store_returns on sr_ticket_number = ss_ticket_number and ss_item_sk = sr_item_sk join date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year,ss_item_sk,ss_customer_sk ) select ss_customer_sk,round( ss_qty /(coalesce(ws_qty,0) + coalesce(cs_qty,0)),2 ) ratio,ss_qty store_qty,ss_wc store_wholesale_cost,ss_sp store_sales_price,coalesce(ws_qty,0) + coalesce(cs_qty,0) other_chan_qty,coalesce(ws_wc,0) + coalesce(cs_wc,0) other_chan_wholesale_cost,coalesce(ws_sp,0) + coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on ( ws_sold_year = ss_sold_year and ws_item_sk = ss_item_sk and ws_customer_sk = ss_customer_sk ) left join cs on ( cs_sold_year = ss_sold_year and cs_item_sk = ss_item_sk and cs_customer_sk = ss_customer_sk ) where ( coalesce(ws_qty,0) > 0 or coalesce(cs_qty,0) > 0 ) and ss_sold_year = 1998 order by ss_customer_sk,ss_qty desc,ss_wc desc,ss_sp desc,other_chan_qty,other_chan_wholesale_cost,other_chan_sales_price,ratio limit 100"
79,Statistical,Potential Regression,Original,1,1.689789502,90.36176194,6604,60.63360381,4.448448896," select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number,ss_customer_sk,store.s_city,sum(ss_coupon_amt) amt,sum(ss_net_profit) profit from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and (household_demographics.hd_dep_count = 7 or household_demographics.hd_vehicle_count > -1) and date_dim.d_dow = 4 and date_dim.d_year in (2000,2000+1,2000+2) and store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30),profit limit 100 "
80,Statistical,No Regression,Original,1,1.799116669,119.9156454,13535,104.2084706,120.9248409,"with ssr as (select s_store_id as store_id,sum(ss_ext_sales_price) as sales,sum(coalesce(sr_return_amt,0)) as returns,sum(ss_net_profit - coalesce(sr_net_loss,0)) as profit from store_sales left outer join store_returns on (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),date_dim,store,item,promotion where ss_sold_date_sk = d_date_sk and d_date between cast('2002-08-14' as date) and (cast('2002-08-14' as date) + interval '30' day) and ss_store_sk = s_store_sk and ss_item_sk = i_item_sk and i_current_price > 50 and ss_promo_sk = p_promo_sk and p_channel_tv = 'N' group by s_store_id),csr as (select cp_catalog_page_id as catalog_page_id,sum(cs_ext_sales_price) as sales,sum(coalesce(cr_return_amount,0)) as returns,sum(cs_net_profit - coalesce(cr_net_loss,0)) as profit from catalog_sales left outer join catalog_returns on (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),date_dim,catalog_page,item,promotion where cs_sold_date_sk = d_date_sk and d_date between cast('2002-08-14' as date) and (cast('2002-08-14' as date) + interval '30' day) and cs_catalog_page_sk = cp_catalog_page_sk and cs_item_sk = i_item_sk and i_current_price > 50 and cs_promo_sk = p_promo_sk and p_channel_tv = 'N' group by cp_catalog_page_id),wsr as (select web_site_id,sum(ws_ext_sales_price) as sales,sum(coalesce(wr_return_amt,0)) as returns,sum(ws_net_profit - coalesce(wr_net_loss,0)) as profit from web_sales left outer join web_returns on (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),date_dim,web_site,item,promotion where ws_sold_date_sk = d_date_sk and d_date between cast('2002-08-14' as date) and (cast('2002-08-14' as date) + interval '30' day) and ws_web_site_sk = web_site_sk and ws_item_sk = i_item_sk and i_current_price > 50 and ws_promo_sk = p_promo_sk and p_channel_tv = 'N' group by web_site_id) select channel,id,sum(sales) as sales,sum(returns) as returns,sum(profit) as profit from (select 'store channel' as channel,'store' || store_id as id,sales,returns,profit from ssr union all select 'catalog channel' as channel,'catalog_page' || catalog_page_id as id,sales,returns,profit from csr union all select 'web channel' as channel,'web_site' || web_site_id as id,sales,returns,profit from wsr ) x group by rollup (channel,id) order by channel,id limit 100 "
81,Statistical,No Regression,prompt1,144.7525448,5.24321161,109.8106159,13153,54.06206393,17.88101673," WITH customer_total_return AS ( SELECT cr_returning_customer_sk AS ctr_customer_sk, ca_state AS ctr_state, SUM(cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns JOIN date_dim ON cr_returned_date_sk = d_date_sk JOIN customer_address ON cr_returning_addr_sk = ca_address_sk WHERE d_year = 2001 GROUP BY cr_returning_customer_sk, ca_state ), state_avg_return AS ( SELECT ctr_state, AVG(ctr_total_return) * 1.2 AS avg_return_threshold FROM customer_total_return GROUP BY ctr_state ) SELECT c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr1.ctr_total_return FROM customer_total_return ctr1 JOIN state_avg_return sar ON ctr1.ctr_state = sar.ctr_state JOIN customer ON ctr1.ctr_customer_sk = c_customer_sk JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk WHERE ctr1.ctr_total_return > sar.avg_return_threshold AND ca_state = 'TN' ORDER BY c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr_total_return LIMIT 100 "
82,Provable,Potential Regression,Original,1,0.500142162,35.11794563,4790,48.56203508,2.529206276,"select i_item_id,i_item_desc,i_current_price from item,inventory,date_dim,store_sales where i_current_price between 58 and 58+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2001-01-13' as date) and (cast('2001-01-13' as date) + interval '60' day) and i_manufact_id in (259,559,580,485) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id limit 100 "
83,Statistical,No Regression,Original,1,0.344309699,94.45485184,10246,67.79060864,120.4431343,"with sr_items as (select i_item_id item_id,sum(sr_return_quantity) sr_item_qty from store_returns,item,date_dim where sr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in ('2001-07-13','2001-09-10','2001-11-16','2000-12-14'))) and sr_returned_date_sk = d_date_sk group by i_item_id),cr_items as (select i_item_id item_id,sum(cr_return_quantity) cr_item_qty from catalog_returns,item,date_dim where cr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in ('2001-07-13','2001-09-10','2001-11-16','2000-12-14'))) and cr_returned_date_sk = d_date_sk group by i_item_id),wr_items as (select i_item_id item_id,sum(wr_return_quantity) wr_item_qty from web_returns,item,date_dim where wr_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in ('2001-07-13','2001-09-10','2001-11-16','2000-12-14'))) and wr_returned_date_sk = d_date_sk group by i_item_id) select sr_items.item_id,sr_item_qty,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev,cr_item_qty,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev,wr_item_qty,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items,cr_items,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id,sr_item_qty limit 100 "
84,Provable,No Regression,Original,1,0.341286203,6.945432406,748,40.12629533,2.376699209,"select c_customer_id as customer_id,coalesce(c_last_name,'') || ',' || coalesce(c_first_name,'') as customername from customer,customer_address,customer_demographics,household_demographics,income_band,store_returns where ca_city = 'Woodland' and c_current_addr_sk = ca_address_sk and ib_lower_bound >= 60306 and ib_upper_bound <= 60306 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100"
85,Statistical,No Regression,Original,1,2.039234763,37.04214276,7955,73.72955942,2.385038376,"select substr(r_reason_desc,1,20),avg(ws_quantity),avg(wr_refunded_cash),avg(wr_fee) from web_sales,web_returns,web_page,customer_demographics cd1,customer_demographics cd2,customer_address,date_dim,reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 1998 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = 'D' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Primary' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = 'S' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'College' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = 'U' and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = 'Advanced Degree' and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = 'United States' and ca_state in ('NC','TX','IA') and ws_net_profit between 100 and 200 ) or ( ca_country = 'United States' and ca_state in ('WI','WV','GA') and ws_net_profit between 150 and 300 ) or ( ca_country = 'United States' and ca_state in ('OK','VA','KY') and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substr(r_reason_desc,1,20),avg(ws_quantity),avg(wr_refunded_cash),avg(wr_fee) limit 100 "
86,Statistical,No Regression,prompt1,1.000004811,1.439746597,55.4193039,5239,41.03952265,2.066507816," WITH sales_data AS ( SELECT ws_net_paid, i_category, i_class, d_date_sk FROM web_sales JOIN date_dim d1 ON d1.d_date_sk = ws_sold_date_sk JOIN item ON i_item_sk = ws_item_sk WHERE d1.d_month_seq BETWEEN 1186 AND 1197 ), aggregated_data AS ( SELECT i_category, i_class, SUM(ws_net_paid) AS total_sum, GROUPING(i_category) + GROUPING(i_class) AS lochierarchy FROM sales_data GROUP BY ROLLUP(i_category, i_class) ), ranked_data AS ( SELECT total_sum, i_category, i_class, lochierarchy, RANK() OVER ( PARTITION BY lochierarchy, CASE WHEN lochierarchy = 0 THEN i_category END ORDER BY total_sum DESC ) AS rank_within_parent FROM aggregated_data ) SELECT * FROM ranked_data ORDER BY lochierarchy DESC, CASE WHEN lochierarchy = 0 THEN i_category END, rank_within_parent LIMIT 100 "
87,Provable,No Regression,prompt1,1.043442167,7.52702413,43.94320184,7370,49.83940053,7.813751698," WITH store_customers AS ( SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk WHERE d_month_seq BETWEEN 1202 AND 1213 ), catalog_customers AS ( SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk JOIN customer ON catalog_sales.cs_bill_customer_sk = customer.c_customer_sk WHERE d_month_seq BETWEEN 1202 AND 1213 ), web_customers AS ( SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales JOIN date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk JOIN customer ON web_sales.ws_bill_customer_sk = customer.c_customer_sk WHERE d_month_seq BETWEEN 1202 AND 1213 ) SELECT COUNT(*) FROM ( SELECT * FROM store_customers EXCEPT SELECT * FROM catalog_customers EXCEPT SELECT * FROM web_customers ) AS cool_cust "
88,Statistical,No Regression,prompt1,4.468000126,9.446812456,108.9793485,25720,114.7681751,130.8120968," WITH filtered_sales AS ( SELECT ss_sold_time_sk FROM store_sales JOIN household_demographics ON ss_hdemo_sk = household_demographics.hd_demo_sk JOIN store ON ss_store_sk = s_store_sk WHERE store.s_store_name = 'ese' AND ( (household_demographics.hd_dep_count = 0 AND household_demographics.hd_vehicle_count <= 2) OR (household_demographics.hd_dep_count = -1 AND household_demographics.hd_vehicle_count <= 1) OR (household_demographics.hd_dep_count = 3 AND household_demographics.hd_vehicle_count <= 5) ) ), time_intervals AS ( SELECT t_time_sk, t_hour, t_minute FROM time_dim WHERE (t_hour = 8 AND t_minute >= 30) OR (t_hour = 9 AND t_minute < 30) OR (t_hour = 9 AND t_minute >= 30) OR (t_hour = 10 AND t_minute < 30) OR (t_hour = 10 AND t_minute >= 30) OR (t_hour = 11 AND t_minute < 30) OR (t_hour = 11 AND t_minute >= 30) OR (t_hour = 12 AND t_minute < 30) ) SELECT COUNT(CASE WHEN t_hour = 8 AND t_minute >= 30 THEN 1 END) AS h8_30_to_9, COUNT(CASE WHEN t_hour = 9 AND t_minute < 30 THEN 1 END) AS h9_to_9_30, COUNT(CASE WHEN t_hour = 9 AND t_minute >= 30 THEN 1 END) AS h9_30_to_10, COUNT(CASE WHEN t_hour = 10 AND t_minute < 30 THEN 1 END) AS h10_to_10_30, COUNT(CASE WHEN t_hour = 10 AND t_minute >= 30 THEN 1 END) AS h10_30_to_11, COUNT(CASE WHEN t_hour = 11 AND t_minute < 30 THEN 1 END) AS h11_to_11_30, COUNT(CASE WHEN t_hour = 11 AND t_minute >= 30 THEN 1 END) AS h11_30_to_12, COUNT(CASE WHEN t_hour = 12 AND t_minute < 30 THEN 1 END) AS h12_to_12_30 FROM filtered_sales JOIN time_intervals ON filtered_sales.ss_sold_time_sk = time_intervals.t_time_sk "
89,Statistical,No Regression,prompt1,1.001205342,4.246183757,61.97310538,6162,35.69894361,3.847804308," WITH sales_data AS ( SELECT i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, SUM(ss_sales_price) AS sum_sales FROM item JOIN store_sales ON ss_item_sk = i_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk WHERE d_year = 2001 AND ( (i_category IN ('Books', 'Children', 'Electronics') AND i_class IN ('history', 'school-uniforms', 'audio')) OR (i_category IN ('Men', 'Sports', 'Shoes') AND i_class IN ('pants', 'tennis', 'womens')) ) GROUP BY i_category, i_class, i_brand, s_store_name, s_company_name, d_moy ), avg_sales_data AS ( SELECT i_category, i_brand, s_store_name, s_company_name, AVG(sum_sales) AS avg_monthly_sales FROM sales_data GROUP BY i_category, i_brand, s_store_name, s_company_name ) SELECT sd.i_category, sd.i_class, sd.i_brand, sd.s_store_name, sd.s_company_name, sd.d_moy, sd.sum_sales, asd.avg_monthly_sales FROM sales_data sd JOIN avg_sales_data asd ON sd.i_category = asd.i_category AND sd.i_brand = asd.i_brand AND sd.s_store_name = asd.s_store_name AND sd.s_company_name = asd.s_company_name WHERE CASE WHEN asd.avg_monthly_sales <> 0 THEN ABS(sd.sum_sales - asd.avg_monthly_sales) / asd.avg_monthly_sales ELSE NULL END > 0.1 ORDER BY sd.sum_sales - asd.avg_monthly_sales, sd.s_store_name LIMIT 100 "
90,Provable,No Regression,Original,1,2.009309105,48.97483907,5346,46.56149459,4.136177063,"select cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio from ( select count(*) amc from web_sales,household_demographics,time_dim,web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 12 and 12+1 and household_demographics.hd_dep_count = 6 and web_page.wp_char_count between 5000 and 5200) at,( select count(*) pmc from web_sales,household_demographics,time_dim,web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 14 and 14+1 and household_demographics.hd_dep_count = 6 and web_page.wp_char_count between 5000 and 5200) pt order by am_pm_ratio limit 100 "
91,Provable,Potential Regression,Original,1,0.13325445,8.915547394,1081,68.37786102,2.071443796,"select cc_call_center_id Call_Center,cc_name Call_Center_Name,cc_manager Manager,sum(cr_net_loss) Returns_Loss from call_center,catalog_returns,date_dim,customer,customer_address,customer_demographics,household_demographics where cr_call_center_sk = cc_call_center_sk and cr_returned_date_sk = d_date_sk and cr_returning_customer_sk= c_customer_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and ca_address_sk = c_current_addr_sk and d_year = 2000 and d_moy = 12 and ( (cd_marital_status = 'M' and cd_education_status = 'Advanced Degree     ') or(cd_marital_status = 'W' and cd_education_status = 'Unnknown')) and hd_buy_potential like 'Unknown%' and ca_gmt_offset = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc "
92,Provable,No Regression,Original,1,0.187697837,60.45496642,4152,74.79654765,1.724016666,"select sum(ws_ext_discount_amt) as ""Excess Discount Amount"" from web_sales,item,date_dim where i_manufact_id = 393 and i_item_sk = ws_item_sk and d_date between '2000-02-01' and (cast('2000-02-01' as date) + interval '90' day) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt > ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM web_sales,date_dim WHERE ws_item_sk = i_item_sk and d_date between '2000-02-01' and (cast('2000-02-01' as date) + interval '90' day) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) limit 100 "
93,Statistical,No Regression,MCTS,1.000001658,2.194241942,35.3649121,3681,38.67950702,90.03431654," SELECT ss_customer_sk, SUM(COALESCE(ss_quantity - sr_return_quantity, ss_quantity) * ss_sales_price) AS sumsales FROM store_sales LEFT JOIN store_returns ON sr_item_sk = ss_item_sk AND sr_ticket_number = ss_ticket_number JOIN reason ON sr_reason_sk = r_reason_sk WHERE r_reason_desc = 'Package was damaged' GROUP BY ss_customer_sk ORDER BY sumsales, ss_customer_sk LIMIT 100 "
94,Provable,Potential Regression,Original,1,0.709474523,46.87156761,5870,62.77871442,2.24606061,"select count(distinct ws_order_number) as ""order count"",sum(ws_ext_ship_cost) as ""total shipping cost"",sum(ws_net_profit) as ""total net profit"" from web_sales ws1,date_dim,customer_address,web_site where d_date between '2002-5-01' and (cast('2002-5-01' as date) + interval '60' day) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'OK' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select * from web_sales ws2 where ws1.ws_order_number = ws2.ws_order_number and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select * from web_returns wr1 where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100 "
95,Statistical,No Regression,Original,1,54.58409552,72.26787988,6458,63.8549633,53.76251698,"with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2 from web_sales ws1,web_sales ws2 where ws1.ws_order_number = ws2.ws_order_number and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) select count(distinct ws_order_number) as ""order count"",sum(ws_ext_ship_cost) as ""total shipping cost"",sum(ws_net_profit) as ""total net profit"" from web_sales ws1,date_dim,customer_address,web_site where d_date between '2001-4-01' and (cast('2001-4-01' as date) + interval '60' day) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'VA' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and ws1.ws_order_number in (select ws_order_number from ws_wh) and ws1.ws_order_number in (select wr_order_number from web_returns,ws_wh where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100 "
96,Statistical,No Regression,prompt1,1.000000006,1.782103785,40.09419014,4014,51.84652162,2.988545895, SELECT COUNT(*) FROM store_sales JOIN household_demographics ON ss_hdemo_sk = household_demographics.hd_demo_sk JOIN time_dim ON ss_sold_time_sk = time_dim.t_time_sk JOIN store ON ss_store_sk = s_store_sk WHERE time_dim.t_hour = 8 AND time_dim.t_minute >= 30 AND household_demographics.hd_dep_count = 0 AND store.s_store_name = 'ese' 
97,Statistical,No Regression,Original,1,0.637056328,10.99114096,1123,58.88866401,121.4212842,"with ssci as ( select ss_customer_sk customer_sk,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1199 and 1199 + 11 group by ss_customer_sk,ss_item_sk),csci as( select cs_bill_customer_sk customer_sk,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk and d_month_seq between 1199 and 1199 + 11 group by cs_bill_customer_sk,cs_item_sk) select sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk and ssci.item_sk = csci.item_sk) limit 100 "
98,Statistical,No Regression,Original,1,0.778844516,47.61107894,5319,54.51841974,2.350399971,"select i_item_id,i_item_desc,i_category,i_class,i_current_price,sum(ss_ext_sales_price) as itemrevenue,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over (partition by i_class) as revenueratio from store_sales,item,date_dim where ss_item_sk = i_item_sk and i_category in ('Men','Sports','Jewelry') and ss_sold_date_sk = d_date_sk and d_date between cast('1999-02-05' as date) and (cast('1999-02-05' as date) + interval '30' day) group by i_item_id,i_item_desc,i_category,i_class,i_current_price order by i_category,i_class,i_item_id,i_item_desc,revenueratio "
99,Provable,No Regression,Original,1,1.253916694,258.8321935,28255,70.35473752,2.117800951,"select substr(w_warehouse_name,1,20),sm_type,cc_name,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as ""30 days"",sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"",sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as ""61-90 days"",sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"",sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales,warehouse,ship_mode,call_center,date_dim where d_month_seq between 1194 and 1194 + 11 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20),sm_type,cc_name order by substr(w_warehouse_name,1,20),sm_type,cc_name limit 100 "
